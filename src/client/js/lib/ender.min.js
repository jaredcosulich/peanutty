/*!
  * =============================================================
  * Ender: open module JavaScript framework (https://ender.no.de)
  * Build: ender build es5-basic domready sel bonzo bean morpheus reqwest hashchange route /Users/jaredcosulich/Src/coffee-box2d timeout upload wings jar ender-json
  * =============================================================
  */


/*!
  * Ender: open module JavaScript framework (client-lib)
  * copyright Dustin Diaz & Jacob Thornton 2011 (@ded @fat)
  * http://ender.no.de
  * License MIT
  */
!function(a){function d(a){var c=b[a]||window[a];if(!c)throw new Error("Requested module '"+a+"' has not been defined.");return c}function e(a,c){return b[a]=c}function f(a,b){for(var c in b)c!="noConflict"&&c!="_VERSION"&&(a[c]=b[c]);return a}function g(a,b,c){return typeof a=="string"||a.nodeName||a.length&&"item"in a||a==window?(c=h._select(a,b),c.selector=a):c=isFinite(a.length)?a:[a],f(c,g)}function h(a,b){return g(a,b)}a.global=a;var b={},c=a.$;a.provide=e,a.require=d,f(h,{_VERSION:"0.3.6",fn:g,ender:function(a,b){f(b?g:h,a)},_select:function(a,b){return(b||document).querySelectorAll(a)}}),f(g,{forEach:function(a,b,c){for(c=0,l=this.length;c<l;++c)c in this&&a.call(b||this[c],this[c],c,this);return this},$:h}),h.noConflict=function(){return a.$=c,this},typeof module!="undefined"&&module.exports&&(module.exports=h),a.ender=a.$=a.ender||h}(this),!function(){var a={exports:{}},b=a.exports,c=Object.prototype.hasOwnProperty;Function.prototype.bind||(Function.prototype.bind=function(a){var b,c,d;return d=this,typeof d.apply!="function"||typeof d.call!="function"?new TypeError:(c=Array.prototype.slice.call(arguments),b=function(){function a(){var b,e;return this instanceof a?(e=new(b=function(){function a(){}return a.prototype=d.prototype,a}()),d.apply(e,c.concat(Array.prototype.slice.call(arguments))),e):d.call.apply(d,c.concat(Array.prototype.slice.call(arguments)))}return a.prototype.length=typeof d=="function"?Math.max(d.length-c.length,0):0,a}(),b)}),Array.isArray||(Array.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d,e;for(c=0,e=this.length;c<e;c++)d=this[c],c in this&&a.call(b,d,c,this)}),Array.prototype.map||(Array.prototype.map=function(a,b){var c,d,e,f;f=[];for(c=0,e=this.length;c<e;c++)d=this[c],c in this&&f.push(a.call(b,d,c,this));return f}),Array.prototype.filter||(Array.prototype.filter=function(a,b){var c,d,e,f;f=[];for(c=0,e=this.length;c<e;c++)d=this[c],c in this&&a.call(b,d,c,this)&&f.push(d);return f}),Array.prototype.some||(Array.prototype.some=function(a,b){var c,d,e;for(c=0,e=this.length;c<e;c++){d=this[c];if(c in this&&a.call(b,d,c,this))return!0}return!1}),Array.prototype.every||(Array.prototype.every=function(a,b){var c,d,e;for(c=0,e=this.length;c<e;c++){d=this[c];if(c in this&&!a.call(b,d,c,this))return!1}return!0}),Array.prototype.reduce||(Array.prototype.reduce=function(a){var b,c;b=0;if(arguments.length>1)c=arguments[1];else if(this.length)c=this[b++];else throw new TypeError("Reduce of empty array with no initial value");while(b<this.length)b in this&&(c=a.call(null,c,this[b],b,this)),b++;return c}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(a){var b,c;b=this.length-1;if(arguments.length>1)c=arguments[1];else if(this.length)c=this[b--];else throw new TypeError("Reduce of empty array with no initial value");while(b>=0)b in this&&(c=a.call(null,c,this[b],b,this)),b--;return c}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b,c;b=(c=arguments[1])!=null?c:0,b<0&&(b+=length),b=Math.max(b,0);while(b<this.length){if(b in this&&this[b]===a)return b;b++}return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(a){var b;b=arguments[1]||this.length,b<0&&(b+=length),b=Math.min(b,this.length-1);while(b>=0){if(b in this&&this[b]===a)return b;b--}return-1}),Object.keys||(Object.keys=function(a){var b,d;d=[];for(b in a){if(!c.call(a,b))continue;d.push(b)}return d}),Date.now||(Date.now=function(){return(new Date).getTime()}),Date.prototype.toISOString||(Date.prototype.toISOString=function(){return""+this.getUTCFullYear()+"-"+(this.getUTCMonth()+1)+"-"+this.getUTCDate()+"T"+(""+this.getUTCHours()+":"+this.getUTCMinutes()+":"+this.getUTCSeconds()+"Z")}),Date.prototype.toJSON||(Date.prototype.toJSON=function(){return this.toISOString()}),String.prototype.trim||(String.prototype.trim=function(){return String(this).replace(/^\s\s*/,"").replace(/\s\s*$/,"")}),provide("es5-basic",a.exports)}(),!function(){var a={exports:{}},b=a.exports;!function(b,c){typeof define=="function"?define(c):typeof a!="undefined"?a.exports=c():this[b]=this.domReady=c()}("domready",function(a){function l(a){k=1;while(a=b.shift())a()}var b=[],c,d=!1,e=document,f=e.documentElement,g=f.doScroll,h="DOMContentLoaded",i="addEventListener",j="onreadystatechange",k=/^loade|c/.test(e.readyState);return e[i]&&e[i](h,c=function(){e.removeEventListener(h,c,d),l()},d),g&&e.attachEvent(j,c=function(){/^c/.test(e.readyState)&&(e.detachEvent(j,c),l())}),a=g?function(c){self!=top?k?c():b.push(c):function(){try{f.doScroll("left")}catch(b){return setTimeout(function(){a(c)},50)}c()}()}:function(a){k?a():b.push(a)}}),provide("domready",a.exports),!function(a){var b=require("domready");a.ender({domReady:b}),a.ender({ready:function(a){return b(a),this}},!0)}(ender)}(),!function(){var a={exports:{}},b=a.exports;
/*!
    * Bonzo: DOM Utility (c) Dustin Diaz 2011
    * https://github.com/ded/bonzo
    * License MIT
    */
!function(b,c){typeof a!="undefined"?a.exports=c():typeof define=="function"&&define.amd?define(b,c):this[b]=c()}("bonzo",function(){function C(a){return new RegExp("(^|\\s+)"+a+"(\\s+|$)")}function D(a,b,c){for(var d=0,e=a.length;d<e;d++)b.call(c||a[d],a[d],d,a);return a}function E(a,b,c){for(var d=0,e=a.length;d<e;d++)K(a[d])&&(E(a[d].childNodes,b,c),b.call(c||a[d],a[d],d,a));return a}function F(a){return a.replace(/-(.)/g,function(a,b){return b.toUpperCase()})}function G(a){return a?a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase():a}function H(a){return a[w]("data-node-uid")||a[v]("data-node-uid",++r),uid=a[w]("data-node-uid"),q[uid]||(q[uid]={})}function I(a){uid=a[w]("data-node-uid"),uid&&delete q[uid]}function J(a){try{return a==="true"?!0:a==="false"?!1:a==="null"?null:isNaN(a)?a:parseFloat(a)}catch(b){}return undefined}function K(a){return a&&a.nodeName&&a.nodeType==1}function L(a,b,c,d){for(d=0,j=a.length;d<j;++d)if(b.call(c,a[d],d,a))return!0;return!1}function M(a){return a=="transform"&&(a=y.transform)||/^transform-?[Oo]rigin$/.test(a)&&(a=y.transform+"Origin")||a=="float"&&(a=y.cssFloat),a?F(a):null}function O(a,b,c){var d=0,e=b||this,h=[],i=g&&typeof a=="string"&&a.charAt(0)!="<"?g(a):a;return D(V(i),function(a){D(e,function(b){var g=!b[f]||b[f]&&!b[f][f]?function(){var a=b.cloneNode(!0);return e.$&&e.cloneEvents&&e.$(a).cloneEvents(b),a}():b;c(a,g),h[d]=g,d++})},this),D(h,function(a,b){e[b]=a}),e.length=d,e}function P(a,b,c){var d=Z(a),e=d.css("position"),f=d.offset(),g="relative",h=e==g,i=[parseInt(d.css("left"),10),parseInt(d.css("top"),10)];e=="static"&&(d.css("position",g),e=g),isNaN(i[0])&&(i[0]=h?0:a.offsetLeft),isNaN(i[1])&&(i[1]=h?0:a.offsetTop),b!=null&&(a.style.left=b-f.left+i[0]+u),c!=null&&(a.style.top=c-f.top+i[1]+u)}function Q(a,b){return C(b).test(a.className)}function R(a,b){a.className=B(a.className+" "+b)}function S(a,b){a.className=B(a.className.replace(C(b)," "))}function T(a,b){return typeof b=="function"?b(a):b}function U(a){this.length=0;if(a){a=typeof a!="string"&&!a.nodeType&&typeof a.length!="undefined"?a:[a],this.length=a.length;for(var b=0;b<a.length;b++)this[b]=a[b]}}function V(a){return typeof a=="string"?Z.create(a):K(a)?[a]:a}function W(a,b,d){var e=this[0];return a==null&&b==null?(X(e)?Y():{x:e.scrollLeft,y:e.scrollTop})[d]:(X(e)?c.scrollTo(a,b):(a!=null&&(e.scrollLeft=a),b!=null&&(e.scrollTop=b)),this)}function X(a){return a===c||/^(?:body|html)$/i.test(a.tagName)}function Y(){return{x:c.pageXOffset||e.scrollLeft,y:c.pageYOffset||e.scrollTop}}function Z(a,b){return new U(a,b)}var a=this,b=a.bonzo,c=window,d=c.document,e=d.documentElement,f="parentNode",g=null,h=/^checked|value|selected$/,i=/select|fieldset|table|tbody|tfoot|td|tr|colgroup/i,k=["<table>","</table>",1],l=["<table><tbody><tr>","</tr></tbody></table>",3],m=["<select>","</select>",1],n={thead:k,tbody:k,tfoot:k,colgroup:k,caption:k,tr:["<table><tbody>","</tbody></table>",2],th:l,td:l,col:["<table><colgroup>","</colgroup></table>",2],fieldset:["<form>","</form>",1],legend:["<form><fieldset>","</fieldset></form>",2],option:m,optgroup:m},o=/^checked|selected$/,p=/msie/i.test(navigator.userAgent),q={},r=0,s=/^-?[\d\.]+$/,t=/^data-(.+)$/,u="px",v="setAttribute",w="getAttribute",x="getElementsByTagName",y=function(){var a=d.createElement("p");return a.innerHTML='<a href="#x">x</a><table style="float:left;"></table>',{hrefExtended:a[x]("a")[0][w]("href")!="#x",autoTbody:a[x]("tbody").length!==0,computedStyle:d.defaultView&&d.defaultView.getComputedStyle,cssFloat:a[x]("table")[0].style.styleFloat?"styleFloat":"cssFloat",transform:function(){var b=["webkitTransform","MozTransform","OTransform","msTransform","Transform"],c;for(c=0;c<b.length;c++)if(b[c]in a.style)return b[c]}()}}(),z=/(^\s*|\s*$)/g,A={lineHeight:1,zoom:1,zIndex:1,opacity:1},B=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(z,"")},N=y.computedStyle?function(a,b){var c=null,e=d.defaultView.getComputedStyle(a,"");return e&&(c=e[b]),a.style[b]||c}:p&&e.currentStyle?function(a,b){if(b=="opacity"){var c=100;try{c=a.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(d){try{c=a.filters("alpha").opacity}catch(e){}}return c/100}var f=a.currentStyle?a.currentStyle[b]:null;return a.style[b]||f}:function(a,b){return a.style[b]};return U.prototype={get:function(a){return this[a]},each:function(a,b){return D(this,a,b)},deepEach:function(a,b){return E(this,a,b)},map:function(a,b){var c=[],d,e;for(e=0;e<this.length;e++)d=a.call(this,this[e],e),b?b(d)&&c.push(d):c.push(d);return c},first:function(){return Z(this.length?this[0]:[])},last:function(){return Z(this.length?this[this.length-1]:[])},html:function(a,b){function f(b){D(V(a),function(a){b.appendChild(a)})}var c=b?e.textContent===undefined?"innerText":"textContent":"innerHTML",d;return typeof a!="undefined"?this.empty().each(function(e){!b&&(d=e.tagName.match(i))?f(e,d[0]):e[c]=a}):this[0]?this[0][c]:""},text:function(a){return this.html(a,1)},addClass:function(a){return this.each(function(b){Q(b,T(b,a))||R(b,T(b,a))})},removeClass:function(a){return this.each(function(b){Q(b,T(b,a))&&S(b,T(b,a))})},hasClass:function(a){return L(this,function(b){return Q(b,a)})},toggleClass:function(a,b){return this.each(function(c){typeof b!="undefined"?b?R(c,a):S(c,a):Q(c,a)?S(c,a):R(c,a)})},show:function(a){return this.each(function(b){b.style.display=a||""})},hide:function(){return this.each(function(a){a.style.display="none"})},append:function(a){return this.each(function(b){D(V(a),function(a){b.appendChild(a)})})},prepend:function(a){return this.each(function(b){var c=b.firstChild;D(V(a),function(a){b.insertBefore(a,c)})})},appendTo:function(a,b){return O.call(this,a,b,function(a,b){a.appendChild(b)})},prependTo:function(a,b){return O.call(this,a,b,function(a,b){a.insertBefore(b,a.firstChild)})},next:function(){return this.related("nextSibling")},previous:function(){return this.related("previousSibling")},related:function(a){return this.map(function(b){b=b[a];while(b&&b.nodeType!==1)b=b[a];return b||0},function(a){return a})},before:function(a){return this.each(function(b){D(Z.create(a),function(a){b[f].insertBefore(a,b)})})},after:function(a){return this.each(function(b){D(Z.create(a),function(a){b[f].insertBefore(a,b.nextSibling)})})},insertBefore:function(a,b){return O.call(this,a,b,function(a,b){a[f].insertBefore(b,a)})},insertAfter:function(a,b){return O.call(this,a,b,function(a,b){var c=a.nextSibling;c?a[f].insertBefore(b,c):a[f].appendChild(b)})},replaceWith:function(a){return this.deepEach(I),this.each(function(b){b.parentNode.replaceChild(Z.create(a)[0],b)})},css:function(a,b,e){function g(a,b,c){for(var d in f)f.hasOwnProperty(d)&&(c=f[d],(b=M(d))&&s.test(c)&&!(b in A)&&(c+=u),a.style[b]=T(a,c))}if(b===undefined&&typeof a=="string")return b=this[0],b?b===d||b===c?(e=b===d?Z.doc():Z.viewport(),a=="width"?e.width:a=="height"?e.height:""):(a=M(a))?N(b,a):null:null;var f=a;return typeof a=="string"&&(f={},f[a]=b),p&&f.opacity&&(f.filter="alpha(opacity="+f.opacity*100+")",f.zoom=a.zoom||1,delete f.opacity),this.each(g)},offset:function(a,b){if(typeof a=="number"||typeof b=="number")return this.each(function(c){P(c,a,b)});if(!this[0])return{top:0,left:0,height:0,width:0};var c=this[0],d=c.offsetWidth,e=c.offsetHeight,f=c.offsetTop,g=c.offsetLeft;while(c=c.offsetParent)f+=c.offsetTop,g+=c.offsetLeft;return{top:f,left:g,height:e,width:d}},dim:function(){var a=this[0],b=!a.offsetWidth&&!a.offsetHeight?function(b,c){return c={position:a.style.position||"",visibility:a.style.visibility||"",display:a.style.display||""},b.first().css({position:"absolute",visibility:"hidden",display:"block"}),c}(this):null,c=a.offsetWidth,d=a.offsetHeight;return b&&this.first().css(b),{height:d,width:c}},attr:function(a,b){var c=this[0];if(typeof a=="string"||a instanceof String)return typeof b=="undefined"?h.test(a)?o.test(a)&&typeof c[a]=="string"?!0:c[a]:a!="href"&&a!="src"||!y.hrefExtended?c[w](a):c[w](a,2):this.each(function(c){h.test(a)?c[a]=T(c,b):c[v](a,T(c,b))});for(var d in a)a.hasOwnProperty(d)&&this.attr(d,a[d]);return this},val:function(a){return typeof a=="string"?this.attr("value",a):this[0].value},removeAttr:function(a){return this.each(function(b){o.test(a)?b[a]=!1:b.removeAttribute(a)})},data:function(a,b){var c=this[0],d,e,f;return typeof b=="undefined"?(e=H(c),typeof a=="undefined"?(D(c.attributes,function(a){(f=(""+a.name).match(t))&&(e[F(f[1])]=J(a.value))}),e):typeof e[a]=="undefined"?e[a]=J(this.attr("data-"+G(a))):e[a]):this.each(function(c){H(c)[a]=b})},remove:function(){return this.deepEach(I),this.each(function(a){a[f]&&a[f].removeChild(a)})},empty:function(){return this.each(function(a){E(a.childNodes,I);while(a.firstChild)a.removeChild(a.firstChild)})},detach:function(){return this.map(function(a){return a[f].removeChild(a)})},scrollTop:function(a){return W.call(this,null,a,"y")},scrollLeft:function(a){return W.call(this,a,null,"x")},toggle:function(a,b){return this.each(function(a){a.style.display=a.offsetWidth||a.offsetHeight?"none":b||""}),a&&a(),this}},Z.setQueryEngine=function(a){g=a,delete Z.setQueryEngine},Z.aug=function(a,b){for(var c in a)a.hasOwnProperty(c)&&((b||U.prototype)[c]=a[c])},Z.create=function(a){return typeof a=="string"&&a!==""?function(){var b=/^\s*<([^\s>]+)/.exec(a),c=d.createElement("div"),e=[],g=b?n[b[1].toLowerCase()]:null,h=g?g[2]+1:1,i=f,j=y.autoTbody&&g&&g[0]=="<table>"&&!/<tbody/i.test(a);c.innerHTML=g?g[0]+a+g[1]:a;while(h--)c=c.firstChild;do(!b||c.nodeType==1)&&(!j||c.tagName.toLowerCase()!="tbody")&&e.push(c);while(c=c.nextSibling);return D(e,function(a){a[i]&&a[i].removeChild(a)}),e}():K(a)?[a.cloneNode(!0)]:[]},Z.doc=function(){var a=Z.viewport();return{width:Math.max(d.body.scrollWidth,e.scrollWidth,a.width),height:Math.max(d.body.scrollHeight,e.scrollHeight,a.height)}},Z.firstChild=function(a){for(var b=a.childNodes,c=0,d=b&&b.length||0,e;c<d;c++)b[c].nodeType===1&&(e=b[d=c]);return e},Z.viewport=function(){return{width:p?e.clientWidth:self.innerWidth,height:p?e.clientHeight:self.innerHeight}},Z.isAncestor="compareDocumentPosition"in e?function(a,b){return(a.compareDocumentPosition(b)&16)==16}:"contains"in e?function(a,b){return a!==b&&a.contains(b)}:function(a,b){while(b=b[f])if(b===a)return!0;return!1},Z.noConflict=function(){return a.bonzo=b,this},Z}),provide("bonzo",a.exports),!function(a){function c(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1}function d(a){var b=[],c=0,d=0,e,f,g;for(;f=a[c];++c){g=!1;for(e=0;e<b.length;++e)if(b[e]===f){g=!0;break}g||(b[d++]=f)}return b}function e(a,b,c){return a?b.css(c,a):function(a){return b[0]?(a=parseInt(b.css(c),10),isNaN(a)?b[0]["offset"+c.replace(/^\w/,function(a){return a.toUpperCase()})]:a):0}()}var b=require("bonzo");b.setQueryEngine(a),a.ender(b),a.ender(b(),!0),a.ender({create:function(c){return a(b.create(c))}}),a.id=function(b){return a([document.getElementById(b)])},a.ender({parents:function(b,e){var f=a(b),g,h,i,j=[];for(g=0,h=this.length;g<h;g++){i=this[g];while(i=i.parentNode)if(~c(f,i)){j.push(i);if(e)break}}return a(d(j))},closest:function(a){return this.parents(a,!0)},first:function(){return a(this.length?this[0]:this)},last:function(){return a(this.length?this[this.length-1]:[])},next:function(){return a(b(this).next())},previous:function(){return a(b(this).previous())},appendTo:function(a){return b(this.selector).appendTo(a,this)},prependTo:function(a){return b(this.selector).prependTo(a,this)},insertAfter:function(a){return b(this.selector).insertAfter(a,this)},insertBefore:function(a){return b(this.selector).insertBefore(a,this)},siblings:function(){var b,c,d,e=[];for(b=0,c=this.length;b<c;b++){d=this[b];while(d=d.previousSibling)d.nodeType==1&&e.push(d);d=this[b];while(d=d.nextSibling)d.nodeType==1&&e.push(d)}return a(e)},children:function(){var c,e,f=[];for(c=0,l=this.length;c<l;c++){if(!(e=b.firstChild(this[c])))continue;f.push(e);while(e=e.nextSibling)e.nodeType==1&&f.push(e)}return a(d(f))},height:function(a){return e(a,this,"height")},width:function(a){return e(a,this,"width")}},!0)}(ender)}(),!function(){var a={exports:{}},b=a.exports;
/*!
    * bean.js - copyright Jacob Thornton 2011
    * https://github.com/fat/bean
    * MIT License
    * special thanks to:
    * dean edwards: http://dean.edwards.name/
    * dperini: https://github.com/dperini/nwevents
    * the entire mootools team: github.com/mootools/mootools-core
    */
!function(b,c){typeof a!="undefined"?a.exports=c():typeof define=="function"&&typeof define.amd=="object"?define(c):this[b]=c()}("bean",function(){function F(a){var b=a.relatedTarget;return b?b!=this&&b.prefix!="xul"&&!/document/.test(this.toString())&&!p(this,b):b===null}var a=window,b=1,c={},d={},e=/over|out/,f=/[^\.]*(?=\..*)\.|.*/,g=/\..*/,h="addEventListener",i="attachEvent",j="removeEventListener",k="detachEvent",l=document||{},m=l.documentElement||{},n=m[h],o=n?h:i,p=function(a,b){var c=b.parentNode;while(c!==null){if(c==a)return!0;c=c.parentNode}},q=function(a,c){return a.__uid=c&&c+"::"+b++||a.__uid||b++},r=function(a){var b=q(a);return c[b]=c[b]||{}},s=n?function(a,b,c,d){a[d?h:j](b,c,!1)}:function(a,b,c,d,e){e&&d&&a["_on"+e]===null&&(a["_on"+e]=0),a[d?i:k]("on"+b,c)},t=function(b,c,d){return function(e){return e=D(e||((this.ownerDocument||this.document||this).parentWindow||a).event),c.apply(b,[e].concat(d))}},u=function(b,c,d,e,f){return function(g){if(e?e.apply(this,arguments):n?!0:g&&g.propertyName=="_on"+d||!g)g=g?D(g||((this.ownerDocument||this.document||this).parentWindow||a).event):null,c.apply(b,Array.prototype.slice.call(arguments,g?0:1).concat(f))}},v=function(a,b,c,e){var h=b.replace(g,""),i=r(a),j=i[h]||(i[h]={}),k=c,l=q(c,b.replace(f,""));if(j[l])return a;var m=G[h];m&&(c=m.condition?u(a,c,h,m.condition):c,h=m.base||h);var p=E[h];c=p?t(a,c,e):u(a,c,h,!1,e),p=n||p;if(h=="unload"){var v=c;c=function(){w(a,h,c)&&v()}}return a[o]&&s(a,p?h:"propertychange",c,!0,!p&&h),j[l]=c,c.__uid=l,c.__originalFn=k,h=="unload"?a:d[q(a)]=a},w=function(a,b,c){function l(b){c=j[k][b];if(!c)return;delete j[k][b];if(a[o]){k=G[k]?G[k].base:k;var d=n||E[k];s(a,d?k:"propertychange",c,!1,!d&&k)}}var d,e,h,i,j=r(a),k=b.replace(g,"");if(!j||!j[k])return a;e=b.replace(f,""),h=e?e.split("."):[c.__uid],l(e);for(i=h.length;i--;l(h[i]));return a},x=function(a,b,c){return function(d){var e=typeof a=="string"?c(a,this):a;for(var f=d.target;f&&f!=this;f=f.parentNode)for(var g=e.length;g--;)if(e[g]==f)return b.apply(f,arguments)}},y=function(a,b,c,d,e){if(typeof b=="object"&&!c)for(var f in b)b.hasOwnProperty(f)&&y(a,f,b[f]);else{var g=typeof c=="string",h=(g?c:b).split(" ");c=g?x(b,d,e):c;for(var i=h.length;i--;)v(a,h[i],c,Array.prototype.slice.call(arguments,g?4:3))}return a},z=function(a,b,c){var d,e,h,i,j,k=typeof b=="string",l=k&&b.replace(f,""),m=w,n=r(a);l=l&&l.split(".");if(k&&/\s/.test(b)){b=b.split(" "),j=b.length-1;while(z(a,b[j])&&j--);return a}i=k?b.replace(g,""):b;if(!n||l||k&&!n[i]){for(d in n)if(n.hasOwnProperty(d))for(j in n[d])for(e=l.length;e--;)n[d].hasOwnProperty(j)&&(new RegExp("^"+l[e]+"::\\d*(\\..*)?$")).test(j)&&m(a,[d,j].join("."));return a}if(typeof c=="function")m(a,i,c);else if(l)m(a,b);else{m=i?m:z,h=k&&i,i=i?c||n[i]||i:n;for(d in i)i.hasOwnProperty(d)&&(m(a,h||d,i[d]),delete i[d])}return a},A=function(a,b,c){var d,e,h,i,j=b.split(" ");for(h=j.length;h--;){b=j[h].replace(g,"");var k=E[b],l=j[h].replace(f,""),m=r(a)[b];if(l){l=l.split(".");for(e=l.length;e--;)for(i in m)m.hasOwnProperty(i)&&(new RegExp("^"+l[e]+"::\\d*(\\..*)?$")).test(i)&&m[i].apply(a,[!1].concat(c))}else if(!c&&a[o])B(k,b,a);else for(e in m)m.hasOwnProperty(e)&&m[e].apply(a,[!1].concat(c))}return a},B=n?function(b,c,d){evt=document.createEvent(b?"HTMLEvents":"UIEvents"),evt[b?"initEvent":"initUIEvent"](c,!0,!0,a,1),d.dispatchEvent(evt)}:function(a,b,c){a?c.fireEvent("on"+b,document.createEventObject()):c["_on"+b]++},C=function(a,b,c){var d=r(b),e,f,g=q(a);e=c?d[c]:d;for(f in e)e.hasOwnProperty(f)&&(c?y:C)(a,c||b,c?e[f].__originalFn:f);return a},D=function(a){var b={};if(!a)return b;var c=a.type,d=a.target||a.srcElement;b.preventDefault=D.preventDefault(a),b.stopPropagation=D.stopPropagation(a),b.target=d&&d.nodeType==3?d.parentNode:d;if(~c.indexOf("key"))b.keyCode=a.which||a.keyCode;else if(/click|mouse|menu/i.test(c)){b.rightClick=a.which==3||a.button==2,b.pos={x:0,y:0};if(a.pageX||a.pageY)b.clientX=a.pageX,b.clientY=a.pageY;else if(a.clientX||a.clientY)b.clientX=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,b.clientY=a.clientY+document.body.scrollTop+document.documentElement.scrollTop;e.test(c)&&(b.relatedTarget=a.relatedTarget||a[(c=="mouseover"?"from":"to")+"Element"])}for(var f in a)f in b||(b[f]=a[f]);return b};D.preventDefault=function(a){return function(){a.preventDefault?a.preventDefault():a.returnValue=!1}},D.stopPropagation=function(a){return function(){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}};var E={click:1,dblclick:1,mouseup:1,mousedown:1,contextmenu:1,mousewheel:1,DOMMouseScroll:1,mouseover:1,mouseout:1,mousemove:1,selectstart:1,selectend:1,keydown:1,keypress:1,keyup:1,orientationchange:1,touchstart:1,touchmove:1,touchend:1,touchcancel:1,gesturestart:1,gesturechange:1,gestureend:1,focus:1,blur:1,change:1,reset:1,select:1,submit:1,load:1,unload:1,beforeunload:1,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,error:1,abort:1,scroll:1},G={mouseenter:{base:"mouseover",condition:F},mouseleave:{base:"mouseout",condition:F},mousewheel:{base:/Firefox/.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel"}},H={add:y,remove:z,clone:C,fire:A},I=function(a){var b=z(a).__uid;b&&(delete d[b],delete c[b])};return a[i]&&y(a,"unload",function(){for(var b in d)d.hasOwnProperty(b)&&I(d[b]);a.CollectGarbage&&CollectGarbage()}),H.noConflict=function(){return context.bean=old,this},H}),provide("bean",a.exports),!function(a){var b=require("bean"),c=function(c,d,e){var f=d?[d]:[];return function(){for(var e,g=0,h=this.length;g<h;g++)e=[this[g]].concat(f,Array.prototype.slice.call(arguments,0)),e.length==4&&e.push(a),!arguments.length&&c=="add"&&d&&(c="fire"),b[c].apply(this,e);return this}},d=c("add"),e=c("remove"),f=c("fire"),g={on:d,addListener:d,bind:d,listen:d,delegate:d,unbind:e,unlisten:e,removeListener:e,undelegate:e,emit:f,trigger:f,cloneEvents:c("clone"),hover:function(a,c,d){for(d=this.length;d--;)b.add.call(this,this[d],"mouseenter",a),b.add.call(this,this[d],"mouseleave",c);return this}},h,i=["blur","change","click","dblclick","error","focus","focusin","focusout","keydown","keypress","keyup","load","mousedown","mouseenter","mouseleave","mouseout","mouseover","mouseup","mousemove","resize","scroll","select","submit","unload"];for(h=i.length;h--;)g[i[h]]=c("add",i[h]);a.ender(g,!0)}(ender)}(),!function(){var a={exports:{}},b=a.exports;
/*!
    * Morpheus - A Brilliant Animator
    * https://github.com/ded/morpheus - (c) Dustin Diaz 2011
    * License MIT
    */
!function(b,c){typeof define=="function"?define(c):typeof a!="undefined"?a.exports=c():this[b]=c()}("morpheus",function(){function q(a,b){var c={},d;if(d=a.match(h))c.rotate=A(d[1],b?b.rotate:null);if(d=a.match(i))c.scale=A(d[1],b?b.scale:null);if(d=a.match(j))c.skewx=A(d[1],b?b.skewx:null),c.skewy=A(d[3],b?b.skewy:null);if(d=a.match(k))c.translatex=A(d[1],b?b.translatex:null),c.translatey=A(d[3],b?b.translatey:null);return c}function r(a){var b="";return"rotate"in a&&(b+="rotate("+a.rotate+"deg) "),"scale"in a&&(b+="scale("+a.scale+") "),"translatex"in a&&(b+="translate("+a.translatex+"px,"+a.translatey+"px) "),"skewx"in a&&(b+="skew("+a.skewx+"deg,"+a.skewy+"deg)"),b}function s(a,b,c){return"#"+(1<<24|a<<16|b<<8|c).toString(16).slice(1)}function t(a){var b=/rgba?\((\d+),\s*(\d+),\s*(\d+)/.exec(a);return(b?s(b[1],b[2],b[3]):a).replace(/#(\w)(\w)(\w)$/,"#$1$1$2$2$3$3")}function u(a){return a.replace(/-(.)/g,function(a,b){return b.toUpperCase()})}function v(a){return typeof a=="function"}function w(a,b,c,d,e,f){function l(a){var m=a-i;if(m>g||j)return f=isFinite(f)?f:1,j?k&&b(f):b(f),c&&c();isFinite(f)?b(h*d(m/g)+e):b(d(m/g)),p(l)}d=v(d)?d:B.easings[d]||function(a){return Math.sin(a*Math.PI/2)};var g=a||1e3,h=f-e,i=+(new Date),j=0,k=0;return p(l),{stop:function(a){j=1,k=a,a||(c=null)}}}function x(a,b){var c=a.length,d=[],e,f;for(e=0;e<c;++e)d[e]=[a[e][0],a[e][1]];for(f=1;f<c;++f)for(e=0;e<c-f;++e)d[e][0]=(1-b)*d[e][0]+b*d[parseInt(e+1,10)][0],d[e][1]=(1-b)*d[e][1]+b*d[parseInt(e+1,10)][1];return[d[0][0],d[0][1]]}function y(a,b,c){var d=[],e,f;for(e=0;e<6;e++)from=Math.min(15,parseInt(b.charAt(e),16)),to=Math.min(15,parseInt(c.charAt(e),16)),f=Math.floor((to-from)*a+from),f=f>15?15:f<0?0:f,d[e]=f.toString(16);return"#"+d.join("")}function z(a,b,c,d,e,f,g){if(e=="transform"){g={};for(var h in c[f][e])g[h]=h in d[f][e]?Math.round(((d[f][e][h]-c[f][e][h])*a+c[f][e][h])*1e3)/1e3:c[f][e][h];return g}return typeof c[f][e]=="string"?y(a,c[f][e],d[f][e]):(g=Math.round(((d[f][e]-c[f][e])*a+c[f][e])*1e3)/1e3,e in l||(g+=b[f][e]||"px"),g)}function A(a,b,c,d,e){return(c=f.exec(a))?(e=parseFloat(c[2]))&&b+(c[1]=="+"?1:-1)*e:parseFloat(a)}function B(a,b){var c=a?c=isFinite(a.length)?a:[a]:[],d,f=b.complete,h=b.duration,i=b.easing,j=b.bezier,k=[],l=[],p=[],s=[],y,B;delete b.complete,delete b.duration,delete b.easing,delete b.bezier,j&&(y=b.left,B=b.top,delete b.right,delete b.bottom,delete b.left,delete b.top);for(d=c.length;d--;){k[d]={},l[d]={},p[d]={};if(j){var C=o(c[d],"left"),D=o(c[d],"top"),E=[A(v(y)?y(c[d]):y||0,parseFloat(C)),A(v(B)?B(c[d]):B||0,parseFloat(D))];s[d]=v(j)?j(c[d],E):j,s[d].push(E),s[d].unshift([parseInt(C,10),parseInt(D,10)])}for(var F in b){var G=o(c[d],F),H,I=v(b[F])?b[F](c[d]):b[F];if(typeof I=="string"&&e.test(I)&&!e.test(G)){delete b[F];continue}k[d][F]=F=="transform"?q(G):typeof I=="string"&&e.test(I)?t(G).slice(1):parseFloat(G),l[d][F]=F=="transform"?q(I,k[d][F]):typeof I=="string"&&I.charAt(0)=="#"?t(I).slice(1):A(I,parseFloat(G)),typeof I=="string"&&(H=I.match(g))&&(p[d][F]=H[1])}}return w(h,function(a,e,f){for(d=c.length;d--;){j&&(f=x(s[d],a),c[d].style.left=f[0]+"px",c[d].style.top=f[1]+"px");for(var g in b)e=z(a,p,k,l,g,d),g=="transform"?c[d].style[m]=r(e):g=="opacity"&&!n?c[d].style.filter="alpha(opacity="+e*100+")":c[d].style[u(g)]=e}},f,i)}var a=this,b=document,c=window,d=b.documentElement,e=/^rgb\(|#/,f=/^([+\-])=([\d\.]+)/,g=/^(?:[\+\-]=)?\d+(?:\.\d+)?(%|in|cm|mm|em|ex|pt|pc|px)$/,h=/rotate\(((?:[+\-]=)?([\-\d\.]+))deg\)/,i=/scale\(((?:[+\-]=)?([\d\.]+))\)/,j=/skew\(((?:[+\-]=)?([\-\d\.]+))deg, ?((?:[+\-]=)?([\-\d\.]+))deg\)/,k=/translate\(((?:[+\-]=)?([\-\d\.]+))px, ?((?:[+\-]=)?([\-\d\.]+))px\)/,l={lineHeight:1,zoom:1,zIndex:1,opacity:1,transform:1},m=function(){var a=b.createElement("a").style,c=["webkitTransform","MozTransform","OTransform","msTransform","Transform"],d;for(d=0;d<c.length;d++)if(c[d]in a)return c[d]}(),n=function(){return typeof b.createElement("a").style.opacity!="undefined"}(),o=b.defaultView&&b.defaultView.getComputedStyle?function(a,c){c=c=="transform"?m:c;var d=null,e=b.defaultView.getComputedStyle(a,"");return e&&(d=e[u(c)]),a.style[c]||d}:d.currentStyle?function(a,b){b=u(b);if(b=="opacity"){var c=100;try{c=a.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(d){try{c=a.filters("alpha").opacity}catch(e){}}return c/100}var f=a.currentStyle?a.currentStyle[b]:null;return a.style[b]||f}:function(a,b){return a.style[u(b)]},p=function(){return c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame||c.oRequestAnimationFrame||c.msRequestAnimationFrame||function(a){c.setTimeout(function(){a(+(new Date))},10)}}();return B.tween=w,B.getStyle=o,B.bezier=x,B.transform=m,B.parseTransform=q,B.formatTransform=r,B.easings={},B}),provide("morpheus",a.exports);var c=require("morpheus");!function(a){a.ender({animate:function(a){return c(this,a)},fadeIn:function(a,b){return c(this,{duration:a,opacity:1,complete:b})},fadeOut:function(a,b){return c(this,{duration:a,opacity:0,complete:b})}},!0),a.ender({tween:c.tween})}(ender)}(),!function(){var module={exports:{}},exports=module.exports;
/*!
    * Reqwest! A general purpose XHR connection manager
    * (c) Dustin Diaz 2011
    * https://github.com/ded/reqwest
    * license MIT
    */
!function(a,b){typeof define=="function"?define(b):typeof module!="undefined"?module.exports=b():this[a]=b()}("reqwest",function(){function handleReadyState(a,b,c){return function(){a&&a[readyState]==4&&(twoHundo.test(a.status)?b(a):c(a))}}function setHeaders(a,b){var c=b.headers||{},d={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"};c.Accept=c.Accept||d[b.type]||"text/javascript, text/html, application/xml, text/xml, */*",b.crossOrigin||(c["X-Requested-With"]=c["X-Requested-With"]||"XMLHttpRequest"),c[contentType]=c[contentType]||"application/x-www-form-urlencoded";for(var e in c)c.hasOwnProperty(e)&&a.setRequestHeader(e,c[e])}function generalCallback(a){lastValue=a}function urlappend(a,b){return a+(/\?/.test(a)?"&":"?")+b}function handleJsonp(a,b,c,d){var e=uniqid++,f=a.jsonpCallback||"callback",g=a.jsonpCallbackName||"reqwest_"+e,h=new RegExp("("+f+")=(.+)(&|$)"),i=d.match(h),j=doc.createElement("script"),k=0;i?i[2]==="?"?d=d.replace(h,"$1="+g+"$3"):g=i[2]:d=urlappend(d,f+"="+g),win[g]=generalCallback,j.type="text/javascript",j.src=d,j.async=!0,typeof j.onreadystatechange!="undefined"&&(j.event="onclick",j.htmlFor=j.id="_reqwest_"+e),j.onload=j.onreadystatechange=function(){if(j[readyState]&&j[readyState]!=="complete"&&j[readyState]!=="loaded"||k)return!1;j.onload=j.onreadystatechange=null,j.onclick&&j.onclick(),a.success&&a.success(lastValue),lastValue=undefined,head.removeChild(j),k=1},head.appendChild(j)}function getRequest(a,b,c){var d=(a.method||"GET").toUpperCase(),e=typeof a=="string"?a:a.url,f=a.processData!==!1&&a.data&&typeof a.data!="string"?reqwest.toQueryString(a.data):a.data||null;(a.type=="jsonp"||d=="GET")&&f&&(e=urlappend(e,f))&&(f=null);if(a.type=="jsonp")return handleJsonp(a,b,c,e);var g=xhr();return g.open(d,e,!0),setHeaders(g,a),g.onreadystatechange=handleReadyState(g,b,c),a.before&&a.before(g),g.send(f),g}function Reqwest(a,b){this.o=a,this.fn=b,init.apply(this,arguments)}function setType(a){var b=a.match(/\.(json|jsonp|html|xml)(\?|$)/);return b?b[1]:"js"}function init(o,fn){function complete(a){o.timeout&&clearTimeout(self.timeout),self.timeout=null,o.complete&&o.complete(a)}function success(resp){var r=resp.responseText;if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r}fn(resp),o.success&&o.success(resp),complete(resp)}function error(a,b,c){o.error&&o.error(a,b,c),complete(a)}this.url=typeof o=="string"?o:o.url,this.timeout=null;var type=o.type||setType(this.url),self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){self.abort()},o.timeout)),this.request=getRequest(o,success,error)}function reqwest(a,b){return new Reqwest(a,b)}function normalize(a){return a?a.replace(/\r?\n/g,"\r\n"):""}function serial(a,b){var c=a.name,d=a.tagName.toLowerCase(),e=function(a){a&&!a.disabled&&b(c,normalize(a.attributes.value&&a.attributes.value.specified?a.value:a.text))};if(a.disabled||!c)return;switch(d){case"input":if(!/reset|button|image|file/i.test(a.type)){var f=/checkbox/i.test(a.type),g=/radio/i.test(a.type),h=a.value;(!f&&!g||a.checked)&&b(c,normalize(f&&h===""?"on":h))}break;case"textarea":b(c,normalize(a.value));break;case"select":if(a.type.toLowerCase()==="select-one")e(a.selectedIndex>=0?a.options[a.selectedIndex]:null);else for(var i=0;a.length&&i<a.length;i++)a.options[i].selected&&e(a.options[i])}}function eachFormElement(){var a=this,b,c,d,e=function(b,c){for(var e=0;e<c.length;e++){var f=b[byTag](c[e]);for(d=0;d<f.length;d++)serial(f[d],a)}};for(c=0;c<arguments.length;c++)b=arguments[c],/input|select|textarea/i.test(b.tagName)&&serial(b,a),e(b,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var a={};return eachFormElement.apply(function(b,c){b in a?(a[b]&&!isArray(a[b])&&(a[b]=[a[b]]),a[b].push(c)):a[b]=c},arguments),a}var context=this,win=window,doc=document,old=context.reqwest,twoHundo=/^20\d$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",head=doc[byTag]("head")[0],uniqid=0,lastValue,xhr="XMLHttpRequest"in win?function(){return new XMLHttpRequest}:function(){return new ActiveXObject("Microsoft.XMLHTTP")};Reqwest.prototype={abort:function(){this.request.abort()},retry:function(){init.call(this,this.o,this.fn)}};var isArray=typeof Array.isArray=="function"?Array.isArray:function(a){return a instanceof Array};return reqwest.serializeArray=function(){var a=[];return eachFormElement.apply(function(b,c){a.push({name:b,value:c})},arguments),a},reqwest.serialize=function(){if(arguments.length===0)return"";var a,b,c=Array.prototype.slice.call(arguments,0);return a=c.pop(),a&&a.nodeType&&c.push(a)&&(a=null),a&&(a=a.type),a=="map"?b=serializeHash:a=="array"?b=reqwest.serializeArray:b=serializeQueryString,b.apply(null,c)},reqwest.toQueryString=function(a){var b="",c,d=encodeURIComponent,e=function(a,c){b+=d(a)+"="+d(c)+"&"};if(isArray(a))for(c=0;a&&c<a.length;c++)e(a[c].name,a[c].value);else for(var f in a){if(!Object.hasOwnProperty.call(a,f))continue;var g=a[f];if(isArray(g))for(c=0;c<g.length;c++)e(f,g[c]);else e(f,a[f])}return b.replace(/&$/,"").replace(/%20/g,"+")},reqwest.noConflict=function(){return context.reqwest=old,this},reqwest}),provide("reqwest",module.exports),!function(a){var b=require("reqwest"),c=function(a){return function(){var c=(this&&this.length>0?this:[]).concat(Array.prototype.slice.call(arguments,0));return b[a].apply(null,c)}},d=c("serialize"),e=c("serializeArray");a.ender({ajax:b,serialize:d,serializeArray:e,toQueryString:b.toQueryString}),a.ender({serialize:d,serializeArray:e},!0)}(ender)}(),!function(){var a={exports:{}},b=a.exports,c;b.b2Settings=c=c=function(){function a(){}return a}(),c.b2Assert=function(a){if(!a)return vnullVec,nullVec.x++},c.USHRT_MAX=65535,c.b2_pi=Math.PI,c.b2_massUnitsPerKilogram=1,c.b2_timeUnitsPerSecond=1,c.b2_lengthUnitsPerMeter=30,c.b2_maxManifoldPoints=2,c.b2_maxShapesPerBody=64,c.b2_maxPolyVertices=256,c.b2_maxProxies=1024,c.b2_maxPairs=8*c.b2_maxProxies,c.b2_linearSlop=.005*c.b2_lengthUnitsPerMeter,c.b2_angularSlop=2/180*c.b2_pi,c.b2_velocityThreshold=1*c.b2_lengthUnitsPerMeter/c.b2_timeUnitsPerSecond,c.b2_maxLinearCorrection=.2*c.b2_lengthUnitsPerMeter,c.b2_maxAngularCorrection=8/180*c.b2_pi,c.b2_contactBaumgarte=.2,c.b2_timeToSleep=.5*c.b2_timeUnitsPerSecond,c.b2_linearSleepTolerance=.01*c.b2_lengthUnitsPerMeter/c.b2_timeUnitsPerSecond,c.b2_angularSleepTolerance=2/180/c.b2_timeUnitsPerSecond;var e;b.b2Vec2=e=e=function(){function a(a,b){this.x=a,this.y=b}return a.prototype.x=null,a.prototype.y=null,a.prototype.SetZero=function(){return this.x=0,this.y=0},a.prototype.Set=function(a,b){return this.x=a,this.y=b},a.prototype.SetV=function(a){return this.x=a.x,this.y=a.y},a.prototype.Negative=function(){return new a(-this.x,-this.y)},a.prototype.Copy=function(){return new a(this.x,this.y)},a.prototype.Add=function(a){return this.x+=a.x,this.y+=a.y},a.prototype.Subtract=function(a){return this.x-=a.x,this.y-=a.y},a.prototype.Multiply=function(a){return this.x*=a,this.y*=a},a.prototype.MulM=function(a){var b;return b=this.x,this.x=a.col1.x*b+a.col2.x*this.y,this.y=a.col1.y*b+a.col2.y*this.y},a.prototype.MulTM=function(a){var b;return b=g.b2Dot(this,a.col1),this.y=g.b2Dot(this,a.col2),this.x=b},a.prototype.CrossVF=function(a){var b;return b=this.x,this.x=a*this.y,this.y=-a*b},a.prototype.CrossFV=function(a){var b;return b=this.x,this.x=-a*this.y,this.y=a*b},a.prototype.MinV=function(a){return(this.x=this.x<a.x)?this.x:a.x,(this.y=this.y<a.y)?this.y:a.y},a.prototype.MaxV=function(a){return(this.x=this.x>a.x)?this.x:a.x,(this.y=this.y>a.y)?this.y:a.y},a.prototype.Abs=function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y)},a.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},a.prototype.Normalize=function(){var a,b;return b=this.Length(),b<Number.MIN_VALUE?0:(a=1/b,this.x*=a,this.y*=a,b)},a.prototype.IsValid=function(){return g.b2IsValid(this.x)&&g.b2IsValid(this.y)},a}(),e.Make=function(a,b){return new e(a,b)};var f;b.b2Mat22=f=f=function(){function a(a,b,c){var d,f;a==null&&(a=0),this.col1=new e,this.col2=new e,b!=null&&c!=null?(this.col1.SetV(b),this.col2.SetV(c)):(d=Math.cos(a),f=Math.sin(a),this.col1.x=d,this.col2.x=-f,this.col1.y=f,this.col2.y=d)}return a.prototype.Set=function(a){var b,c;return b=Math.cos(a),c=Math.sin(a),this.col1.x=b,this.col2.x=-c,this.col1.y=c,this.col2.y=b},a.prototype.SetVV=function(a,b){return this.col1.SetV(a),this.col2.SetV(b)},a.prototype.Copy=function(){return new a(0,this.col1,this.col2)},a.prototype.SetM=function(a){return this.col1.SetV(a.col1),this.col2.SetV(a.col2)},a.prototype.AddM=function(a){return this.col1.x+=a.col1.x,this.col1.y+=a.col1.y,this.col2.x+=a.col2.x,this.col2.y+=a.col2.y},a.prototype.SetIdentity=function(){return this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1},a.prototype.SetZero=function(){return this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0},a.prototype.Invert=function(a){var b,c,d,e,f;return b=this.col1.x,c=this.col2.x,d=this.col1.y,e=this.col2.y,f=b*e-c*d,f=1/f,a.col1.x=f*e,a.col2.x=-f*c,a.col1.y=-f*d,a.col2.y=f*b,a},a.prototype.Solve=function(a,b,c){var d,e,f,g,h;return d=this.col1.x,e=this.col2.x,f=this.col1.y,g=this.col2.y,h=d*g-e*f,h=1/h,a.x=h*(g*b-e*c),a.y=h*(d*c-f*b),a},a.prototype.Abs=function(){return this.col1.Abs(),this.col2.Abs()},a.prototype.col1=new e,a.prototype.col2=new e,a}();var g;b.b2Math=g=g=function(){function a(){}return a}(),g.b2IsValid=function(a){return isFinite(a)},g.b2Dot=function(a,b){return a.x*b.x+a.y*b.y},g.b2CrossVV=function(a,b){return a.x*b.y-a.y*b.x},g.b2CrossVF=function(a,b){return new e(b*a.y,-b*a.x)},g.b2CrossFV=function(a,b){return new e(-a*b.y,a*b.x)},g.b2MulMV=function(a,b){return new e(a.col1.x*b.x+a.col2.x*b.y,a.col1.y*b.x+a.col2.y*b.y)},g.b2MulTMV=function(a,b){return new e(g.b2Dot(b,a.col1),g.b2Dot(b,a.col2))},g.AddVV=function(a,b){return new e(a.x+b.x,a.y+b.y)},g.SubtractVV=function(a,b){return new e(a.x-b.x,a.y-b.y)},g.MulFV=function(a,b){return new e(a*b.x,a*b.y)},g.AddMM=function(a,b){return new f(0,g.AddVV(a.col1,b.col1),g.AddVV(a.col2,b.col2))},g.b2MulMM=function(a,b){return new f(0,g.b2MulMV(a,b.col1),g.b2MulMV(a,b.col2))},g.b2MulTMM=function(a,b){var c,d;return c=new e(g.b2Dot(a.col1,b.col1),g.b2Dot(a.col2,b.col1)),d=new e(g.b2Dot(a.col1,b.col2),g.b2Dot(a.col2,b.col2)),new f(0,c,d)},g.b2Abs=function(a){return a>0?a:-a},g.b2AbsV=function(a){return new e(g.b2Abs(a.x),g.b2Abs(a.y))},g.b2AbsM=function(a){return new f(0,g.b2AbsV(a.col1),g.b2AbsV(a.col2))},g.b2Min=function(a,b){return a<b?a:b},g.b2MinV=function(a,b){return new e(g.b2Min(a.x,b.x),g.b2Min(a.y,b.y))},g.b2Max=function(a,b){return a>b?a:b},g.b2MaxV=function(a,b){return new e(g.b2Max(a.x,b.x),g.b2Max(a.y,b.y))},g.b2Clamp=function(a,b,c){return g.b2Max(b,g.b2Min(a,c))},g.b2ClampV=function(a,b,c){return g.b2MaxV(b,g.b2MinV(a,c))},g.b2Swap=function(a,b){var c;return c=a[0],a[0]=b[0],b[0]=c},g.b2Random=function(){return Math.random()*2-1},g.b2NextPowerOfTwo=function(a){return a|=a>>1&2147483647,a|=a>>2&1073741823,a|=a>>4&268435455,a|=a>>8&16777215,a|=a>>16&65535,a+1},g.b2IsPowerOfTwo=function(a){return a>0&&(a&a-1)===0},g.tempVec2=new e,g.tempVec3=new e,g.tempVec4=new e,g.tempVec5=new e,g.tempMat=new f;var h;b.b2AABB=h=h=function(){function a(){this.minVertex=new e,this.maxVertex=new e}return a.prototype.minVertex=new e,a.prototype.maxVertex=new e,a.prototype.IsValid=function(){var a,b,c;return a=this.maxVertex.x,b=this.maxVertex.y,a=this.maxVertex.x,b=this.maxVertex.y,a-=this.minVertex.x,b-=this.minVertex.y,c=a>=0&&b>=0,c=c&&this.minVertex.IsValid()&&this.maxVertex.IsValid(),c},a}();var i;b.b2Bound=i=i=function(){function a(){}return a.prototype.IsLower=function(){return(this.value&1)===0},a.prototype.IsUpper=function(){return(this.value&1)===1},a.prototype.Swap=function(a){var b,c,d;return d=this.value,b=this.proxyId,c=this.stabbingCount,this.value=a.value,this.proxyId=a.proxyId,this.stabbingCount=a.stabbingCount,a.value=d,a.proxyId=b,a.stabbingCount=c},a.prototype.value=0,a.prototype.proxyId=0,a.prototype.stabbingCount=0,a}();var j;b.b2BoundValues=j=j=function(){function a(){this.lowerValues=[0,0],this.upperValues=[0,0]}return a.prototype.lowerValues=[0,0],a.prototype.upperValues=[0,0],a}();var k;b.b2Pair=k=k=function(){function a(){}return a.prototype.SetBuffered=function(){return this.status|=a.e_pairBuffered},a.prototype.ClearBuffered=function(){return this.status&=~a.e_pairBuffered},a.prototype.IsBuffered=function(){return(this.status&a.e_pairBuffered)===a.e_pairBuffered},a.prototype.SetRemoved=function(){return this.status|=a.e_pairRemoved},a.prototype.ClearRemoved=function(){return this.status&=~a.e_pairRemoved},a.prototype.IsRemoved=function(){return(this.status&a.e_pairRemoved)===a.e_pairRemoved},a.prototype.SetFinal=function(){return this.status|=a.e_pairFinal},a.prototype.IsFinal=function(){return(this.status&a.e_pairFinal)===a.e_pairFinal},a.prototype.userData=null,a.prototype.proxyId1=0,a.prototype.proxyId2=0,a.prototype.next=0,a.prototype.status=0,a}(),k.b2_nullPair=c.USHRT_MAX,k.b2_nullProxy=c.USHRT_MAX,k.b2_tableCapacity=c.b2_maxPairs,k.b2_tableMask=k.b2_tableCapacity-1,k.e_pairBuffered=1,k.e_pairRemoved=2,k.e_pairFinal=4;var l;b.b2PairCallback=l=l=function(){function a(){}return a.prototype.PairAdded=function(a,b){return null},a.prototype.PairRemoved=function(a,b,c){},a}();var m;b.b2BufferedPair=m=m=function(){function a(){}return a.prototype.proxyId1=0,a.prototype.proxyId2=0,a}();var n;b.b2PairManager=n=n=function(){function a(){var a,b,d,e,f;this.m_hashTable=new Array(k.b2_tableCapacity);for(a=0,b=k.b2_tableCapacity;0<=b?a<b:a>b;0<=b?a++:a--)this.m_hashTable[a]=k.b2_nullPair;this.m_pairs=new Array(c.b2_maxPairs);for(a=0,d=c.b2_maxPairs;0<=d?a<d:a>d;0<=d?a++:a--)this.m_pairs[a]=new k;this.m_pairBuffer=new Array(c.b2_maxPairs);for(a=0,e=c.b2_maxPairs;0<=e?a<e:a>e;0<=e?a++:a--)this.m_pairBuffer[a]=new m;for(a=0,f=c.b2_maxPairs;0<=f?a<f:a>f;0<=f?a++:a--)this.m_pairs[a].proxyId1=k.b2_nullProxy,this.m_pairs[a].proxyId2=k.b2_nullProxy,this.m_pairs[a].userData=null,this.m_pairs[a].status=0,this.m_pairs[a].next=a+1;this.m_pairs[c.b2_maxPairs-1].next=k.b2_nullPair,this.m_pairCount=0}return a.prototype.m_broadPhase=null,a.prototype.m_callback=null,a.prototype.m_pairs=null,a.prototype.m_freePair=0,a.prototype.m_pairCount=0,a.prototype.m_pairBuffer=null,a.prototype.m_pairBufferCount=0,a.prototype.m_hashTable=null,a.prototype.Initialize=function(a,b){return this.m_broadPhase=a,this.m_callback=b},a.prototype.AddBufferedPair=function(a,b){var c;c=this.AddPair(a,b),c.IsBuffered()===!1&&(c.SetBuffered(),this.m_pairBuffer[this.m_pairBufferCount].proxyId1=c.proxyId1,this.m_pairBuffer[this.m_pairBufferCount].proxyId2=c.proxyId2,++this.m_pairBufferCount),c.ClearRemoved();if(o.s_validate)return this.ValidateBuffer()},a.prototype.RemoveBufferedPair=function(a,b){var c;c=this.Find(a,b);if(c==null)return;c.IsBuffered()===!1&&(c.SetBuffered(),this.m_pairBuffer[this.m_pairBufferCount].proxyId1=c.proxyId1,this.m_pairBuffer[this.m_pairBufferCount].proxyId2=c.proxyId2,++this.m_pairBufferCount),c.SetRemoved();if(o.s_validate)return this.ValidateBuffer()},a.prototype.AddPair=function(b,c){var d,e,f,g;return b>c&&(g=b,b=c,c=g),d=a.Hash(b,c)&k.b2_tableMask,f=f=this.FindHash(b,c,d),f!==null?f:(e=this.m_freePair,f=this.m_pairs[e],this.m_freePair=f.next,f.proxyId1=b,f.proxyId2=c,f.status=0,f.userData=null,f.next=this.m_hashTable[d],this.m_hashTable[d]=e,++this.m_pairCount,f)},a.prototype.RemovePair=function(b,c){var d,e,f,g,h,i,j;b>c&&(i=b,b=c,c=i),d=a.Hash(b,c)&k.b2_tableMask,f=this.m_hashTable[d],g=null;while(f!==k.b2_nullPair){if(a.Equals(this.m_pairs[f],b,c))return e=f,g?g.next=this.m_pairs[f].next:this.m_hashTable[d]=this.m_pairs[f].next,h=this.m_pairs[e],j=h.userData,h.next=this.m_freePair,h.proxyId1=k.b2_nullProxy,h.proxyId2=k.b2_nullProxy,h.userData=null,h.status=0,this.m_freePair=e,--this.m_pairCount,j;g=this.m_pairs[f],f=g.next}return null},a.prototype.Find=function(b,c){var d,e;return b>c&&(e=b,b=c,c=e),d=a.Hash(b,c)&k.b2_tableMask,this.FindHash(b,c,d)},a.prototype.FindHash=function(b,c,d){var e;e=this.m_hashTable[d];while(e!==k.b2_nullPair&&a.Equals(this.m_pairs[e],b,c)===!1)e=this.m_pairs[e].next;return e===k.b2_nullPair?null:this.m_pairs[e]},a.prototype.Commit=function(){var a,b,c,d,e,f,g;f=0,c=this.m_broadPhase.m_proxyPool;for(a=0,g=this.m_pairBufferCount;0<=g?a<g:a>g;0<=g?a++:a--)b=this.Find(this.m_pairBuffer[a].proxyId1,this.m_pairBuffer[a].proxyId2),b.ClearBuffered(),d=c[b.proxyId1],e=c[b.proxyId2],b.IsRemoved()?(b.IsFinal()===!0&&this.m_callback.PairRemoved(d.userData,e.userData,b.userData),this.m_pairBuffer[f].proxyId1=b.proxyId1,this.m_pairBuffer[f].proxyId2=b.proxyId2,++f):b.IsFinal()===!1&&(b.userData=this.m_callback.PairAdded(d.userData,e.userData),b.SetFinal());for(a=0;0<=f?a<f:a>f;0<=f?a++:a--)this.RemovePair(this.m_pairBuffer[a].proxyId1,this.m_pairBuffer[a].proxyId2);this.m_pairBufferCount=0;if(o.s_validate)return this.ValidateTable()},a}(),n.Hash=function(a,b){var c;return c=b<<16&4294901760|a,c=~c+(c<<15&4294934528),c^=c>>12&1048575,c+=c<<2&4294967292,c^=c>>4&268435455,c*=2057,c^=c>>16&65535,c},n.Equals=function(a,b,c){return a.proxyId1===b&&a.proxyId2===c},n.EqualsPair=function(a,b){return a.proxyId1===b.proxyId1&&a.proxyId2===b.proxyId2};var o;b.b2BroadPhase=o=o=function(){function a(b,d){var f,g,h,j,l,m,o,p;this.m_pairManager=new n,this.m_proxyPool=new Array(c.b2_maxPairs),this.m_bounds=new Array(2*c.b2_maxProxies),this.m_queryResults=new Array(c.b2_maxProxies),this.m_quantizationFactor=new e,this.m_pairManager.Initialize(this,d),this.m_worldAABB=b,this.m_proxyCount=0;for(h=0,m=c.b2_maxProxies;0<=m?h<m:h>m;0<=m?h++:h--)this.m_queryResults[h]=0;this.m_bounds=new Array(2);for(h=0;h<2;h++){this.m_bounds[h]=new Array(2*c.b2_maxProxies);for(j=0,o=2*c.b2_maxProxies;0<=o?j<o:j>o;0<=o?j++:j--)this.m_bounds[h][j]=new i}f=b.maxVertex.x,g=b.maxVertex.y,f-=b.minVertex.x,g-=b.minVertex.y,this.m_quantizationFactor.x=c.USHRT_MAX/f,this.m_quantizationFactor.y=c.USHRT_MAX/g;for(h=0,p=c.b2_maxProxies-1;0<=p?h<p:h>p;0<=p?h++:h--)l=new x,this.m_proxyPool[h]=l,l.SetNext(h+1),l.timeStamp=0,l.overlapCount=a.b2_invalid,l.userData=null;l=new x,this.m_proxyPool[c.b2_maxProxies-1]=l,l.SetNext(k.b2_nullProxy),l.timeStamp=0,l.overlapCount=a.b2_invalid,l.userData=null,this.m_freeProxy=0,this.m_timeStamp=1,this.m_queryResultCount=0}return a.prototype.InRange=function(a){var b,c,d,e;return d=a.minVertex.x,e=a.minVertex.y,d-=this.m_worldAABB.maxVertex.x,e-=this.m_worldAABB.maxVertex.y,b=this.m_worldAABB.minVertex.x,c=this.m_worldAABB.minVertex.y,b-=a.maxVertex.x,c-=a.maxVertex.y,d=g.b2Max(d,b),e=g.b2Max(e,c),g.b2Max(d,e)<0},a.prototype.GetProxy=function(a){return(a===k.b2_nullProxy||this.m_proxyPool[a].IsValid()===!1)&&rerturn(null),this.m_proxyPool[a]},a.prototype.CreateProxy=function(a,b){var c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;o=this.m_freeProxy,m=this.m_proxyPool[o],this.m_freeProxy=m.GetNext(),m.overlapCount=0,m.userData=b,d=2*this.m_proxyCount,l=new Array,w=new Array,this.ComputeBounds(l,w,a);for(c=0;c<2;c++){e=this.m_bounds[c],j=0,u=0,k=[j],v=[u],this.Query(k,v,l[c],w[c],e,d,c),j=k[0],u=v[0],p=new Array,s=d-u;for(h=0;0<=s?h<s:h>s;0<=s?h++:h--)p[h]=new i,q=p[h],r=e[u+h],q.value=r.value,q.proxyId=r.proxyId,q.stabbingCount=r.stabbingCount;s=p.length,t=u+2;for(h=0;0<=s?h<s:h>s;0<=s?h++:h--)r=p[h],q=e[t+h],q.value=r.value,q.proxyId=r.proxyId,q.stabbingCount=r.stabbingCount;p=new Array,s=u-j;for(h=0;0<=s?h<s:h>s;0<=s?h++:h--)p[h]=new i,q=p[h],r=e[j+h],q.value=r.value,q.proxyId=r.proxyId,q.stabbingCount=r.stabbingCount;s=p.length,t=j+1;for(h=0;0<=s?h<s:h>s;0<=s?h++:h--)r=p[h],q=e[t+h],q.value=r.value,q.proxyId=r.proxyId,q.stabbingCount=r.stabbingCount;++u,e[j].value=l[c],e[j].proxyId=o,e[u].value=w[c],e[u].proxyId=o,e[j].stabbingCount=j===0?0:e[j-1].stabbingCount,e[u].stabbingCount=e[u-1].stabbingCount,g=j;while(g<u)e[g].stabbingCount++,++g;g=j;while(g<d+2)n=this.m_proxyPool[e[g].proxyId],e[g].IsLower()?n.lowerBounds[c]=g:n.upperBounds[c]=g,++g}++this.m_proxyCount;for(f=0,x=this.m_queryResultCount;0<=x?f<x:f>x;0<=x?f++:f--)this.m_pairManager.AddBufferedPair(o,this.m_queryResults[f]);return this.m_pairManager.Commit(),this.m_queryResultCount=0,this.IncrementTimeStamp(),o},a.prototype.DestroyProxy=function(b){var c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v;m=this.m_proxyPool[b],d=2*this.m_proxyCount;for(c=0;c<2;c++){e=this.m_bounds[c],k=m.lowerBounds[c],t=m.upperBounds[c],l=e[k].value,u=e[t].value,o=new Array,j=0,r=t-k-1,p,q;for(j=0;0<=r?j<r:j>r;0<=r?j++:j--)o[j]=new i,p=o[j],q=e[k+1+j],p.value=q.value,p.proxyId=q.proxyId,p.stabbingCount=q.stabbingCount;r=o.length,s=k;for(j=0;0<=r?j<r:j>r;0<=r?j++:j--)q=o[j],p=e[s+j],p.value=q.value,p.proxyId=q.proxyId,p.stabbingCount=q.stabbingCount;o=new Array,r=d-t-1;for(j=0;0<=r?j<r:j>r;0<=r?j++:j--)o[j]=new i,p=o[j],q=e[t+1+j],p.value=q.value,p.proxyId=q.proxyId,p.stabbingCount=q.stabbingCount;r=o.length,s=t-1;for(j=0;0<=r?j<r:j>r;0<=r?j++:j--)q=o[j],p=e[s+j],p.value=q.value,p.proxyId=q.proxyId,p.stabbingCount=q.stabbingCount;r=d-2,g=k;while(g<r)n=this.m_proxyPool[e[g].proxyId],e[g].IsLower()?n.lowerBounds[c]=g:n.upperBounds[c]=g,++g;r=t-1,h=k;while(h<r)e[h].stabbingCount--,++h;this.Query([0],[0],l,u,e,d-2,c)}for(f=0,v=this.m_queryResultCount;0<=v?f<v:f>v;0<=v?f++:f--)this.m_pairManager.RemoveBufferedPair(b,this.m_queryResults[f]);return this.m_pairManager.Commit(),this.m_queryResultCount=0,this.IncrementTimeStamp(),m.userData=null,m.overlapCount=a.b2_invalid,m.lowerBounds[0]=a.b2_invalid,m.lowerBounds[1]=a.b2_invalid,m.upperBounds[0]=a.b2_invalid,m.upperBounds[1]=a.b2_invalid,m.SetNext(this.m_freeProxy),this.m_freeProxy=b,--this.m_proxyCount},a.prototype.MoveProxy=function(a,b){var d,e,f,g,h,i,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;d=0,l=0,r=0;if(a===k.b2_nullProxy||c.b2_maxProxies<=a)return;if(b.IsValid()===!1)return;f=2*this.m_proxyCount,w=this.m_proxyPool[a],o=new j,this.ComputeBounds(o.lowerValues,o.upperValues,b),s=new j;for(d=0;d<2;d++)s.lowerValues[d]=this.m_bounds[d][w.lowerBounds[d]].value,s.upperValues[d]=this.m_bounds[d][w.upperBounds[d]].value;z=[];for(d=0;d<2;d++){g=this.m_bounds[d],m=w.lowerBounds[d],x=w.upperBounds[d],n=o.lowerValues[d],y=o.upperValues[d],h=n-g[m].value,i=y-g[x].value,g[m].value=n,g[x].value=y;if(h<0){l=m;while(l>0&&n<g[l-1].value)e=g[l],t=g[l-1],v=t.proxyId,u=this.m_proxyPool[t.proxyId],t.stabbingCount++,t.IsUpper()===!0?(this.TestOverlap(o,u)&&this.m_pairManager.AddBufferedPair(a,v),u.upperBounds[d]++,e.stabbingCount++):(u.lowerBounds[d]++,e.stabbingCount--),w.lowerBounds[d]--,e.Swap(t),--l}if(i>0){l=x;while(l<f-1&&g[l+1].value<=y)e=g[l],p=g[l+1],r=p.proxyId,q=this.m_proxyPool[r],p.stabbingCount++,p.IsLower()===!0?(this.TestOverlap(o,q)&&this.m_pairManager.AddBufferedPair(a,r),q.lowerBounds[d]--,e.stabbingCount++):(q.upperBounds[d]--,e.stabbingCount--),w.upperBounds[d]++,e.Swap(p),l++}if(h>0){l=m;while(l<f-1&&g[l+1].value<=n)e=g[l],p=g[l+1],r=p.proxyId,q=this.m_proxyPool[r],p.stabbingCount--,p.IsUpper()?(this.TestOverlap(s,q)&&this.m_pairManager.RemoveBufferedPair(a,r),q.upperBounds[d]--,e.stabbingCount--):(q.lowerBounds[d]--,e.stabbingCount++),w.lowerBounds[d]++,e.Swap(p),l++}z.push(function(){var b;if(i<0){l=x,b=[];while(l>0&&y<g[l-1].value)e=g[l],t=g[l-1],v=t.proxyId,u=this.m_proxyPool[v],t.stabbingCount--,t.IsLower()===!0?(this.TestOverlap(s,u)&&this.m_pairManager.RemoveBufferedPair(a,v),u.lowerBounds[d]++,e.stabbingCount--):(u.upperBounds[d]++,e.stabbingCount++),w.upperBounds[d]--,e.Swap(t),b.push(l--);return b}}.call(this))}return z},a.prototype.Commit=function(){return this.m_pairManager.Commit()},a.prototype.ComputeBounds=function(a,b,d){var e,f,h,i;return h=d.minVertex.x,i=d.minVertex.y,h=g.b2Min(h,this.m_worldAABB.maxVertex.x),i=g.b2Min(i,this.m_worldAABB.maxVertex.y),h=g.b2Max(h,this.m_worldAABB.minVertex.x),i=g.b2Max(i,this.m_worldAABB.minVertex.y),e=d.maxVertex.x,f=d.maxVertex.y,e=g.b2Min(e,this.m_worldAABB.maxVertex.x),f=g.b2Min(f,this.m_worldAABB.maxVertex.y),e=g.b2Max(e,this.m_worldAABB.minVertex.x),f=g.b2Max(f,this.m_worldAABB.minVertex.y),a[0]=this.m_quantizationFactor.x*(h-this.m_worldAABB.minVertex.x)&c.USHRT_MAX-1,b[0]=this.m_quantizationFactor.x*(e-this.m_worldAABB.minVertex.x)&65535|1,a[1]=this.m_quantizationFactor.y*(i-this.m_worldAABB.minVertex.y)&c.USHRT_MAX-1,b[1]=this.m_quantizationFactor.y*(f-this.m_worldAABB.minVertex.y)&65535|1},a.prototype.TestOverlapValidate=function(a,b){var c,d;for(c=0;c<2;c++){d=this.m_bounds[c];if(d[a.lowerBounds[c]].value>d[b.upperBounds[c]].value)return!1;if(d[a.upperBounds[c]].value<d[b.lowerBounds[c]].value)return!1}return!0},a.prototype.TestOverlap=function(a,b){var c,d;for(c=0;c<2;c++){d=this.m_bounds[c];if(a.lowerValues[c]>d[b.upperBounds[c]].value)return!1;if(a.upperValues[c]<d[b.lowerBounds[c]].value)return!1}return!0},a.prototype.Query=function(b,c,d,e,f,g,h){var i,j,k,l,m,n;k=a.BinarySearch(f,g,d),n=a.BinarySearch(f,g,e),j=k;while(j<n)f[j].IsLower()&&this.IncrementOverlapCount(f[j].proxyId),++j;if(k>0){i=k-1,m=f[i].stabbingCount;while(m)f[i].IsLower()&&(l=this.m_proxyPool[f[i].proxyId],k<=l.upperBounds[h]&&(this.IncrementOverlapCount(f[i].proxyId),--m)),--i}return b[0]=k,c[0]=n},a.prototype.IncrementOverlapCount=function(a){var b;return b=this.m_proxyPool[a],b.timeStamp<this.m_timeStamp?(b.timeStamp=this.m_timeStamp,b.overlapCount=1):(b.overlapCount=2,this.m_queryResults[this.m_queryResultCount]=a,++this.m_queryResultCount)},a.prototype.IncrementTimeStamp=function(){var a,b;if(this.m_timeStamp===c.USHRT_MAX){for(a=0,b=c.b2_maxProxies;0<=b?a<b:a>b;0<=b?a++:a--)this.m_proxyPool[a].timeStamp=0;return this.m_timeStamp=1}return++this.m_timeStamp},a}(),o.s_validate=!1,o.b2_invalid=c.USHRT_MAX,o.b2_nullEdge=c.USHRT_MAX,o.BinarySearch=function(a,b,c){var d,e,f;e=0,d=b-1;while(e<=d){f=Math.floor((e+d)/2);if(a[f].value>c)d=f-1;else if(a[f].value<c)e=f+1;else return f}return e};var p;b.b2Collision=p=p=function(){function a(){}return a}(),p.b2_nullFeature=255,p.ClipSegmentToLine=function(a,b,c,d){var e,f,h,i,j,k,l;return i=0,k=b[0].v,l=b[1].v,e=g.b2Dot(c,b[0].v)-d,f=g.b2Dot(c,b[1].v)-d,e<=0&&(a[i++]=b[0]),f<=0&&(a[i++]=b[1]),e*f<0&&(h=e/(e-f),j=a[i].v,j.x=k.x+h*(l.x-k.x),j.y=k.y+h*(l.y-k.y),e>0?a[i].id=b[0].id:a[i].id=b[1].id,++i),i},p.EdgeSeparation=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;t=a.m_vertices,d=c.m_vertexCount,u=c.m_vertices,j=a.m_normals[b].x,k=a.m_normals[b].y,o=j,m=a.m_R,j=m.col1.x*o+m.col2.x*k,k=m.col1.y*o+m.col2.y*k,h=j,i=k,m=c.m_R,o=h*m.col1.x+i*m.col1.y,i=h*m.col2.x+i*m.col2.y,h=o,v=0,g=Number.MAX_VALUE;for(f=0;0<=d?f<d:f>d;0<=d?f++:f--)n=u[f],e=n.x*h+n.y*i,e<g&&(g=e,v=f);return m=a.m_R,p=a.m_position.x+(m.col1.x*t[b].x+m.col2.x*t[b].y),q=a.m_position.y+(m.col1.y*t[b].x+m.col2.y*t[b].y),m=c.m_R,r=c.m_position.x+(m.col1.x*u[v].x+m.col2.x*u[v].y),s=c.m_position.y+(m.col1.y*u[v].x+m.col2.y*u[v].y),r-=p,s-=q,l=r*j+s*k,l},p.FindMaxSeparation=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,q,r,s,t,u,v;g=b.m_vertexCount,j=c.m_position.x-b.m_position.x,k=c.m_position.y-b.m_position.y,h=j*b.m_R.col1.x+k*b.m_R.col1.y,i=j*b.m_R.col2.x+k*b.m_R.col2.y,m=0,q=-Number.MAX_VALUE;for(n=0;0<=g?n<g:n>g;0<=g?n++:n--)l=b.m_normals[n].x*h+b.m_normals[n].y*i,l>q&&(q=l,m=n);t=p.EdgeSeparation(b,m,c);if(t>0&&d===!1)return t;s=m-1>=0?m-1:g-1,v=p.EdgeSeparation(b,s,c);if(v>0&&d===!1)return v;r=m+1<g?m+1:0,u=p.EdgeSeparation(b,r,c);if(u>0&&d===!1)return u;e=0,o=0;if(v>t&&v>u)o=-1,e=s,f=v;else if(u>t)o=1,e=r,f=u;else return a[0]=m,t;for(;;){o===-1?m=e-1>=0?e-1:g-1:m=e+1<g?e+1:0,t=p.EdgeSeparation(b,m,c);if(t>0&&d===!1)return t;if(t>f)e=m,f=t;else break}return a[0]=e,f},p.FindIncidentEdge=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D;e=b.m_vertexCount,y=b.m_vertices,f=d.m_vertexCount,z=d.m_vertices,A=c,B=c+1===e?0:c+1,w=y[B],m=w.x,n=w.y,w=y[A],m-=w.x,n-=w.y,x=m,m=n,n=-x,k=1/Math.sqrt(m*m+n*n),m*=k,n*=k,q=m,r=n,x=q,v=b.m_R,q=v.col1.x*x+v.col2.x*r,r=v.col1.y*x+v.col2.y*r,o=q,p=r,v=d.m_R,x=o*v.col1.x+p*v.col1.y,p=o*v.col2.x+p*v.col2.y,o=x,C=0,D=0,l=Number.MAX_VALUE;for(h=0;0<=f?h<f:h>f;0<=f?h++:h--)i=h,j=h+1<f?h+1:0,w=z[j],s=w.x,t=w.y,w=z[i],s-=w.x,t-=w.y,x=s,s=t,t=-x,k=1/Math.sqrt(s*s+t*t),s*=k,t*=k,g=s*o+t*p,g<l&&(l=g,C=i,D=j);return u,u=a[0],w=u.v,w.SetV(z[C]),w.MulM(d.m_R),w.Add(d.m_position),u.id.features.referenceFace=c,u.id.features.incidentEdge=C,u.id.features.incidentVertex=C,u=a[1],w=u.v,w.SetV(z[D]),w.MulM(d.m_R),w.Add(d.m_position),u.id.features.referenceFace=c,u.id.features.incidentEdge=C,u.id.features.incidentVertex=D},p.b2CollidePolyTempVec=new e,p.b2CollidePoly=function(a,b,d,e){var f,g,h,i,j,k,l,m,n,o,q,r,s,t,u,v,w,x,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W;a.pointCount=0,m=0,n=[m],G=p.FindMaxSeparation(n,b,d,e),m=n[0];if(G>0&&e===!1)return;o=0,q=[o],H=p.FindMaxSeparation(q,d,b,e),o=q[0];if(H>0&&e===!1)return;l=0,r=0,A=.98,z=.001,H>A*G+z?(D=d,E=b,l=o,r=1):(D=b,E=d,l=m,r=0),w=[new y,new y],p.FindIncidentEdge(w,D,l,E),h=D.m_vertexCount,V=D.m_vertices,P=V[l],S=l+1<h?V[l+1]:V[0],j=S.x-P.x,k=S.y-P.y,I=S.x-P.x,J=S.y-P.y,O=I,M=D.m_R,I=M.col1.x*O+M.col2.x*J,J=M.col1.y*O+M.col2.y*J,x=1/Math.sqrt(I*I+J*J),I*=x,J*=x,s=I,t=J,O=s,s=t,t=-O,Q=P.x,R=P.y,O=Q,M=D.m_R,Q=M.col1.x*O+M.col2.x*R,R=M.col1.y*O+M.col2.y*R,Q+=D.m_position.x,R+=D.m_position.y,T=S.x,U=S.y,O=T,M=D.m_R,T=M.col1.x*O+M.col2.x*U,U=M.col1.y*O+M.col2.y*U,T+=D.m_position.x,U+=D.m_position.y,u=s*Q+t*R,K=-(I*Q+J*R),L=I*T+J*U,f=[new y,new y],g=[new y,new y],B=0,p.b2CollidePolyTempVec.Set(-I,-J),B=p.ClipSegmentToLine(f,w,p.b2CollidePolyTempVec,K);if(B<2)return;p.b2CollidePolyTempVec.Set(I,J),B=p.ClipSegmentToLine(g,f,p.b2CollidePolyTempVec,L);if(B<2)return;r?a.normal.Set(-s,-t):a.normal.Set(s,t),C=0;for(v=0,W=c.b2_maxManifoldPoints;0<=W?v<W:v>W;0<=W?v++:v--){N=g[v].v,F=s*N.x+t*N.y-u;if(F<=0||e===!0)i=a.points[C],i.separation=F,i.position.SetV(g[v].v),i.id.Set(g[v].id),i.id.features.flip=r,++C}return a.pointCount=C},p.b2CollideCircle=function(a,b,c,d){var e,f,g,h,i,j,k,l;a.pointCount=0,f=c.m_position.x-b.m_position.x,g=c.m_position.y-b.m_position.y,i=f*f+g*g,j=b.m_radius+c.m_radius;if(i>j*j&&d===!1)return;return i<Number.MIN_VALUE?(k=-j,a.normal.Set(0,1)):(h=Math.sqrt(i),k=h-j,e=1/h,a.normal.x=e*f,a.normal.y=e*g),a.pointCount=1,l=a.points[0],l.id.set_key(0),l.separation=k,l.position.x=c.m_position.x-c.m_radius*a.normal.x,l.position.y=c.m_position.y-c.m_radius*a.normal.y},p.b2CollidePolyAndCircle=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,q,r,s,t,u,v,w,x,y,z,A,B;a.pointCount=0,z=c.m_position.x-b.m_position.x,A=c.m_position.y-b.m_position.y,s=b.m_R,v=z*s.col1.x+A*s.col1.y,A=z*s.col2.x+A*s.col2.y,z=v,l=0,r=-Number.MAX_VALUE,o=c.m_radius;for(j=0,B=b.m_vertexCount;0<=B?j<B:j>B;0<=B?j++:j--){q=b.m_normals[j].x*(z-b.m_vertices[j].x)+b.m_normals[j].y*(A-b.m_vertices[j].y);if(q>o)return;q>r&&(r=q,l=j)}if(r<Number.MIN_VALUE){a.pointCount=1,u=b.m_normals[l],a.normal.x=s.col1.x*u.x+s.col2.x*u.y,a.normal.y=s.col1.y*u.x+s.col2.y*u.y,t=a.points[0],t.id.features.incidentEdge=l,t.id.features.incidentVertex=p.b2_nullFeature,t.id.features.referenceFace=p.b2_nullFeature,t.id.features.flip=0,t.position.x=c.m_position.x-o*a.normal.x,t.position.y=c.m_position.y-o*a.normal.y,t.separation=r-o;return}x=l,y=x+1<b.m_vertexCount?x+1:0,h=b.m_vertices[y].x-b.m_vertices[x].x,i=b.m_vertices[y].y-b.m_vertices[x].y,k=Math.sqrt(h*h+i*i),h/=k,i/=k;if(k<Number.MIN_VALUE){e=z-b.m_vertices[x].x,f=A-b.m_vertices[x].y,g=Math.sqrt(e*e+f*f),e/=g,f/=g;if(g>o)return;a.pointCount=1,a.normal.Set(s.col1.x*e+s.col2.x*f,s.col1.y*e+s.col2.y*f),t=a.points[0],t.id.features.incidentEdge=p.b2_nullFeature,t.id.features.incidentVertex=x,t.id.features.referenceFace=p.b2_nullFeature,t.id.features.flip=0,t.position.x=c.m_position.x-o*a.normal.x,t.position.y=c.m_position.y-o*a.normal.y,t.separation=g-o;return}w=(z-b.m_vertices[x].x)*h+(A-b.m_vertices[x].y)*i,t=a.points[0],t.id.features.incidentEdge=p.b2_nullFeature,t.id.features.incidentVertex=p.b2_nullFeature,t.id.features.referenceFace=p.b2_nullFeature,t.id.features.flip=0,w<=0?(m=b.m_vertices[x].x,n=b.m_vertices[x].y,t.id.features.incidentVertex=x):w>=k?(m=b.m_vertices[y].x,n=b.m_vertices[y].y,t.id.features.incidentVertex=y):(m=h*w+b.m_vertices[x].x,n=i*w+b.m_vertices[x].y,t.id.features.incidentEdge=x),e=z-m,f=A-n,g=Math.sqrt(e*e+f*f),e/=g,f/=g;if(g>o)return;return a.pointCount=1,a.normal.Set(s.col1.x*e+s.col2.x*f,s.col1.y*e+s.col2.y*f),t.position.x=c.m_position.x-o*a.normal.x,t.position.y=c.m_position.y-o*a.normal.y,t.separation=g-o},p.b2TestOverlap=function(a,b){var c,d,e,f,g,h;return g=b.minVertex,h=a.maxVertex,c=g.x-h.x,d=g.y-h.y,g=a.minVertex,h=b.maxVertex,e=g.x-h.x,f=g.y-h.y,c>0||d>0?!1:e>0||f>0?!1:!0};var q;b.Features=q=q=function(){function a(){}return a}();var r;b.b2ContactID=r=r=function(){function a(){this.features=new q,this.features._m_id=this}return a.prototype.Set=function(a){return this.set_key(a._key)},a.prototype.Copy=function(){var b;return b=new a,b.set_key(this._key),b},a.prototype.get_key=function(){return this._key},a.prototype.set_key=function(a){return this._key=a,this.features._referenceFace=this._key&255,this.features._incidentEdge=(this._key&65280)>>8&255,this.features._incidentVertex=(this._key&16711680)>>16&255,this.features._flip=(this._key&4278190080)>>24&255},a.prototype.features=new q,a.prototype._key=0,a}();var s;b.b2ContactPoint=s=s=function(){function a(){this.position=new e,this.id=new r}return a.prototype.position=new e,a.prototype.separation=null,a.prototype.normalImpulse=null,a.prototype.tangentImpulse=null,a.prototype.id=new r,a}();var t;b.b2Distance=t=t=function(){function a(){}return a}(),t.ProcessTwo=function(a,b,c,d,e){var f,g,h,i,j,k;return j=-e[1].x,k=-e[1].y,f=e[0].x-e[1].x,g=e[0].y-e[1].y,i=Math.sqrt(f*f+g*g),f/=i,g/=i,h=j*f+k*g,h<=0||i<Number.MIN_VALUE?(a.SetV(c[1]),b.SetV(d[1]),c[0].SetV(c[1]),d[0].SetV(d[1]),e[0].SetV(e[1]),1):(h/=i,a.x=c[1].x+h*(c[0].x-c[1].x),a.y=c[1].y+h*(c[0].y-c[1].y),b.x=d[1].x+h*(d[0].x-d[1].x),b.y=d[1].y+h*(d[0].y-d[1].y),2)},t.ProcessThree=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;return f=e[0].x,g=e[0].y,l=e[1].x,m=e[1].y,p=e[2].x,q=e[2].y,h=l-f,i=m-g,j=p-f,k=q-g,n=p-l,o=q-m,v=-(f*h+g*i),u=l*h+m*i,x=-(f*j+g*k),w=p*j+q*k,A=-(l*n+m*o),z=p*n+q*o,w<=0&&z<=0?(a.SetV(c[2]),b.SetV(d[2]),c[0].SetV(c[2]),d[0].SetV(d[2]),e[0].SetV(e[2]),1):(t=h*k-i*j,E=t*(f*m-g*l),C=t*(l*q-m*p),C<=0&&A>=0&&z>=0?(s=A/(A+z),a.x=c[1].x+s*(c[2].x-c[1].x),a.y=c[1].y+s*(c[2].y-c[1].y),b.x=d[1].x+s*(d[2].x-d[1].x),b.y=d[1].y+s*(d[2].y-d[1].y),c[0].SetV(c[2]),d[0].SetV(d[2]),e[0].SetV(e[2]),2):(D=t*(p*g-q*f),D<=0&&x>=0&&w>=0?(s=x/(x+w),a.x=c[0].x+s*(c[2].x-c[0].x),a.y=c[0].y+s*(c[2].y-c[0].y),b.x=d[0].x+s*(d[2].x-d[0].x),b.y=d[0].y+s*(d[2].y-d[0].y),c[1].SetV(c[2]),d[1].SetV(d[2]),e[1].SetV(e[2]),2):(r=C+D+E,r=1/r,y=C*r,B=D*r,F=1-y-B,a.x=y*c[0].x+B*c[1].x+F*c[2].x,a.y=y*c[0].y+B*c[1].y+F*c[2].y,b.x=y*d[0].x+B*d[1].x+F*d[2].x,b.y=y*d[0].y+B*d[1].y+F*d[2].y,3)))},t.InPoinsts=function(a,b,c){var d;for(d=0;0<=c?d<c:d>c;0<=c?d++:d--)if(a.x===b[d].x&&a.y===b[d].y)return!0;return!1},t.Distance=function(a,b,c,d){var e,f,h,i,j,k,l,m,n,o,p,q,r,s,u,v;j=new Array(3),k=new Array(3),m=new Array(3),l=0,a.SetV(c.m_position),b.SetV(d.m_position),n=0,h=20;for(f=0;0<=h?f<h:f>h;0<=h?f++:f--){o=b.x-a.x,p=b.y-a.y,r=c.Support(o,p),s=d.Support(-o,-p),n=o*o+p*p,u=s.x-r.x,v=s.y-r.y,q=o*u+p*v;if(n-b2Dot(o*u+p*v)<=.01*n)return l===0&&(a.SetV(r),b.SetV(s)),t.g_GJK_Iterations=f,Math.sqrt(n);switch(l){case 0:j[0].SetV(r),k[0].SetV(s),m[0]=w,a.SetV(j[0]),b.SetV(k[0]),++l;break;case 1:j[1].SetV(r),k[1].SetV(s),m[1].x=u,m[1].y=v,l=t.ProcessTwo(a,b,j,k,m);break;case 2:j[2].SetV(r),k[2].SetV(s),m[2].x=u,m[2].y=v,l=t.ProcessThree(a,b,j,k,m)}if(l===3)return t.g_GJK_Iterations=f,0;i=-Number.MAX_VALUE;for(e=0;0<=l?e<l:e>l;0<=l?e++:e--)i=g.b2Max(i,m[e].x*m[e].x+m[e].y*m[e].y);if(l===3||n<=100*Number.MIN_VALUE*i)return t.g_GJK_Iterations=f,Math.sqrt(n)}return t.g_GJK_Iterations=h,Math.sqrt(n)},t.g_GJK_Iterations=0;var u;b.b2Manifold=u=u=function(){function a(){var a,b;this.points=new Array(c.b2_maxManifoldPoints);for(a=0,b=c.b2_maxManifoldPoints;0<=b?a<b:a>b;0<=b?a++:a--)this.points[a]=new s;this.normal=new e}return a.prototype.points=null,a.prototype.normal=null,a.prototype.pointCount=0,a}();var v;b.b2OBB=v=v=function(){function a(){this.R=new f,this.center=new e,this.extents=new e}return a.prototype.R=new f,a.prototype.center=new e,a.prototype.extents=new e,a}();var x;b.b2Proxy=x=x=function(){function a(){this.lowerBounds=[0,0],this.upperBounds=[0,0]}return a.prototype.GetNext=function(){return this.lowerBounds[0]},a.prototype.SetNext=function(a){return this.lowerBounds[0]=a},a.prototype.IsValid=function(){return this.overlapCount!==o.b2_invalid},a.prototype.lowerBounds=[0,0],a.prototype.upperBounds=[0,0],a.prototype.overlapCount=0,a.prototype.timeStamp=0,a.prototype.userData=null,a}();var y;b.ClipVertex=y=y=function(){function a(){this.v=new e,this.id=new r}return a.prototype.v=new e,a.prototype.id=new r,a}();var z;b.b2Shape=z=z=function(){function a(a,b){this.m_R=new f,this.m_position=new e,this.m_userData=a.userData,this.m_friction=a.friction,this.m_restitution=a.restitution,this.m_body=b,this.m_proxyId=k.b2_nullProxy,this.m_maxRadius=0,this.m_categoryBits=a.categoryBits,this.m_maskBits=a.maskBits,this.m_groupIndex=a.groupIndex}return a.prototype.TestPoint=function(a){return!1},a.prototype.GetUserData=function(){return this.m_userData},a.prototype.GetType=function(){return this.m_type},a.prototype.GetBody=function(){return this.m_body},a.prototype.GetPosition=function(){return this.m_position},a.prototype.GetRotationMatrix=function(){return this.m_R},a.prototype.ResetProxy=function(a){},a.prototype.GetNext=function(){return this.m_next},a.prototype.DestroyProxy=function(){if(this.m_proxyId!==k.b2_nullProxy)return this.m_body.m_world.m_broadPhase.DestroyProxy(this.m_proxyId),this.m_proxyId=k.b2_nullProxy},a.prototype.Synchronize=function(a,b,c,d){},a.prototype.QuickSync=function(a,b){},a.prototype.Support=function(a,b,c){},a.prototype.GetMaxRadius=function(){return this.m_maxRadius},a.prototype.m_next=null,a.prototype.m_R=new f,a.prototype.m_position=new e,a.prototype.m_type=0,a.prototype.m_userData=null,a.prototype.m_body=null,a.prototype.m_friction=null,a.prototype.m_restitution=null,a.prototype.m_maxRadius=null,a.prototype.m_proxyId=0,a.prototype.m_categoryBits=0,a.prototype.m_maskBits=0,a.prototype.m_groupIndex=0,a}(),z.Create=function(a,b,c){switch(a.type){case z.e_circleShape:return new F(a,b,c);case z.e_boxShape:case z.e_polyShape:return new I(a,b,c);default:return null}},z.Destroy=function(a){if(a.m_proxyId!==k.b2_nullProxy)return a.m_body.m_world.m_broadPhase.DestroyProxy(a.m_proxyId)},z.PolyMass=function(a,b,c,d){var f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;j=new e,j.SetZero(),i=0,h=0,x=new e(0,0),t=1/3;for(q=0;0<=c?q<c:q>c;0<=c?q++:q--)u=x,v=b[q],w=q+1<c?b[q+1]:b[0],k=g.SubtractVV(v,u),l=g.SubtractVV(w,u),f=g.b2CrossVV(k,l),B=.5*f,i+=B,A=new e,A.SetV(u),A.Add(v),A.Add(w),A.Multiply(t*B),j.Add(A),y=u.x,z=u.y,m=k.x,o=k.y,n=l.x,p=l.y,r=t*(.25*(m*m+n*m+n*n)+(y*m+y*n))+.5*y*y,s=t*(.25*(o*o+p*o+p*p)+(z*o+z*p))+.5*z*z,h+=f*(r+s);return a.mass=d*i,j.Multiply(1/i),a.center=j,h=d*(h-i*g.b2Dot(j,j)),a.I=h},z.PolyCentroid=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;f=0,g=0,e=0,t=0,u=0,m=1/3;for(l=0;0<=b?l<b:l>b;0<=b?l++:l--)n=t,o=u,p=a[l].x,q=a[l].y,r=l+1<b?a[l+1].x:a[0].x,s=l+1<b?a[l+1].y:a[0].y,h=p-n,i=q-o,j=r-n,k=s-o,d=h*k-i*j,v=.5*d,e+=v,f+=v*m*(n+p+r),g+=v*m*(o+q+s);return f*=1/e,g*=1/e,c.Set(f,g)},z.e_unknownShape=-1,z.e_circleShape=0,z.e_boxShape=1,z.e_polyShape=2,z.e_meshShape=3,z.e_shapeTypeCount=4;var A;b.b2ShapeDef=A=A=function(){function a(){this.type=z.e_unknownShape,this.userData=null,this.localPosition=new e(0,0),this.localRotation=0,this.friction=.2,this.restitution=0,this.density=0,this.categoryBits=1,this.maskBits=65535,this.groupIndex=0}return a.prototype.type=0,a.prototype.userData=null,a.prototype.localPosition=null,a.prototype.localRotation=null,a.prototype.friction=null,a.prototype.restitution=null,a.prototype.density=null,a.prototype.ComputeMass=function(a){var b,d,f;a.center=new e(0,0),this.density===0&&(a.mass=0,a.center.Set(0,0),a.I=0);switch(this.type){case z.e_circleShape:return d=this,a.mass=this.density*c.b2_pi*d.radius*d.radius,a.center.Set(0,0),a.I=.5*a.mass*d.radius*d.radius;case z.e_boxShape:return b=this,a.mass=4*this.density*b.extents.x*b.extents.y,a.center.Set(0,0),a.I=a.mass/3*g.b2Dot(b.extents,b.extents);case z.e_polyShape:return f=this,z.PolyMass(a,f.vertices,f.vertexCount,this.density);default:return a.mass=0,a.center.Set(0,0),a.I=0}},a.prototype.categoryBits=0,a.prototype.maskBits=0,a.prototype.groupIndex=0,a}();var B,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2BoxDef=B=B=function(){function a(){this.type=z.e_unknownShape,this.userData=null,this.localPosition=new e(0,0),this.localRotation=0,this.friction=.2,this.restitution=0,this.density=0,this.categoryBits=1,this.maskBits=65535,this.groupIndex=0,this.type=z.e_boxShape,this.extents=new e(1,1)}return D(a,A),a.prototype.extents=null,a}();var E,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2CircleDef=E=E=function(){function a(){this.type=z.e_unknownShape,this.userData=null,this.localPosition=new e(0,0),this.localRotation=0,this.friction=.2,this.restitution=0,this.density=0,this.categoryBits=1,this.maskBits=65535,this.groupIndex=0,this.type=z.e_circleShape,this.radius=1}return D(a,A),a.prototype.radius=null,a}();var F,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2CircleShape=F=F=function(){function a(a,b,c){var d,g,i,j,l;this.m_R=new f,this.m_position=new e,this.m_userData=a.userData,this.m_friction=a.friction,this.m_restitution=a.restitution,this.m_body=b,this.m_proxyId=k.b2_nullProxy,this.m_maxRadius=0,this.m_categoryBits=a.categoryBits,this.m_maskBits=a.maskBits,this.m_groupIndex=a.groupIndex,this.m_localPosition=new e,i=a,this.m_localPosition.Set(a.localPosition.x-c.x,a.localPosition.y-c.y),this.m_type=z.e_circleShape,this.m_radius=i.radius,this.m_R.SetM(this.m_body.m_R),j=this.m_R.col1.x*this.m_localPosition.x+this.m_R.col2.x*this.m_localPosition.y,l=this.m_R.col1.y*this.m_localPosition.x+this.m_R.col2.y*this.m_localPosition.y,this.m_position.x=this.m_body.m_position.x+j,this.m_position.y=this.m_body.m_position.y+l,this.m_maxRadius=Math.sqrt(j*j+l*l)+this.m_radius,d=new h,d.minVertex.Set(this.m_position.x-this.m_radius,this.m_position.y-this.m_radius),d.maxVertex.Set(this.m_position.x+this.m_radius,this.m_position.y+this.m_radius),g=this.m_body.m_world.m_broadPhase,g.InRange(d)?this.m_proxyId=g.CreateProxy(d,this):this.m_proxyId=k.b2_nullProxy,this.m_proxyId===k.b2_nullProxy&&this.m_body.Freeze()}return D(a,z),a.prototype.TestPoint=function(a){var b;return b=new e,b.SetV(a),b.Subtract(this.m_position),g.b2Dot(b,b)<=this.m_radius*this.m_radius},a.prototype.Synchronize=function(a,b,c,d){var e,f,g,i,j,l,m,n;this.m_R.SetM(d),this.m_position.x=d.col1.x*this.m_localPosition.x+d.col2.x*this.m_localPosition.y+c.x,this.m_position.y=d.col1.y*this.m_localPosition.x+d.col2.y*this.m_localPosition.y+c.y;if(this.m_proxyId===k.b2_nullProxy)return;return j=a.x+(b.col1.x*this.m_localPosition.x+b.col2.x*this.m_localPosition.y),l=a.y+(b.col1.y*this.m_localPosition.x+b.col2.y*this.m_localPosition.y),g=Math.min(j,this.m_position.x),i=Math.min(l,this.m_position.y),m=Math.max(j,this.m_position.x),n=Math.max(l,this.m_position.y),e=new h,e.minVertex.Set(g-this.m_radius,i-this.m_radius),e.maxVertex.Set(m+this.m_radius,n+this.m_radius),f=this.m_body.m_world.m_broadPhase,f.InRange(e)?f.MoveProxy(this.m_proxyId,e):this.m_body.Freeze()},a.prototype.QuickSync=function(a,b){return this.m_R.SetM(b),this.m_position.x=b.col1.x*this.m_localPosition.x+b.col2.x*this.m_localPosition.y+a.x,this.m_position.y=b.col1.y*this.m_localPosition.x+b.col2.y*this.m_localPosition.y+a.y},a.prototype.ResetProxy=function(a){var b,c;if(this.m_proxyId===k.b2_nullProxy)return;c=a.GetProxy(this.m_proxyId),a.DestroyProxy(this.m_proxyId),c=null,b=new h,b.minVertex.Set(this.m_position.x-this.m_radius,this.m_position.y-this.m_radius),b.maxVertex.Set(this.m_position.x+this.m_radius,this.m_position.y+this.m_radius),a.InRange(b)?this.m_proxyId=a.CreateProxy(b,this):this.m_proxyId=k.b2_nullProxy;if(this.m_proxyId===k.b2_nullProxy)return this.m_body.Freeze()},a.prototype.Support=function(a,b,c){var d;return d=Math.sqrt(a*a+b*b),a/=d,b/=d,c.Set(this.m_position.x+this.m_radius*a,this.m_position.y+this.m_radius*b)},a.prototype.m_localPosition=new e,a.prototype.m_radius=null,a}();var G;b.b2MassData=G=G=function(){function a(){this.center=new e(0,0)}return a.prototype.mass=0,a.prototype.center=new e(0,0),a.prototype.I=0,a}();var H,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2PolyDef=H=H=function(){function a(){var a,b;this.type=z.e_unknownShape,this.userData=null,this.localPosition=new e(0,0),this.localRotation=0,this.friction=.2,this.restitution=0,this.density=0,this.categoryBits=1,this.maskBits=65535,this.groupIndex=0,this.vertices=new Array(c.b2_maxPolyVertices),this.type=z.e_polyShape,this.vertexCount=0;for(a=0,b=c.b2_maxPolyVertices;0<=b?a<b:a>b;0<=b?a++:a--)this.vertices[a]=new e}return D(a,A),a.prototype.vertices=new Array(c.b2_maxPolyVertices),a.prototype.vertexCount=0,a}();var I,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2PolyShape=I=I=function(){function a(b,d,g){var i,j,l,m,n,o,p,q,r,s,t,u,w,x,y,A,B,C,D,E,F,G,H,I,J,K,L,M,N;this.m_R=new f,this.m_position=new e,this.m_userData=b.userData,this.m_friction=b.friction,this.m_restitution=b.restitution,this.m_body=d,this.m_proxyId=k.b2_nullProxy,this.m_maxRadius=0,this.m_categoryBits=b.categoryBits,this.m_maskBits=b.maskBits,this.m_groupIndex=b.groupIndex,this.syncAABB=new h,this.syncMat=new f,this.m_localCentroid=new e,this.m_localOBB=new v,i=new h,this.m_vertices=new Array(c.b2_maxPolyVertices),this.m_coreVertices=new Array(c.b2_maxPolyVertices),this.m_normals=new Array(c.b2_maxPolyVertices),this.m_type=z.e_polyShape,x=new f(b.localRotation);if(b.type===z.e_boxShape)this.m_localCentroid.x=b.localPosition.x-g.x,this.m_localCentroid.y=b.localPosition.y-g.y,j=b,this.m_vertexCount=4,o=j.extents.x,p=j.extents.y,q=Math.max(0,o-2*c.b2_linearSlop),r=Math.max(0,p-2*c.b2_linearSlop),G=this.m_vertices[0]=new e,G.x=x.col1.x*o+x.col2.x*p,G.y=x.col1.y*o+x.col2.y*p,G=this.m_vertices[1]=new e,G.x=x.col1.x*-o+x.col2.x*p,G.y=x.col1.y*-o+x.col2.y*p,G=this.m_vertices[2]=new e,G.x=x.col1.x*-o+x.col2.x*-p,G.y=x.col1.y*-o+x.col2.y*-p,G=this.m_vertices[3]=new e,G.x=x.col1.x*o+x.col2.x*-p,G.y=x.col1.y*o+x.col2.y*-p,G=this.m_coreVertices[0]=new e,G.x=x.col1.x*q+x.col2.x*r,G.y=x.col1.y*q+x.col2.y*r,G=this.m_coreVertices[1]=new e,G.x=x.col1.x*-q+x.col2.x*r,G.y=x.col1.y*-q+x.col2.y*r,G=this.m_coreVertices[2]=new e,G.x=x.col1.x*-q+x.col2.x*-r,G.y=x.col1.y*-q+x.col2.y*-r,G=this.m_coreVertices[3]=new e,G.x=x.col1.x*q+x.col2.x*-r,G.y=x.col1.y*q+x.col2.y*-r;else{D=b,this.m_vertexCount=D.vertexCount,z.PolyCentroid(D.vertices,D.vertexCount,a.tempVec),m=a.tempVec.x,n=a.tempVec.y,this.m_localCentroid.x=b.localPosition.x+(x.col1.x*m+x.col2.x*n)-g.x,this.m_localCentroid.y=b.localPosition.y+(x.col1.y*m+x.col2.y*n)-g.y;for(s=0,K=this.m_vertexCount;0<=K?s<K:s>K;0<=K?s++:s--)this.m_vertices[s]=new e,this.m_coreVertices[s]=new e,o=D.vertices[s].x-m,p=D.vertices[s].y-n,this.m_vertices[s].x=x.col1.x*o+x.col2.x*p,this.m_vertices[s].y=x.col1.y*o+x.col2.y*p,H=this.m_vertices[s].x,I=this.m_vertices[s].y,w=Math.sqrt(H*H+I*I),w>Number.MIN_VALUE&&(H*=1/w,I*=1/w),this.m_coreVertices[s].x=this.m_vertices[s].x-2*c.b2_linearSlop*H,this.m_coreVertices[s].y=this.m_vertices[s].y-2*c.b2_linearSlop*I}B=Number.MAX_VALUE,C=Number.MAX_VALUE,y=-Number.MAX_VALUE,A=-Number.MAX_VALUE,this.m_maxRadius=0;for(s=0,L=this.m_vertexCount;0<=L?s<L:s>L;0<=L?s++:s--)J=this.m_vertices[s],B=Math.min(B,J.x),C=Math.min(C,J.y),y=Math.max(y,J.x),A=Math.max(A,J.y),this.m_maxRadius=Math.max(this.m_maxRadius,J.Length());this.m_localOBB.R.SetIdentity(),this.m_localOBB.center.Set((B+y)*.5,(C+A)*.5),this.m_localOBB.extents.Set((y-B)*.5,(A-C)*.5),t=0,u=0;for(s=0,M=this.m_vertexCount;0<=M?s<M:s>M;0<=M?s++:s--)this.m_normals[s]=new e,t=s,u=s+1<this.m_vertexCount?s+1:0,this.m_normals[s].x=this.m_vertices[u].y-this.m_vertices[t].y,this.m_normals[s].y=-(this.m_vertices[u].x-this.m_vertices[t].x),this.m_normals[s].Normalize();for(s=0,N=this.m_vertexCount;0<=N?s<N:s>N;0<=N?s++:s--)t=s,u=s+1<this.m_vertexCount?s+1:0;this.m_R.SetM(this.m_body.m_R),this.m_position.x=this.m_body.m_position.x+(this.m_R.col1.x*this.m_localCentroid.x+this.m_R.col2.x*this.m_localCentroid.y),this.m_position.y=this.m_body.m_position.y+(this.m_R.col1.y*this.m_localCentroid.x+this.m_R.col2.y*this.m_localCentroid.y),a.tAbsR.col1.x=this.m_R.col1.x*this.m_localOBB.R.col1.x+this.m_R.col2.x*this.m_localOBB.R.col1.y,a.tAbsR.col1.y=this.m_R.col1.y*this.m_localOBB.R.col1.x+this.m_R.col2.y*this.m_localOBB.R.col1.y,a.tAbsR.col2.x=this.m_R.col1.x*this.m_localOBB.R.col2.x+this.m_R.col2.x*this.m_localOBB.R.col2.y,a.tAbsR.col2.y=this.m_R.col1.y*this.m_localOBB.R.col2.x+this.m_R.col2.y*this.m_localOBB.R.col2.y,a.tAbsR.Abs(),o=a.tAbsR.col1.x*this.m_localOBB.extents.x+a.tAbsR.col2.x*this.m_localOBB.extents.y,p=a.tAbsR.col1.y*this.m_localOBB.extents.x+a.tAbsR.col2.y*this.m_localOBB.extents.y,E=this.m_position.x+(this.m_R.col1.x*this.m_localOBB.center.x+this.m_R.col2.x*this.m_localOBB.center.y),F=this.m_position.y+(this.m_R.col1.y*this.m_localOBB.center.x+this.m_R.col2.y*this.m_localOBB.center.y),i.minVertex.x=E-o,i.minVertex.y=F-p,i.maxVertex.x=E+o,i.maxVertex.y=F+p,l=this.m_body.m_world.m_broadPhase,l.InRange(i)?this.m_proxyId=l.CreateProxy(i,this):this.m_proxyId=k.b2_nullProxy,this.m_proxyId===k.b2_nullProxy&&this.m_body.Freeze()}return D(a,z),a.prototype.syncAABB=new h,a.prototype.syncMat=new f,a.prototype.Synchronize=function(a,b,c,d){var e,f,g,h,i,j,l,m,n;this.m_R.SetM(d),this.m_position.x=this.m_body.m_position.x+(d.col1.x*this.m_localCentroid.x+d.col2.x*this.m_localCentroid.y),this.m_position.y=this.m_body.m_position.y+(d.col1.y*this.m_localCentroid.x+d.col2.y*this.m_localCentroid.y);if(this.m_proxyId===k.b2_nullProxy)return;return j=b.col1,l=b.col2,m=this.m_localOBB.R.col1,n=this.m_localOBB.R.col2,this.syncMat.col1.x=j.x*m.x+l.x*m.y,this.syncMat.col1.y=j.y*m.x+l.y*m.y,this.syncMat.col2.x=j.x*n.x+l.x*n.y,this.syncMat.col2.y=j.y*n.x+l.y*n.y,this.syncMat.Abs(),h=this.m_localCentroid.x+this.m_localOBB.center.x,i=this.m_localCentroid.y+this.m_localOBB.center.y,f=a.x+(b.col1.x*h+b.col2.x*i),g=a.y+(b.col1.y*h+b.col2.y*i),h=this.syncMat.col1.x*this.m_localOBB.extents.x+this.syncMat.col2.x*this.m_localOBB.extents.y,i=this.syncMat.col1.y*this.m_localOBB.extents.x+this.syncMat.col2.y*this.m_localOBB.extents.y,this.syncAABB.minVertex.x=f-h,this.syncAABB.minVertex.y=g-i,this.syncAABB.maxVertex.x=f+h,this.syncAABB.maxVertex.y=g+i,j=d.col1,l=d.col2,m=this.m_localOBB.R.col1,n=this.m_localOBB.R.col2,this.syncMat.col1.x=j.x*m.x+l.x*m.y,this.syncMat.col1.y=j.y*m.x+l.y*m.y,this.syncMat.col2.x=j.x*n.x+l.x*n.y,this.syncMat.col2.y=j.y*n.x+l.y*n.y,this.syncMat.Abs(),h=this.m_localCentroid.x+this.m_localOBB.center.x,i=this.m_localCentroid.y+this.m_localOBB.center.y,f=c.x+(d.col1.x*h+d.col2.x*i),g=c.y+(d.col1.y*h+d.col2.y*i),h=this.syncMat.col1.x*this.m_localOBB.extents.x+this.syncMat.col2.x*this.m_localOBB.extents.y,i=this.syncMat.col1.y*this.m_localOBB.extents.x+this.syncMat.col2.y*this.m_localOBB.extents.y,this.syncAABB.minVertex.x=Math.min(this.syncAABB.minVertex.x,f-h),this.syncAABB.minVertex.y=Math.min(this.syncAABB.minVertex.y,g-i),this.syncAABB.maxVertex.x=Math.max(this.syncAABB.maxVertex.x,f+h),this.syncAABB.maxVertex.y=Math.max(this.syncAABB.maxVertex.y,g+i),e=this.m_body.m_world.m_broadPhase,e.InRange(this.syncAABB)?e.MoveProxy(this.m_proxyId,this.syncAABB):this.m_body.Freeze()},a.prototype.QuickSync=function(a,b){return this.m_R.SetM(b),this.m_position.x=a.x+(b.col1.x*this.m_localCentroid.x+b.col2.x*this.m_localCentroid.y),this.m_position.y=a.y+(b.col1.y*this.m_localCentroid.x+b.col2.y*this.m_localCentroid.y)},a.prototype.ResetProxy=function(a){var b,c,d,e,f,i;if(this.m_proxyId===k.b2_nullProxy)return;i=a.GetProxy(this.m_proxyId),a.DestroyProxy(this.m_proxyId),i=null,b=g.b2MulMM(this.m_R,this.m_localOBB.R),d=g.b2AbsM(b),e=g.b2MulMV(d,this.m_localOBB.extents),f=g.b2MulMV(this.m_R,this.m_localOBB.center),f.Add(this.m_position),c=new h,c.minVertex.SetV(f),c.minVertex.Subtract(e),c.maxVertex.SetV(f),c.maxVertex.Add(e),a.InRange(c)?this.m_proxyId=a.CreateProxy(c,this):this.m_proxyId=k.b2_nullProxy;if(this.m_proxyId===k.b2_nullProxy)return this.m_body.Freeze()},a.prototype.Support=function(a,b,c){var d,e,f,g,h,i,j;f=a*this.m_R.col1.x+b*this.m_R.col1.y,g=a*this.m_R.col2.x+b*this.m_R.col2.y,d=0,e=this.m_coreVertices[0].x*f+this.m_coreVertices[0].y*g;for(h=0,j=this.m_vertexCount;0<=j?h<j:h>j;0<=j?h++:h--)i=this.m_coreVertices[h].x*f+this.m_coreVertices[h].y*g,i>e&&(d=h,e=i);return c.Set(this.m_position.x+(this.m_R.col1.x*this.m_coreVertices[d].x+this.m_R.col2.x*this.m_coreVertices[d].y),this.m_position.y+(this.m_R.col1.y*this.m_coreVertices[d].x+this.m_R.col2.y*this.m_coreVertices[d].y))},a.prototype.m_localCentroid=new e,a.prototype.m_localOBB=new v,a.prototype.m_vertices=null,a.prototype.m_coreVertices=null,a.prototype.m_vertexCount=0,a.prototype.m_normals=null,a}(),I.tempVec=new e,I.tAbsR=new f;var J;b.b2Body=J=J=function(){function a(b,d){var h,i,j,k,l,m,n,o,p,q;this.sMat0=new f,this.m_position=new e,this.m_R=new f(0),this.m_position0=new e,this.m_flags=0,this.m_position.SetV(b.position),this.m_rotation=b.rotation,this.m_R.Set(this.m_rotation),this.m_position0.SetV(this.m_position),this.m_rotation0=this.m_rotation,this.m_world=d,this.m_linearDamping=g.b2Clamp(1-b.linearDamping,0,1),this.m_angularDamping=g.b2Clamp(1-b.angularDamping,0,1),this.m_force=new e(0,0),this.m_torque=0,this.m_mass=0,j=new Array(c.b2_maxShapesPerBody);for(h=0,n=c.b2_maxShapesPerBody;0<=n?h<n:h>n;0<=n?h++:h--)j[h]=new G;this.m_shapeCount=0,this.m_center=new e(0,0);for(h=0,o=c.b2_maxShapesPerBody;0<=o?h<o:h>o;0<=o?h++:h--){l=b.shapes[h];if(l===null)break;i=j[h],l.ComputeMass(i),this.m_mass+=i.mass,this.m_center.x+=i.mass*(l.localPosition.x+i.center.x),this.m_center.y+=i.mass*(l.localPosition.y+i.center.y),++this.m_shapeCount}this.m_mass>0?(this.m_center.Multiply(1/this.m_mass),this.m_position.Add(g.b2MulMV(this.m_R,this.m_center))):this.m_flags|=a.e_staticFlag,this.m_I=0;for(h=0,p=this.m_shapeCount;0<=p?h<p:h>p;0<=p?h++:h--)l=b.shapes[h],i=j[h],this.m_I+=i.I,k=g.SubtractVV(g.AddVV(l.localPosition,i.center),this.m_center),this.m_I+=i.mass*g.b2Dot(k,k);this.m_mass>0?this.m_invMass=1/this.m_mass:this.m_invMass=0,this.m_I>0&&b.preventRotation===!1?this.m_invI=1/this.m_I:(this.m_I=0,this.m_invI=0),this.m_linearVelocity=g.AddVV(b.linearVelocity,g.b2CrossFV(b.angularVelocity,this.m_center)),this.m_angularVelocity=b.angularVelocity,this.m_jointList=null,this.m_contactList=null,this.m_prev=null,this.m_next=null,this.m_shapeList=null;for(h=0,q=this.m_shapeCount;0<=q?h<q:h>q;0<=q?h++:h--)l=b.shapes[h],m=z.Create(l,this,this.m_center),m.m_next=this.m_shapeList,this.m_shapeList=m;this.m_sleepTime=0,b.allowSleep&&(this.m_flags|=a.e_allowSleepFlag),b.isSleeping&&(this.m_flags|=a.e_sleepFlag);if(this.m_flags&a.e_sleepFlag||this.m_invMass===0)this.m_linearVelocity.Set(0,0),this.m_angularVelocity=0;this.m_userData=b.userData}return a.prototype.SetOriginPosition=function(a,b){var c;if(this.IsFrozen())return;this.m_rotation=b,this.m_R.Set(this.m_rotation),this.m_position=g.AddVV(a,g.b2MulMV(this.m_R,this.m_center)),this.m_position0.SetV(this.m_position),this.m_rotation0=this.m_rotation,c=this.m_shapeList;while(c!=null)c.Synchronize(this.m_position,this.m_R,this.m_position,this.m_R),c=c.m_next;return this.m_world.m_broadPhase.Commit()},a.prototype.GetOriginPosition=function(){return g.SubtractVV(this.m_position,g.b2MulMV(this.m_R,this.m_center))},a.prototype.SetCenterPosition=function(a,b){var c;if(this.IsFrozen())return;this.m_rotation=b,this.m_R.Set(this.m_rotation),this.m_position.SetV(a),this.m_position0.SetV(this.m_position),this.m_rotation0=this.m_rotation,c=this.m_shapeList;while(c!=null)c.Synchronize(this.m_position,this.m_R,this.m_position,this.m_R),c=c.m_next;return this.m_world.m_broadPhase.Commit()},a.prototype.GetCenterPosition=function(){return this.m_position},a.prototype.GetRotation=function(){return this.m_rotation},a.prototype.GetRotationMatrix=function(){return this.m_R},a.prototype.SetLinearVelocity=function(a){return this.m_linearVelocity.SetV(a)},a.prototype.GetLinearVelocity=function(){return this.m_linearVelocity},a.prototype.SetAngularVelocity=function(a){return this.m_angularVelocity=a},a.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},a.prototype.ApplyForce=function(a,b){if(this.IsSleeping()===!1)return this.m_force.Add(a),this.m_torque+=g.b2CrossVV(g.SubtractVV(b,this.m_position),a)},a.prototype.ApplyTorque=function(a){if(this.IsSleeping()===!1)return this.m_torque+=a},a.prototype.ApplyImpulse=function(a,b){if(this.IsSleeping()===!1)return this.m_linearVelocity.Add(g.MulFV(this.m_invMass,a)),this.m_angularVelocity+=this.m_invI*g.b2CrossVV(g.SubtractVV(b,this.m_position),a)},a.prototype.GetMass=function(){return this.m_mass},a.prototype.GetInertia=function(){return this.m_I},a.prototype.GetWorldPoint=function(a){return g.AddVV(this.m_position,g.b2MulMV(this.m_R,a))},a.prototype.GetWorldVector=function(a){return g.b2MulMV(this.m_R,a)},a.prototype.GetLocalPoint=function(a){return g.b2MulTMV(this.m_R,g.SubtractVV(a,this.m_position))},a.prototype.GetLocalVector=function(a){return g.b2MulTMV(this.m_R,a)},a.prototype.IsStatic=function(){return(this.m_flags&a.e_staticFlag)===a.e_staticFlag},a.prototype.IsFrozen=function(){return(this.m_flags&a.e_frozenFlag)===a.e_frozenFlag},a.prototype.IsSleeping=function(){return(this.m_flags&a.e_sleepFlag)===a.e_sleepFlag},a.prototype.AllowSleeping=function(b){return b?this.m_flags|=a.e_allowSleepFlag:(this.m_flags&=~a.e_allowSleepFlag,this.WakeUp())},a.prototype.WakeUp=function(){return this.m_flags&=~a.e_sleepFlag,this.m_sleepTime=0},a.prototype.GetContactList=function(){return this.m_contactList},a.prototype.GetJointList=function(){return this.m_jointList},a.prototype.GetNext=function(){return this.m_next},a.prototype.GetUserData=function(){return this.m_userData},a.prototype.GetShapeList=function(){return this.m_shapeList},a.prototype.Destroy=function(){var a,b,c;a=this.m_shapeList,c=[];while(a)b=a,a=a.m_next,c.push(z.Destroy(b));return c},a.prototype.sMat0=new f,a.prototype.SynchronizeShapes=function(){var a,b;this.sMat0.Set(this.m_rotation0),a=this.m_shapeList,b=[];while(a!=null)a.Synchronize(this.m_position0,this.sMat0,this.m_position,this.m_R),b.push(a=a.m_next);return b},a.prototype.QuickSyncShapes=function(){var a,b;a=this.m_shapeList,b=[];while(a!=null)a.QuickSync(this.m_position,this.m_R),b.push(a=a.m_next);return b},a.prototype.IsConnected=function(a){var b;b=this.m_jointList;while(b!=null){if(b.other===a)return b.joint.m_collideConnected===!1;b=b.next}return!1},a.prototype.Freeze=function(){var b,c;this.m_flags|=a.e_frozenFlag,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,b=this.m_shapeList,c=[];while(b!=null)b.DestroyProxy(),c.push(b=b.m_next);return c},a.prototype.m_flags=0,a.prototype.m_position=new e,a.prototype.m_rotation=null,a.prototype.m_R=new f(0),a.prototype.m_position0=new e,a.prototype.m_rotation0=null,a.prototype.m_linearVelocity=null,a.prototype.m_angularVelocity=null,a.prototype.m_force=null,a.prototype.m_torque=null,a.prototype.m_center=null,a.prototype.m_world=null,a.prototype.m_prev=null,a.prototype.m_next=null,a.prototype.m_shapeList=null,a.prototype.m_shapeCount=0,a.prototype.m_jointList=null,a.prototype.m_contactList=null,a.prototype.m_mass=null,a.prototype.m_invMass=null,a.prototype.m_I=null,a.prototype.m_invI=null,a.prototype.m_linearDamping=null,a.prototype.m_angularDamping=null,a.prototype.m_sleepTime=null,a.prototype.m_userData=null,a}(),J.e_staticFlag=1,J.e_frozenFlag=2,J.e_islandFlag=4,J.e_sleepFlag=8,J.e_allowSleepFlag=16,J.e_destroyFlag=32;var K;b.b2BodyDef=K=K=function(){function a(){var a,b;this.shapes=[],this.userData=null;for(a=0,b=c.b2_maxShapesPerBody;0<=b?a<=b:a>=b;0<=b?a++:a--)this.shapes[a]=null;this.position=new e(0,0),this.rotation=0,this.linearVelocity=new e(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.isSleeping=!1,this.preventRotation=!1}return a.prototype.userData=null,a.prototype.shapes=[],a.prototype.position=null,a.prototype.rotation=null,a.prototype.linearVelocity=null,a.prototype.angularVelocity=null,a.prototype.linearDamping=null,a.prototype.angularDamping=null,a.prototype.allowSleep=null,a.prototype.isSleeping=null,a.prototype.preventRotation=null,a.prototype.AddShape=function(a){var b,d,e;e=[];for(b=0,d=c.b2_maxShapesPerBody;0<=d?b<=d:b>=d;0<=d?b++:b--)if(this.shapes[b]==null){this.shapes[b]=a;break}return e},a}();var L;b.b2CollisionFilter=L=L=function(){function a(){}return a.prototype.ShouldCollide=function(a,b){return a.m_groupIndex===b.m_groupIndex&&a.m_groupIndex!==0?a.m_groupIndex>0:(a.m_maskBits&b.m_categoryBits)!==0&&(a.m_categoryBits&b.m_maskBits)!==0},a}(),L.b2_defaultFilter=new L;var M;b.b2Island=M=M=function(){function a(a,b,c,d){var e;this.m_bodyCapacity=a,this.m_contactCapacity=b,this.m_jointCapacity=c,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_bodies=new Array(a);for(e=0;0<=a?e<a:e>a;0<=a?e++:e--)this.m_bodies[e]=null;this.m_contacts=new Array(b);for(e=0;0<=b?e<b:e>b;0<=b?e++:e--)this.m_contacts[e]=null;this.m_joints=new Array(c);for(e=0;0<=c?e<c:e>c;0<=c?e++:e--)this.m_joints[e]=null;this.m_allocator=d}return a.prototype.Clear=function(){return this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},a.prototype.Solve=function(b,d){var e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u;for(i=0,m=this.m_bodyCount;0<=m?i<m:i>m;0<=m?i++:i--){e=this.m_bodies[i];if(e.m_invMass===0)continue;e.m_linearVelocity.Add(g.MulFV(b.dt,g.AddVV(d,g.MulFV(e.m_invMass,e.m_force)))),e.m_angularVelocity+=b.dt*e.m_invI*e.m_torque,e.m_linearVelocity.Multiply(e.m_linearDamping),e.m_angularVelocity*=e.m_angularDamping,e.m_position0.SetV(e.m_position),e.m_rotation0=e.m_rotation}f=new T(this.m_contacts,this.m_contactCount,this.m_allocator),f.PreSolve();for(i=0,n=this.m_jointCount;0<=n?i<n:i>n;0<=n?i++:i--)this.m_joints[i].PrepareVelocitySolver();for(i=0,o=b.iterations;0<=o?i<o:i>o;0<=o?i++:i--){f.SolveVelocityConstraints();for(j=0,p=this.m_jointCount;0<=p?j<p:j>p;0<=p?j++:j--)this.m_joints[j].SolveVelocityConstraints(b)}for(i=0,q=this.m_bodyCount;0<=q?i<q:i>q;0<=q?i++:i--){e=this.m_bodies[i];if(e.m_invMass===0)continue;e.m_position.x+=b.dt*e.m_linearVelocity.x,e.m_position.y+=b.dt*e.m_linearVelocity.y,e.m_rotation+=b.dt*e.m_angularVelocity,e.m_R.Set(e.m_rotation)}for(i=0,r=this.m_jointCount;0<=r?i<r:i>r;0<=r?i++:i--)this.m_joints[i].PreparePositionSolver();if($.s_enablePositionCorrection){a.m_positionIterationCount=0;while(a.m_positionIterationCount<b.iterations){h=f.SolvePositionConstraints(c.b2_contactBaumgarte),l=!0;for(i=0,s=this.m_jointCount;0<=s?i<s:i>s;0<=s?i++:i--)k=this.m_joints[i].SolvePositionConstraints(),l=l&&k;if(h&&l)break;++a.m_positionIterationCount}}f.PostSolve(),u=[];for(i=0,t=this.m_bodyCount;0<=t?i<t:i>t;0<=t?i++:i--){e=this.m_bodies[i];if(e.m_invMass===0)continue;e.m_R.Set(e.m_rotation),e.SynchronizeShapes(),e.m_force.Set(0,0),u.push(e.m_torque=0)}return u},a.prototype.UpdateSleep=function(a){var b,d,e,f,h,i,j,k;h=Number.MAX_VALUE,f=c.b2_linearSleepTolerance*c.b2_linearSleepTolerance,b=c.b2_angularSleepTolerance*c.b2_angularSleepTolerance;for(e=0,i=this.m_bodyCount;0<=i?e<i:e>i;0<=i?e++:e--){d=this.m_bodies[e];if(d.m_invMass===0)continue;(d.m_flags&J.e_allowSleepFlag)===0&&(d.m_sleepTime=0,h=0),(d.m_flags&J.e_allowSleepFlag)===0||d.m_angularVelocity*d.m_angularVelocity>b||g.b2Dot(d.m_linearVelocity,d.m_linearVelocity)>f?(d.m_sleepTime=0,h=0):(d.m_sleepTime+=a,h=g.b2Min(h,d.m_sleepTime))}if(h>=c.b2_timeToSleep){k=[];for(e=0,j=this.m_bodyCount;0<=j?e<j:e>j;0<=j?e++:e--)d=this.m_bodies[e],k.push(d.m_flags|=J.e_sleepFlag);return k}},a.prototype.AddBody=function(a){return this.m_bodies[this.m_bodyCount++]=a},a.prototype.AddContact=function(a){return this.m_contacts[this.m_contactCount++]=a},a.prototype.AddJoint=function(a){return this.m_joints[this.m_jointCount++]=a},a.prototype.m_allocator=null,a.prototype.m_bodies=null,a.prototype.m_contacts=null,a.prototype.m_joints=null,a.prototype.m_bodyCount=0,a.prototype.m_jointCount=0,a.prototype.m_contactCount=0,a.prototype.m_bodyCapacity=0,a.prototype.m_contactCapacity=0,a.prototype.m_jointCapacity=0,a.prototype.m_positionError=null,a}(),M.m_positionIterationCount=0;var N;b.b2TimeStep=N=N=function(){function a(){}return a.prototype.dt=null,a.prototype.inv_dt=null,a.prototype.iterations=0,a}();var O;b.b2ContactNode=O=O=function(){function a(){}return a.prototype.other=null,a.prototype.contact=null,a.prototype.prev=null,a.prototype.next=null,a}();var P;b.b2Contact=P=P=function(){function a(a,b){this.m_node1=new O,this.m_node2=new O,this.m_flags=0;if(!a||!b){this.m_shape1=null,this.m_shape2=null;return}this.m_shape1=a,this.m_shape2=b,this.m_manifoldCount=0,this.m_friction=Math.sqrt(this.m_shape1.m_friction*this.m_shape2.m_friction),this.m_restitution=g.b2Max(this.m_shape1.m_restitution,this.m_shape2.m_restitution),this.m_prev=null,this.m_next=null,this.m_node1.contact=null,this.m_node1.prev=null,this.m_node1.next=null,this.m_node1.other=null,this.m_node2.contact=null,this.m_node2.prev=null,this.m_node2.next=null,this.m_node2.other=null}return a.prototype.GetManifolds=function(){return null},a.prototype.GetManifoldCount=function(){return this.m_manifoldCount},a.prototype.GetNext=function(){return this.m_next},a.prototype.GetShape1=function(){return this.m_shape1},a.prototype.GetShape2=function(){return this.m_shape2},a.prototype.Evaluate=function(){},a.prototype.m_flags=0,a.prototype.m_prev=null,a.prototype.m_next=null,a.prototype.m_node1=new O,a.prototype.m_node2=new O,a.prototype.m_shape1=null,a.prototype.m_shape2=null,a.prototype.m_manifoldCount=0,a.prototype.m_friction=null,a.prototype.m_restitution=null,a}(),P.e_islandFlag=1,P.e_destroyFlag=2,P.AddType=function(a,b,c,d){P.s_registers[c][d].createFcn=a,P.s_registers[c][d].destroyFcn=b,P.s_registers[c][d].primary=!0;if(c!==d)return P.s_registers[d][c].createFcn=a,P.s_registers[d][c].destroyFcn=b,P.s_registers[d][c].primary=!1},P.InitializeRegisters=function(){var a,b,c,d;P.s_registers=new Array(z.e_shapeTypeCount);for(a=0,c=z.e_shapeTypeCount;0<=c?a<c:a>c;0<=c?a++:a--){P.s_registers[a]=new Array(z.e_shapeTypeCount);for(b=0,d=z.e_shapeTypeCount;0<=d?b<d:b>d;0<=d?b++:b--)P.s_registers[a][b]=new S}return P.AddType(U.Create,U.Destroy,z.e_circleShape,z.e_circleShape),P.AddType(X.Create,X.Destroy,z.e_polyShape,z.e_circleShape),P.AddType(Y.Create,Y.Destroy,z.e_polyShape,z.e_polyShape)},P.Create=function(a,b,c){var d,e,f,g,h,i,j;P.s_initialized===!1&&(P.InitializeRegisters(),P.s_initialized=!0),h=a.m_type,i=b.m_type,e=P.s_registers[h][i].createFcn;if(e){if(P.s_registers[h][i].primary)return e(a,b,c);d=e(b,a,c);for(f=0,j=d.GetManifoldCount();0<=j?f<j:f>j;0<=j?f++:f--)g=d.GetManifolds()[f],g.normal=g.normal.Negative();return d}return null},P.Destroy=function(a,b){var c,d,e;return a.GetManifoldCount()>0&&(a.m_shape1.m_body.WakeUp(),a.m_shape2.m_body.WakeUp()),d=a.m_shape1.m_type,e=a.m_shape2.m_type,c=P.s_registers[d][e].destroyFcn,c(a,b)},P.s_registers=null,P.s_initialized=!1;var Q;b.b2ContactConstraint=Q=Q=function(){function a(){var a,b;this.normal=new e,this.points=new Array(c.b2_maxManifoldPoints);for(a=0,b=c.b2_maxManifoldPoints;0<=b?a<b:a>b;0<=b?a++:a--)this.points[a]=new R}return a.prototype.points=null,a.prototype.normal=new e,a.prototype.manifold=null,a.prototype.body1=null,a.prototype.body2=null,a.prototype.friction=null,a.prototype.restitution=null,a.prototype.pointCount=0,a}();var R;b.b2ContactConstraintPoint=R=R=function(){function a(){this.localAnchor1=new e,this.localAnchor2=new e}return a.prototype.localAnchor1=new e,a.prototype.localAnchor2=new e,a.prototype.normalImpulse=null,a.prototype.tangentImpulse=null,a.prototype.positionImpulse=null,a.prototype.normalMass=null,a.prototype.tangentMass=null,a.prototype.separation=null,a.prototype.velocityBias=null,a}();var S;b.b2ContactRegister=S=S=function(){function a(){({createFcn:null,destroyFcn:null,primary:null})}return a}();var T;b.b2ContactSolver=T=T=function(){function a(a,b,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,R,S,T,U,V,W;this.m_constraints=new Array,this.m_allocator=d,this.m_constraintCount=0;for(m=0;0<=b?m<b:m>b;0<=b?m++:m--)this.m_constraintCount+=a[m].GetManifoldCount();for(m=0,V=this.m_constraintCount;0<=V?m<V:m>V;0<=V?m++:m--)this.m_constraints[m]=new Q;j=0;for(m=0;0<=b?m<b:m>b;0<=b?m++:m--){i=a[m],e=i.m_shape1.m_body,f=i.m_shape2.m_body,s=i.GetManifoldCount(),t=i.GetManifolds(),l=i.m_friction,C=i.m_restitution,N=e.m_linearVelocity.x,O=e.m_linearVelocity.y,P=f.m_linearVelocity.x,R=f.m_linearVelocity.y,T=e.m_angularVelocity,U=f.m_angularVelocity;for(n=0;0<=s?n<s:n>s;0<=s?n++:n--){r=t[n],u=r.normal.x,v=r.normal.y,g=this.m_constraints[j],g.body1=e,g.body2=f,g.manifold=r,g.normal.x=u,g.normal.y=v,g.pointCount=r.pointCount,g.friction=l,g.restitution=C;for(o=0,W=g.pointCount;0<=W?o<W:o>W;0<=W?o++:o--)k=r.points[o],h=g.points[o],h.normalImpulse=k.normalImpulse,h.tangentImpulse=k.tangentImpulse,h.separation=k.separation,x=k.position.x-e.m_position.x,y=k.position.y-e.m_position.y,A=k.position.x-f.m_position.x,B=k.position.y-f.m_position.y,I=h.localAnchor1,H=e.m_R,I.x=x*H.col1.x+y*H.col1.y,I.y=x*H.col2.x+y*H.col2.y,I=h.localAnchor2,H=f.m_R,I.x=A*H.col1.x+B*H.col1.y,I.y=A*H.col2.x+B*H.col2.y,w=x*x+y*y,z=A*A+B*B,D=x*u+y*v,E=A*u+B*v,p=e.m_invMass+f.m_invMass,p+=e.m_invI*(w-D*D)+f.m_invI*(z-E*E),h.normalMass=1/p,L=v,M=-u,F=x*L+y*M,G=A*L+B*M,q=e.m_invMass+f.m_invMass,q+=e.m_invI*(w-F*F)+f.m_invI*(z-G*G),h.tangentMass=1/q,h.velocityBias=0,h.separation>0&&(h.velocityBias=-60*h.separation),J=P+ -U*B-N- -T*y,K=R+U*A-O-T*x,S=g.normal.x*J+g.normal.y*K,S<-c.b2_velocityThreshold&&(h.velocityBias+=-g.restitution*S);++j}}}return a.prototype.m_allocator=null,a.prototype.m_constraints=new Array,a.prototype.m_constraintCount=0,a.prototype.PreSolve=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;z=[];for(h=0,y=this.m_constraintCount;0<=y?h<y:h>y;0<=y?h++:h--)e=this.m_constraints[h],c=e.body1,d=e.body2,k=c.m_invMass,i=c.m_invI,l=d.m_invMass,j=d.m_invI,n=e.normal.x,o=e.normal.y,w=o,x=-n,m=0,t=0,z.push(function(){var h,y;if($.s_enableWarmStarting){t=e.pointCount,h=[];for(m=0;0<=t?m<t:m>t;0<=t?m++:m--)f=e.points[m],a=f.normalImpulse*n+f.tangentImpulse*w,b=f.normalImpulse*o+f.tangentImpulse*x,u=c.m_R,v=f.localAnchor1,p=u.col1.x*v.x+u.col2.x*v.y,q=u.col1.y*v.x+u.col2.y*v.y,u=d.m_R,v=f.localAnchor2,r=u.col1.x*v.x+u.col2.x*v.y,s=u.col1.y*v.x+u.col2.y*v.y,c.m_angularVelocity-=i*(p*b-q*a),c.m_linearVelocity.x-=k*a,c.m_linearVelocity.y-=k*b,d.m_angularVelocity+=j*(r*b-s*a),d.m_linearVelocity.x+=l*a,d.m_linearVelocity.y+=l*b,h.push(f.positionImpulse=0);return h}t=e.pointCount,y=[];for(m=0;0<=t?m<t:m>t;0<=t?m++:m--)g=e.points[m],g.normalImpulse=0,g.tangentImpulse=0,y.push(g.positionImpulse=0);return y}());return z},a.prototype.SolveVelocityConstraints=function(){var a,b,c,d,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K;K=[];for(n=0,J=this.m_constraintCount;0<=J?n<J:n>J;0<=J?n++:n--){j=this.m_constraints[n],c=j.body1,f=j.body2,d=c.m_angularVelocity,e=c.m_linearVelocity,h=f.m_angularVelocity,i=f.m_linearVelocity,q=c.m_invMass,o=c.m_invI,r=f.m_invMass,p=f.m_invI,w=j.normal.x,x=j.normal.y,F=x,G=-w,C=j.pointCount;for(s=0;0<=C?s<C:s>C;0<=C?s++:s--)k=j.points[s],D=c.m_R,E=k.localAnchor1,y=D.col1.x*E.x+D.col2.x*E.y,z=D.col1.y*E.x+D.col2.y*E.y,D=f.m_R,E=k.localAnchor2,A=D.col1.x*E.x+D.col2.x*E.y,B=D.col1.y*E.x+D.col2.y*E.y,l=i.x+ -h*B-e.x- -d*z,m=i.y+h*A-e.y-d*y,H=l*w+m*x,t=-k.normalMass*(H-k.velocityBias),v=g.b2Max(k.normalImpulse+t,0),t=v-k.normalImpulse,a=t*w,b=t*x,e.x-=q*a,e.y-=q*b,d-=o*(y*b-z*a),i.x+=r*a,i.y+=r*b,h+=p*(A*b-B*a),k.normalImpulse=v,l=i.x+ -h*B-e.x- -d*z,m=i.y+h*A-e.y-d*y,I=l*F+m*G,t=k.tangentMass*-I,u=j.friction*k.normalImpulse,v=g.b2Clamp(k.tangentImpulse+t,-u,u),t=v-k.tangentImpulse,a=t*F,b=t*G,e.x-=q*a,e.y-=q*b,d-=o*(y*b-z*a),i.x+=r*a,i.y+=r*b,h+=p*(A*b-B*a),k.tangentImpulse=v;c.m_angularVelocity=d,K.push(f.m_angularVelocity=h)}return K},a.prototype.SolvePositionConstraints=function(a){var b,d,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P;for(p=0,P=this.m_constraintCount;0<=P?p<P:p>P;0<=P?p++:p--){k=this.m_constraints[p],d=k.body1,h=k.body2,e=d.m_position,f=d.m_rotation,i=h.m_position,j=h.m_rotation,v=d.m_invMass,t=d.m_invI,w=h.m_invMass,u=h.m_invI,z=k.normal.x,A=k.normal.y,N=A,O=-z,K=k.pointCount;for(x=0;0<=K?x<K:x>K;0<=K?x++:x--)l=k.points[x],L=d.m_R,M=l.localAnchor1,F=L.col1.x*M.x+L.col2.x*M.y,G=L.col1.y*M.x+L.col2.y*M.y,L=h.m_R,M=l.localAnchor2,H=L.col1.x*M.x+L.col2.x*M.y,I=L.col1.y*M.x+L.col2.y*M.y,B=e.x+F,C=e.y+G,D=i.x+H,E=i.y+I,n=D-B,o=E-C,J=n*z+o*A+l.separation,y=g.b2Min(y,J),b=a*g.b2Clamp(J+c.b2_linearSlop,-c.b2_maxLinearCorrection,0),m=-l.normalMass*b,q=l.positionImpulse,l.positionImpulse=g.b2Max(q+m,0),m=l.positionImpulse-q,r=m*z,s=m*A,e.x-=v*r,e.y-=v*s,f-=t*(F*s-G*r),d.m_R.Set(f),i.x+=w*r,i.y+=w*s,j+=u*(H*s-I*r),h.m_R.Set(j);d.m_rotation=f,h.m_rotation=j}return y>=-c.b2_linearSlop},a.prototype.PostSolve=function(){var a,b,c,d,e,f,g,h;h=[];for(c=0,g=this.m_constraintCount;0<=g?c<g:c>g;0<=g?c++:c--)a=this.m_constraints[c],e=a.manifold,h.push(function(){var c,g;g=[];for(d=0,c=a.pointCount;0<=c?d<c:d>c;0<=c?d++:d--)f=e.points[d],b=a.points[d],f.normalImpulse=b.normalImpulse,g.push(f.tangentImpulse=b.tangentImpulse);return g}());return h},a}();var U,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2CircleContact=U=U=function(){function a(a,b){this.m_node1=new O,this.m_node2=new O,this.m_flags=0;if(!a||!b){this.m_shape1=null,this.m_shape2=null;return}this.m_shape1=a,this.m_shape2=b,this.m_manifoldCount=0,this.m_friction=Math.sqrt(this.m_shape1.m_friction*this.m_shape2.m_friction),this.m_restitution=g.b2Max(this.m_shape1.m_restitution,this.m_shape2.m_restitution),this.m_prev=null,this.m_next=null,this.m_node1.contact=null,this.m_node1.prev=null,this.m_node1.next=null,this.m_node1.other=null,this.m_node2.contact=null,this.m_node2.prev=null,this.m_node2.next=null,this.m_node2.other=null,this.m_manifold=[new u],this.m_manifold[0].pointCount=0,this.m_manifold[0].points[0].normalImpulse=0,this.m_manifold[0].points[0].tangentImpulse=0}return D(a,P),a.prototype.Evaluate=function(){return p.b2CollideCircle(this.m_manifold[0],this.m_shape1,this.m_shape2,!1),this.m_manifold[0].pointCount>0?this.m_manifoldCount=1:this.m_manifoldCount=0},a.prototype.GetManifolds=function(){return this.m_manifold},a.prototype.m_manifold=[new u],a}(),U.Create=function(a,b,c){return new U(a,b)},U.Destroy=function(a,b){};var V;b.b2Conservative=V=V=function(){function a(){}return a}(),V.R1=new f,V.R2=new f,V.x1=new e,V.x2=new e,V.Conservative=function(a,b){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N;i=a.GetBody(),j=b.GetBody(),K=i.m_position.x-i.m_position0.x,L=i.m_position.y-i.m_position0.y,v=i.m_rotation-i.m_rotation0,M=j.m_position.x-j.m_position0.x,N=j.m_position.y-j.m_position0.y,w=j.m_rotation-j.m_rotation0,F=a.GetMaxRadius(),G=b.GetMaxRadius(),x=i.m_position0.x,y=i.m_position0.y,f=i.m_rotation0,B=j.m_position0.x,C=j.m_position0.y,h=j.m_rotation0,z=x,A=y,e=f,D=B,E=C,g=h,V.R1.Set(e),V.R2.Set(g),a.QuickSync(p1,V.R1),b.QuickSync(p2,V.R2),I=0,u=10,q=0,p=!0;for(r=0;0<=u?r<u:r>u;0<=u?r++:r--){n=t.Distance(V.x1,V.x2,a,b);if(n<c.b2_linearSlop){r===0?p=!1:p=!0;break}if(r===0){l=V.x2.x-V.x1.x,m=V.x2.y-V.x1.y,k=Math.sqrt(l*l+m*m),H=l*(K-M)+m*(L-N)+Math.abs(v)*F+Math.abs(w)*G;if(Math.abs(H)<Number.MIN_VALUE){p=!1;break}q=1/H}o=n*q,J=I+o;if(J<0||1<J){p=!1;break}if(J<(1+100*Number.MIN_VALUE)*I){p=!0;break}I=J,z=x+I*v1.x,A=y+I*v1.y,e=f+I*v,D=B+I*v2.x,E=C+I*v2.y,g=h+I*w,V.R1.Set(e),V.R2.Set(g),a.QuickSync(p1,V.R1),b.QuickSync(p2,V.R2)}return p?(l=V.x2.x-V.x1.x,m=V.x2.y-V.x1.y,s=Math.sqrt(l*l+m*m),d*=b2_linearSlop/lengthif(s>FLT_EPSILON),i.IsStatic()?(i.m_position.x=z,i.m_position.y=A):(i.m_position.x=z-l,i.m_position.y=A-m),i.m_rotation=e,i.m_R.Set(e),i.QuickSyncShapes(),j.IsStatic()?(j.m_position.x=D,j.m_position.y=E):(j.m_position.x=D+l,j.m_position.y=E+m),j.m_position.x=D+l,j.m_position.y=E+m,j.m_rotation=g,j.m_R.Set(g),j.QuickSyncShapes(),!0):(a.QuickSync(i.m_position,i.m_R),b.QuickSync(j.m_position,j.m_R),!1)};var W,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2NullContact=W=W=function(){function a(a,b){this.m_node1=new O,this.m_node2=new O,this.m_flags=0;if(!a||!b){this.m_shape1=null,this.m_shape2=null;return}this.m_shape1=a,this.m_shape2=b,this.m_manifoldCount=0,this.m_friction=Math.sqrt(this.m_shape1.m_friction*this.m_shape2.m_friction),this.m_restitution=g.b2Max(this.m_shape1.m_restitution,this.m_shape2.m_restitution),this.m_prev=null,this.m_next=null,this.m_node1.contact=null,this.m_node1.prev=null,this.m_node1.next=null,this.m_node1.other=null,this.m_node2.contact=null,this.m_node2.prev=null,this.m_node2.next=null,this.m_node2.other=null}return D(a,P),a.prototype.Evaluate=function(){},a.prototype.GetManifolds=function(){return null},a}();var X,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2PolyAndCircleContact=X=X=function(){function a(a,b){this.m_node1=new O,this.m_node2=new O,this.m_flags=0;if(!a||!b){this.m_shape1=null,this.m_shape2=null;return}this.m_shape1=a,this.m_shape2=b,this.m_manifoldCount=0,this.m_friction=Math.sqrt(this.m_shape1.m_friction*this.m_shape2.m_friction),this.m_restitution=g.b2Max(this.m_shape1.m_restitution,this.m_shape2.m_restitution),this.m_prev=null,this.m_next=null,this.m_node1.contact=null,this.m_node1.prev=null,this.m_node1.next=null,this.m_node1.other=null,this.m_node2.contact=null,this.m_node2.prev=null,this.m_node2.next=null,this.m_node2.other=null,this.m_manifold=[new u],c.b2Assert(this.m_shape1.m_type===z.e_polyShape),c.b2Assert(this.m_shape2.m_type===z.e_circleShape),this.m_manifold[0].pointCount=0,this.m_manifold[0].points[0].normalImpulse=0,this.m_manifold[0].points[0].tangentImpulse=0}return D(a,P),a.prototype.Evaluate=function(){return p.b2CollidePolyAndCircle(this.m_manifold[0],this.m_shape1,this.m_shape2,!1),this.m_manifold[0].pointCount>0?this.m_manifoldCount=1:this.m_manifoldCount=0},a.prototype.GetManifolds=function(){return this.m_manifold},a.prototype.m_manifold=[new u],a}(),X.Create=function(a,b,c){return new X(a,b)},X.Destroy=function(a,b){};var Y,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2PolyContact=Y=Y=function(){function a(a,b){this.m_node1=new O,this.m_node2=new O,this.m_flags=0;if(!a||!b){this.m_shape1=null,this.m_shape2=null;return}this.m_shape1=a,this.m_shape2=b,this.m_manifoldCount=0,this.m_friction=Math.sqrt(this.m_shape1.m_friction*this.m_shape2.m_friction),this.m_restitution=g.b2Max(this.m_shape1.m_restitution,this.m_shape2.m_restitution),this.m_prev=null,this.m_next=null,this.m_node1.contact=null,this.m_node1.prev=null,this.m_node1.next=null,this.m_node1.other=null,this.m_node2.contact=null,this.m_node2.prev=null,this.m_node2.next=null,this.m_node2.other=null,this.m0=new u,this.m_manifold=[new u],this.m_manifold[0].pointCount=0}return D(a,P),a.prototype.m0=new u,a.prototype.Evaluate=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o;i=this.m_manifold[0],l=this.m0.points;for(g=0,m=i.pointCount;0<=m?g<m:g>m;0<=m?g++:g--)j=l[g],k=i.points[g],j.normalImpulse=k.normalImpulse,j.tangentImpulse=k.tangentImpulse,j.id=k.id.Copy();this.m0.pointCount=i.pointCount,p.b2CollidePoly(i,this.m_shape1,this.m_shape2,!1);if(i.pointCount>0){h=[!1,!1];for(c=0,n=i.pointCount;0<=n?c<n:c>n;0<=n?c++:c--){a=i.points[c],a.normalImpulse=0,a.tangentImpulse=0,e=a.id.key;for(f=0,o=this.m0.pointCount;0<=o?f<o:f>o;0<=o?f++:f--){if(h[f]===!0)continue;b=this.m0.points[f],d=b.id;if(d.key===e){h[f]=!0,a.normalImpulse=b.normalImpulse,a.tangentImpulse=b.tangentImpulse;break}}}return this.m_manifoldCount=1}return this.m_manifoldCount=0},a.prototype.GetManifolds=function(){return this.m_manifold},a.prototype.m_manifold=[new u],a}(),Y.Create=function(a,b,c){return new Y(a,b)},Y.Destroy=function(a,b){};var Z,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2ContactManager=Z=Z=function(){function a(){this.m_nullContact=new W,this.m_world=null,this.m_destroyImmediate=!1}return D(a,l),a.prototype.PairAdded=function(a,b){var c,d,e,f,g,h,i;return f=a,g=b,c=f.m_body,d=g.m_body,c.IsStatic()&&d.IsStatic()?this.m_nullContact:f.m_body===g.m_body?this.m_nullContact:d.IsConnected(c)?this.m_nullContact:this.m_world.m_filter!==null&&this.m_world.m_filter.ShouldCollide(f,g)===!1?this.m_nullContact:(d.m_invMass===0&&(i=f,f=g,g=i,h=c,c=d,d=h),e=P.Create(f,g,this.m_world.m_blockAllocator),e==null?this.m_nullContact:(e.m_prev=null,e.m_next=this.m_world.m_contactList,this.m_world.m_contactList!==null&&(this.m_world.m_contactList.m_prev=e),this.m_world.m_contactList=e,this.m_world.m_contactCount++,e))},a.prototype.CleanContactList=function(){var a,b,c;a=this.m_world.m_contactList,c=[];while(a!=null)b=a,a=a.m_next,c.push(b.m_flags&P.e_destroyFlag?(this.DestroyContact(b),b=null):void 0);return c},a.prototype.Collide=function(){var a,b,c,d,e,f,g,h;c=this.m_world.m_contactList,h=[];while(c!=null){if(!c.m_shape1.m_body.IsSleeping()||!c.m_shape2.m_body.IsSleeping())g=c.GetManifoldCount(),c.Evaluate(),d=c.GetManifoldCount(),g===0&&d>0?(a=c.m_shape1.m_body,b=c.m_shape2.m_body,e=c.m_node1,f=c.m_node2,e.contact=c,e.other=b,e.prev=null,e.next=a.m_contactList,e.next!==null&&(e.next.prev=c.m_node1),a.m_contactList=c.m_node1,f.contact=c,f.other=a,f.prev=null,f.next=b.m_contactList,f.next!==null&&(f.next.prev=f),b.m_contactList=f):g>0&&d===0&&(a=c.m_shape1.m_body,b=c.m_shape2.m_body,e=c.m_node1,f=c.m_node2,e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e===a.m_contactList&&(a.m_contactList=e.next),e.prev=null,e.next=null,f.prev&&(f.prev.next=f.next),f.next&&(f.next.prev=f.prev),f===b.m_contactList&&(b.m_contactList=f.next),f.prev=null,f.next=null);h.push(c=c.m_next)}return h},a.prototype.m_world=null,a.prototype.m_nullContact=new W,a.prototype.m_destroyImmediate=null,a}();var $;b.b2World=$=$=function(){function a(a,b,c){this.step=new N,this.m_contactManager=new Z,this.m_listener=null,this.m_filter=L.b2_defaultFilter,this.m_bodyList=null,this.m_contactList=null,this.m_jointList=null,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_bodyDestroyList=null,this.m_allowSleep=c,this.m_gravity=b,this.m_contactManager.m_world=this,this.m_broadPhase=new o(a,this.m_contactManager),this.m_groundBody=this.CreateBody(new K)}return a.prototype.SetListener=function(a){return this.m_listener=a},a.prototype.SetFilter=function(a){return this.m_filter=a},a.prototype.CreateBody=function(a){var b;return b=new J(a,this),b.m_prev=null,b.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=b),this.m_bodyList=b,++this.m_bodyCount,b},a.prototype.step=new N,a.prototype.Step=function(a,b){var c,d,e,f,h,i,j,k,l,m,n,o,p,q,r,s;this.step.dt=a,this.step.iterations=b,a>0?this.step.inv_dt=1/a:this.step.inv_dt=0,this.m_positionIterationCount=0,this.m_contactManager.CleanContactList(),this.CleanBodyList(),this.m_contactManager.Collide(),h=new M(this.m_bodyCount,this.m_contactCount,this.m_jointCount,this.m_stackAllocator),c=this.m_bodyList;while(c!=null)c.m_flags&=~J.e_islandFlag,c=c.m_next;d=this.m_contactList;while(d!=null)d.m_flags&=~P.e_islandFlag,d=d.m_next;i=this.m_jointList;while(i!=null)i.m_islandFlag=!1,i=i.m_next;q=this.m_bodyCount,o=new Array(this.m_bodyCount);for(k=0,r=this.m_bodyCount;0<=r?k<r:k>r;0<=r?k++:k--)o[k]=null;n=this.m_bodyList;while(n!=null){if(!(n.m_flags&(J.e_staticFlag|J.e_islandFlag|J.e_sleepFlag|J.e_frozenFlag))){h.Clear(),p=0,o[p++]=n,n.m_flags|=J.e_islandFlag;while(p>0){c=o[--p],h.AddBody(c),c.m_flags&=~J.e_sleepFlag;if(!(c.m_flags&J.e_staticFlag)){e=c.m_contactList;while(e!=null)e.contact.m_flags&P.e_islandFlag||(h.AddContact(e.contact),e.contact.m_flags|=P.e_islandFlag,l=e.other,l.m_flags&J.e_islandFlag||(o[p++]=l,l.m_flags|=J.e_islandFlag)),e=e.next;j=c.m_jointList;while(j!=null)j.joint.m_islandFlag!==!0&&(h.AddJoint(j.joint),j.joint.m_islandFlag=!0,l=j.other,l.m_flags&J.e_islandFlag||(o[p++]=l,l.m_flags|=J.e_islandFlag)),j=j.next}}h.Solve(this.step,this.m_gravity),this.m_positionIterationCount=g.b2Max(this.m_positionIterationCount,M.m_positionIterationCount),this.m_allowSleep&&h.UpdateSleep(a);for(f=0,s=h.m_bodyCount;0<=s?f<s:f>s;0<=s?f++:f--)c=h.m_bodies[f],c.m_flags&J.e_staticFlag&&(c.m_flags&=~J.e_islandFlag),c.IsFrozen()&&this.m_listener&&(m=this.m_listener.NotifyBoundaryViolated(c),m===_.b2_destroyBody&&(this.DestroyBody(c),c=null,h.m_bodies[f]=null))}n=n.m_next}return this.m_broadPhase.Commit()},a.prototype.CleanBodyList=function(){var a,b,c,d;this.m_contactManager.m_destroyImmediate=!0,a=this.m_bodyDestroyList;while(a!=null){b=a,a=a.m_next,c=b.m_jointList;while(c!=null)d=c,c=c.next,this.m_listener&&this.m_listener.NotifyJointDestroyed(d.joint),this.DestroyJoint(d.joint);b.Destroy()}return this.m_bodyDestroyList=null,this.m_contactManager.m_destroyImmediate=!1},a}(),$.s_enablePositionCorrection=1,$.s_enableWarmStarting=1;var _;b.b2WorldListener=_=_=function(){function a(){}return a.prototype.NotifyJointDestroyed=function(a){},a.prototype.NotifyBoundaryViolated=function(b){return a.b2_freezeBody},a}(),_.b2_freezeBody=0,_.b2_destroyBody=1;var ba;b.b2JointNode=ba=ba=function(){function a(){}return a.prototype.other=null,a.prototype.joint=null,a.prototype.prev=null,a.prototype.next=null,a}();var bb;b.b2Joint=bb=bb=function(){function a(a){this.m_node1=new ba,this.m_node2=new ba,this.m_type=a.type,this.m_prev=null,this.m_next=null,this.m_body1=a.body1,this.m_body2=a.body2,this.m_collideConnected=a.collideConnected,this.m_islandFlag=!1,this.m_userData=a.userData}return a.prototype.GetType=function(){return this.m_type},a.prototype.GetAnchor1=function(){return null},a.prototype.GetAnchor2=function(){return null},a.prototype.GetReactionForce=function(a){return null},a.prototype.GetReactionTorque=function(a){return 0},a.prototype.GetBody1=function(){return this.m_body1},a.prototype.GetBody2=function(){return this.m_body2},a.prototype.GetNext=function(){return this.m_next},a.prototype.GetUserData=function(){return this.m_userData},a.prototype.PrepareVelocitySolver=function(){},a.prototype.SolveVelocityConstraints=function(a){},a.prototype.PreparePositionSolver=function(){},a.prototype.SolvePositionConstraints=function(){return!1},a.prototype.m_type=0,a.prototype.m_prev=null,a.prototype.m_next=null,a.prototype.m_node1=new ba,a.prototype.m_node2=new ba,a.prototype.m_body1=null,a.prototype.m_body2=null,a.prototype.m_islandFlag=null,a.prototype.m_collideConnected=null,a.prototype.m_userData=null,a}(),bb.Create=function(a,b){var c;c=null;switch(a.type){case bb.e_distanceJoint:c=new bd(a);break;case bb.e_mouseJoint:c=new bi(a);break;case bb.e_prismaticJoint:c=new bk(a);break;case bb.e_revoluteJoint:c=new bo(a);break;case bb.e_pulleyJoint:c=new bm(a);break;case bb.e_gearJoint:c=new bg(a);break;default:}return c},bb.Destroy=function(a,b){switch(a.m_type){case bb.e_distanceJoint:return b.Free(a,sizeof(bd));case bb.e_mouseJoint:return b.Free(a,sizeof(bi));case bb.e_prismaticJoint:return b.Free(a,sizeof(e_prismaticJoint));case bb.e_revoluteJoint:return b.Free(a,sizeof(bo));case bb.e_pulleyJoint:return b.Free(a,sizeof(bm));case bb.e_gearJoint:return b.Free(a,sizeof(bg));default:return b2Assert(!1)}},bb.e_unknownJoint=0,bb.e_revoluteJoint=1,bb.e_prismaticJoint=2,bb.e_distanceJoint=3,bb.e_pulleyJoint=4,bb.e_mouseJoint=5,bb.e_gearJoint=6,bb.e_inactiveLimit=0,bb.e_atLowerLimit=1,bb.e_atUpperLimit=2,bb.e_equalLimits=3;var bc;b.b2JointDef=bc=bc=function(){function a(){this.type=bb.e_unknownJoint,this.userData=null,this.body1=null,this.body2=null,this.collideConnected=!1}return a.prototype.type=0,a.prototype.userData=null,a.prototype.body1=null,a.prototype.body2=null,a.prototype.collideConnected=null,a}();var bd,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2DistanceJoint=bd=bd=function(){function a(){var a,b,c;this.m_node1=new ba,this.m_node2=new ba,this.m_type=def.type,this.m_prev=null,this.m_next=null,this.m_body1=def.body1,this.m_body2=def.body2,this.m_collideConnected=def.collideConnected,this.m_islandFlag=!1,this.m_userData=def.userData,this.m_localAnchor1=new e,this.m_localAnchor2=new e,this.m_u=new e,a=this.m_body1.m_R,b=def.anchorPoint1.x-this.m_body1.m_position.x,c=def.anchorPoint1.y-this.m_body1.m_position.y,this.m_localAnchor1.x=b*a.col1.x+c*a.col1.y,this.m_localAnchor1.y=b*a.col2.x+c*a.col2.y,a=this.m_body2.m_R,b=def.anchorPoint2.x-this.m_body2.m_position.x,c=def.anchorPoint2.y-this.m_body2.m_position.y,this.m_localAnchor2.x=b*a.col1.x+c*a.col1.y,this.m_localAnchor2.y=b*a.col2.x+c*a.col2.y,b=def.anchorPoint2.x-def.anchorPoint1.x,c=def.anchorPoint2.y-def.anchorPoint1.y,this.m_length=Math.sqrt(b*b+c*c),this.m_impulse=0}return D(a,bb),a.prototype.PrepareVelocitySolver=function(){var a,b,d,e,f,g,h,i,j,k;return k=this.m_body1.m_R,g=k.col1.x*this.m_localAnchor1.x+k.col2.x*this.m_localAnchor1.y,h=k.col1.y*this.m_localAnchor1.x+k.col2.y*this.m_localAnchor1.y,k=this.m_body2.m_R,i=k.col1.x*this.m_localAnchor2.x+k.col2.x*this.m_localAnchor2.y,j=k.col1.y*this.m_localAnchor2.x+k.col2.y*this.m_localAnchor2.y,this.m_u.x=this.m_body2.m_position.x+i-this.m_body1.m_position.x-g,this.m_u.y=this.m_body2.m_position.y+j-this.m_body1.m_position.y-h,f=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y),f>c.b2_linearSlop?this.m_u.Multiply(1/f):this.m_u.SetZero(),d=g*this.m_u.y-h*this.m_u.x,e=i*this.m_u.y-j*this.m_u.x,this.m_mass=this.m_body1.m_invMass+this.m_body1.m_invI*d*d+this.m_body2.m_invMass+this.m_body2.m_invI*e*e,this.m_mass=1/this.m_mass,$.s_enableWarmStarting?(a=this.m_impulse*this.m_u.x,b=this.m_impulse*this.m_u.y,this.m_body1.m_linearVelocity.x-=this.m_body1.m_invMass*a,this.m_body1.m_linearVelocity.y-=this.m_body1.m_invMass*b,this.m_body1.m_angularVelocity-=this.m_body1.m_invI*(g*b-h*a),this.m_body2.m_linearVelocity.x+=this.m_body2.m_invMass*a,this.m_body2.m_linearVelocity.y+=this.m_body2.m_invMass*b,this.m_body2.m_angularVelocity+=this.m_body2.m_invI*(i*b-j*a)):this.m_impulse=0},a.prototype.SolveVelocityConstraints=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;return j=this.m_body1.m_R,f=j.col1.x*this.m_localAnchor1.x+j.col2.x*this.m_localAnchor1.y,g=j.col1.y*this.m_localAnchor1.x+j.col2.y*this.m_localAnchor1.y,j=this.m_body2.m_R,h=j.col1.x*this.m_localAnchor2.x+j.col2.x*this.m_localAnchor2.y,i=j.col1.y*this.m_localAnchor2.x+j.col2.y*this.m_localAnchor2.y,k=this.m_body1.m_linearVelocity.x+ -this.m_body1.m_angularVelocity*g,l=this.m_body1.m_linearVelocity.y+this.m_body1.m_angularVelocity*f,m=this.m_body2.m_linearVelocity.x+ -this.m_body2.m_angularVelocity*i,n=this.m_body2.m_linearVelocity.y+this.m_body2.m_angularVelocity*h,b=this.m_u.x*(m-k)+this.m_u.y*(n-l),e=-this.m_mass*b,this.m_impulse+=e,c=e*this.m_u.x,d=e*this.m_u.y,this.m_body1.m_linearVelocity.x-=this.m_body1.m_invMass*c,this.m_body1.m_linearVelocity.y-=this.m_body1.m_invMass*d,this.m_body1.m_angularVelocity-=this.m_body1.m_invI*(f*d-g*c),this.m_body2.m_linearVelocity.x+=this.m_body2.m_invMass*c,this.m_body2.m_linearVelocity.y+=this.m_body2.m_invMass*d,this.m_body2.m_angularVelocity+=this.m_body2.m_invI*(h*d-i*c)},a.prototype.SolvePositionConstraints=function(){var a,b,d,e,f,h,i,j,k,l,m,n;return n=this.m_body1.m_R,j=n.col1.x*this.m_localAnchor1.x+n.col2.x*this.m_localAnchor1.y,k=n.col1.y*this.m_localAnchor1.x+n.col2.y*this.m_localAnchor1.y,n=this.m_body2.m_R,l=n.col1.x*this.m_localAnchor2.x+n.col2.x*this.m_localAnchor2.y,m=n.col1.y*this.m_localAnchor2.x+n.col2.y*this.m_localAnchor2.y,e=this.m_body2.m_position.x+l-this.m_body1.m_position.x-j,f=this.m_body2.m_position.y+m-this.m_body1.m_position.y-k,i=Math.sqrt(e*e+f*f),e/=i,f/=i,a=i-this.m_length,a=g.b2Clamp(a,-c.b2_maxLinearCorrection,c.b2_maxLinearCorrection),h=-this.m_mass*a,this.m_u.Set(e,f),b=h*this.m_u.x,d=h*this.m_u.y,this.m_body1.m_position.x-=this.m_body1.m_invMass*b,this.m_body1.m_position.y-=this.m_body1.m_invMass*d,this.m_body1.m_rotation-=this.m_body1.m_invI*(j*d-k*b),this.m_body2.m_position.x+=this.m_body2.m_invMass*b,this.m_body2.m_position.y+=this.m_body2.m_invMass*d,this.m_body2.m_rotation+=this.m_body2.m_invI*(l*d-m*b),this.m_body1.m_R.Set(this.m_body1.m_rotation),this.m_body2.m_R.Set(this.m_body2.m_rotation),g.b2Abs(a)<c.b2_linearSlop},a.prototype.GetAnchor1=function(){return g.AddVV(this.m_body1.m_position,g.b2MulMV(this.m_body1.m_R,this.m_localAnchor1))},a.prototype.GetAnchor2=function(){return g.AddVV(this.m_body2.m_position,g.b2MulMV(this.m_body2.m_R,this.m_localAnchor2))},a.prototype.GetReactionForce=function(a){var b;return b=new e,b.SetV(this.m_u),b.Multiply(this.m_impulse*a),b},a.prototype.GetReactionTorque=function(a){return 0},a.prototype.m_localAnchor1=new e,a.prototype.m_localAnchor2=new e,a.prototype.m_u=new e,a.prototype.m_impulse=null,a.prototype.m_mass=null,a.prototype.m_length=null,a}();var be,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2DistanceJointDef=be=be=function(){function a(){this.type=bb.e_unknownJoint,this.userData=null,this.body1=null,this.body2=null,this.collideConnected=!1,this.anchorPoint1=new e,this.anchorPoint2=new e,this.type=bb.e_distanceJoint}return D(a,bc),a.prototype.anchorPoint1=new e,a.prototype.anchorPoint2=new e,a}();var bf;b.b2Jacobian=bf=bf=function(){function a(){this.linear1=new e,this.linear2=new e}return a.prototype.linear1=new e,a.prototype.angular1=null,a.prototype.linear2=new e,a.prototype.angular2=null,a.prototype.SetZero=function(){return this.linear1.SetZero(),this.angular1=0,this.linear2.SetZero(),this.angular2=0},a.prototype.Set=function(a,b,c,d){return this.linear1.SetV(a),this.angular1=b,this.linear2.SetV(c),this.angular2=d},a.prototype.Compute=function(a,b,c,d){return this.linear1.x*a.x+this.linear1.y*a.y+this.angular1*b+(this.linear2.x*c.x+this.linear2.y*c.y)+this.angular2*d},a}();var bg,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2GearJoint=bg=bg=function(){function a(){var a,b;this.m_node1=new ba,this.m_node2=new ba,this.m_type=def.type,this.m_prev=null,this.m_next=null,this.m_body1=def.body1,this.m_body2=def.body2,this.m_collideConnected=def.collideConnected,this.m_islandFlag=!1,this.m_userData=def.userData,this.m_groundAnchor1=new e,this.m_groundAnchor2=new e,this.m_localAnchor1=new e,this.m_localAnchor2=new e,this.m_J=new bf,this.m_revolute1=null,this.m_prismatic1=null,this.m_revolute2=null,this.m_prismatic2=null,this.m_ground1=def.joint1.m_body1,this.m_body1=def.joint1.m_body2,def.joint1.m_type===bb.e_revoluteJoint?(this.m_revolute1=def.joint1,this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2),a=this.m_revolute1.GetJointAngle()):(this.m_prismatic1=def.joint1,this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2),a=this.m_prismatic1.GetJointTranslation()),this.m_ground2=def.joint2.m_body1,this.m_body2=def.joint2.m_body2,def.joint2.m_type===bb.e_revoluteJoint?(this.m_revolute2=def.joint2,this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2),b=this.m_revolute2.GetJointAngle()):(this.m_prismatic2=def.joint2,this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2),b=this.m_prismatic2.GetJointTranslation()),this.m_ratio=def.ratio,this.m_constant=a+this.m_ratio*b,this.m_impulse=0}return D(a,bb),a.prototype.GetAnchor1=function(){var a;return a=this.m_body1.m_R,new e(this.m_body1.m_position.x+(a.col1.x*this.m_localAnchor1.x+a.col2.x*this.m_localAnchor1.y),this.m_body1.m_position.y+(a.col1.y*this.m_localAnchor1.x+a.col2.y*this.m_localAnchor1.y))},a.prototype.GetAnchor2=function(){var a;return a=this.m_body2.m_R,new e(this.m_body2.m_position.x+(a.col1.x*this.m_localAnchor2.x+a.col2.x*this.m_localAnchor2.y),this.m_body2.m_position.y+(a.col1.y*this.m_localAnchor2.x+a.col2.y*this.m_localAnchor2.y))},a.prototype.GetReactionForce=function(a){return new e},a.prototype.GetReactionTorque=function(a){return 0},a.prototype.GetRatio=function(){return this.m_ratio},a.prototype.PrepareVelocitySolver=function(){var a,b,c,d,e,f,g,h,i,j,k,l;return e=this.m_ground1,f=this.m_ground2,b=this.m_body1,c=this.m_body2,a=0,this.m_J.SetZero(),this.m_revolute1?(this.m_J.angular1=-1,a+=b.m_invI):(i=e.m_R,j=this.m_prismatic1.m_localXAxis1,k=i.col1.x*j.x+i.col2.x*j.y,l=i.col1.y*j.x+i.col2.y*j.y,i=b.m_R,g=i.col1.x*this.m_localAnchor1.x+i.col2.x*this.m_localAnchor1.y,h=i.col1.y*this.m_localAnchor1.x+i.col2.y*this.m_localAnchor1.y,d=g*l-h*k,this.m_J.linear1.Set(-k,-l),this.m_J.angular1=-d,a+=b.m_invMass+b.m_invI*d*d),this.m_revolute2?(this.m_J.angular2=-this.m_ratio,a+=this.m_ratio*this.m_ratio*c.m_invI):(i=f.m_R,j=this.m_prismatic2.m_localXAxis1,k=i.col1.x*j.x+i.col2.x*j.y,l=i.col1.y*j.x+i.col2.y*j.y,i=c.m_R,g=i.col1.x*this.m_localAnchor2.x+i.col2.x*this.m_localAnchor2.y,h=i.col1.y*this.m_localAnchor2.x+i.col2.y*this.m_localAnchor2.y,d=g*l-h*k,this.m_J.linear2.Set(-this.m_ratio*k,-this.m_ratio*l),this.m_J.angular2=-this.m_ratio*d,a+=this.m_ratio*this.m_ratio*(c.m_invMass+c.m_invI*d*d)),this.m_mass=1/a,b.m_linearVelocity.x+=b.m_invMass*this.m_impulse*this.m_J.linear1.x,b.m_linearVelocity.y+=b.m_invMass*this.m_impulse*this.m_J.linear1.y,b.m_angularVelocity+=b.m_invI*this.m_impulse*this.m_J.angular1,c.m_linearVelocity.x+=c.m_invMass*this.m_impulse*this.m_J.linear2.x,c.m_linearVelocity.y+=c.m_invMass*this.m_impulse*this.m_J.linear2.y,c.m_angularVelocity+=c.m_invI*this.m_impulse*this.m_J.angular2},a.prototype.SolveVelocityConstraints=function(a){var b,c,d,e;return c=this.m_body1,d=this.m_body2,b=this.m_J.Compute(c.m_linearVelocity,c.m_angularVelocity,d.m_linearVelocity,d.m_angularVelocity),e=-this.m_mass*b,this.m_impulse+=e,c.m_linearVelocity.x+=c.m_invMass*e*this.m_J.linear1.x,c.m_linearVelocity.y+=c.m_invMass*e*this.m_J.linear1.y,c.m_angularVelocity+=c.m_invI*e*this.m_J.angular1,d.m_linearVelocity.x+=d.m_invMass*e*this.m_J.linear2.x,d.m_linearVelocity.y+=d.m_invMass*e*this.m_J.linear2.y,d.m_angularVelocity+=d.m_invI*e*this.m_J.angular2},a.prototype.SolvePositionConstraints=function(){var a,b,d,e,f,g,h;return h=0,b=this.m_body1,d=this.m_body2,this.m_revolute1?e=this.m_revolute1.GetJointAngle():e=this.m_prismatic1.GetJointTranslation(),this.m_revolute2?f=this.m_revolute2.GetJointAngle():f=this.m_prismatic2.GetJointTranslation(),a=this.m_constant-(e+this.m_ratio*f),g=-this.m_mass*a,b.m_position.x+=b.m_invMass*g*this.m_J.linear1.x,b.m_position.y+=b.m_invMass*g*this.m_J.linear1.y,b.m_rotation+=b.m_invI*g*this.m_J.angular1,d.m_position.x+=d.m_invMass*g*this.m_J.linear2.x,d.m_position.y+=d.m_invMass*g*this.m_J.linear2.y,d.m_rotation+=d.m_invI*g*this.m_J.angular2,b.m_R.Set(b.m_rotation),d.m_R.Set(d.m_rotation),h<c.b2_linearSlop},a.prototype.m_ground1=null,a.prototype.m_ground2=null,a.prototype.m_revolute1=null,a.prototype.m_prismatic1=null,a.prototype.m_revolute2=null,a.prototype.m_prismatic2=null,a.prototype.m_groundAnchor1=new e,a.prototype.m_groundAnchor2=new e,a.prototype.m_localAnchor1=new e,a.prototype.m_localAnchor2=new e,a.prototype.m_J=new bf,a.prototype.m_constant=null,a.prototype.m_ratio=null,a.prototype.m_mass=null,a.prototype.m_impulse=null,a}();var bh,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2GearJointDef=bh=bh=function(){function a(){this.type=bb.e_gearJoint,this.joint1=null,this.joint2=null,this.ratio=1}return D(a,bc),a.prototype.joint1=null,a.prototype.joint2=null,a.prototype.ratio=null,a}();var bi,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2MouseJoint=bi=bi=function(){function a(){var a,b,d,h,i,j;this.m_node1=new ba,this.m_node2=new ba,this.m_type=def.type,this.m_prev=null,this.m_next=null,this.m_body1=def.body1,this.m_body2=def.body2,this.m_collideConnected=def.collideConnected,this.m_islandFlag=!1,this.m_userData=def.userData,this.K=new f,this.K1=new f,this.K2=new f,this.m_localAnchor=new e,this.m_target=new e,this.m_impulse=new e,this.m_ptpMass=new f,this.m_C=new e,this.m_target.SetV(def.target),i=this.m_target.x-this.m_body2.m_position.x,j=this.m_target.y-this.m_body2.m_position.y,this.m_localAnchor.x=i*this.m_body2.m_R.col1.x+j*this.m_body2.m_R.col1.y,this.m_localAnchor.y=i*this.m_body2.m_R.col2.x+j*this.m_body2.m_R.col2.y,this.m_maxForce=def.maxForce,this.m_impulse.SetZero(),d=this.m_body2.m_mass,h=2*c.b2_pi*def.frequencyHz,a=2*d*def.dampingRatio*h,b=d*h*h,this.m_gamma=1/(a+def.timeStep*b),this.m_beta=def.timeStep*b/(a+def.timeStep*b),{GetAnchor1:function(){return this.m_target},GetAnchor2:function(){var a;return a=g.b2MulMV(this.m_body2.m_R,this.m_localAnchor),a.Add(this.m_body2.m_position),a},GetReactionForce:function(a){var b;return b=new e,b.SetV(this.m_impulse),b.Multiply(a),b},GetReactionTorque:function(a){return 0},SetTarget:function(a){return this.m_body2.WakeUp(),this.m_target=a},K:new f,K1:new f,K2:new f,PrepareVelocitySolver:function(){var a,b,c,d,e,f,g,h;return c=this.m_body2,h=c.m_R,f=h.col1.x*this.m_localAnchor.x+h.col2.x*this.m_localAnchor.y,g=h.col1.y*this.m_localAnchor.x+h.col2.y*this.m_localAnchor.y,e=c.m_invMass,d=c.m_invI,this.K1.col1.x=e,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=e,this.K2.col1.x=d*g*g,this.K2.col2.x=-d*f*g,this.K2.col1.y=-d*f*g,this.K2.col2.y=d*f*f,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.Invert(this.m_ptpMass),this.m_C.x=c.m_position.x+f-this.m_target.x,this.m_C.y=c.m_position.y+g-this.m_target.y,c.m_angularVelocity*=.98,a=this.m_impulse.x,b=this.m_impulse.y,c.m_linearVelocity.x+=e*a,c.m_linearVelocity.y+=e*b,c.m_angularVelocity+=d*(f*b-g*a)},SolveVelocityConstraints:function(a){var b,c,d,e,f,g,h,k,l,m,n,o;return d=this.m_body2,o=d.m_R,m=o.col1.x*this.m_localAnchor.x+o.col2.x*this.m_localAnchor.y,n=o.col1.y*this.m_localAnchor.x+o.col2.y*this.m_localAnchor.y,b=d.m_linearVelocity.x+ -d.m_angularVelocity*n,c=d.m_linearVelocity.y+d.m_angularVelocity*m,o=this.m_ptpMass,i=b+this.m_beta*a.inv_dt*this.m_C.x+this.m_gamma*this.m_impulse.x,j=c+this.m_beta*a.inv_dt*this.m_C.y+this.m_gamma*this.m_impulse.y,f=-(o.col1.x*i+o.col2.x*j),g=-(o.col1.y*i+o.col2.y*j),k=this.m_impulse.x,l=this.m_impulse.y,this.m_impulse.x+=f,this.m_impulse.y+=g,h=this.m_impulse.Length(),h>a.dt*this.m_maxForce&&this.m_impulse.Multiply(a.dt*this.m_maxForce/h),e=this.m_impulse-oldImpulse,f=this.m_impulse.x-k,g=this.m_impulse.y-l,d.m_linearVelocity.x+=d.m_invMass*f,d.m_linearVelocity.y+=d.m_invMass*g,d.m_angularVelocity+=d.m_invI*(m*g-n*f)},SolvePositionConstraints:function(){return!0},m_localAnchor:new e,m_target:new e,m_impulse:new e,m_ptpMass:new f,m_C:new e,m_maxForce:null,m_beta:null,m_gamma:null}}return D(a,bb),a}();var bj,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2MouseJointDef=bj=bj=function(){function a(){this.type=bb.e_unknownJoint,this.userData=null,this.body1=null,this.body2=null,this.collideConnected=!1,this.target=new e,this.type=bb.e_mouseJoint,this.maxForce=0,this.frequencyHz=5,this.dampingRatio=.7,this.timeStep=1/60}return D(a,bc),a.prototype.target=new e,a.prototype.maxForce=null,a.prototype.frequencyHz=null,a.prototype.dampingRatio=null,a.prototype.timeStep=null,a}();var bk,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2PrismaticJoint=bk=bk=function(){function a(){var a,b,c;this.m_node1=new ba,this.m_node2=new ba,this.m_type=def.type,this.m_prev=null,this.m_next=null,this.m_body1=def.body1,this.m_body2=def.body2,this.m_collideConnected=def.collideConnected,this.m_islandFlag=!1,this.m_userData=def.userData,this.m_localAnchor1=new e,this.m_localAnchor2=new e,this.m_localXAxis1=new e,this.m_localYAxis1=new e,this.m_linearJacobian=new bf,this.m_motorJacobian=new bf,a=this.m_body1.m_R,b=def.anchorPoint.x-this.m_body1.m_position.x,c=def.anchorPoint.y-this.m_body1.m_position.y,this.m_localAnchor1.Set(b*a.col1.x+c*a.col1.y,b*a.col2.x+c*a.col2.y),a=this.m_body2.m_R,b=def.anchorPoint.x-this.m_body2.m_position.x,c=def.anchorPoint.y-this.m_body2.m_position.y,this.m_localAnchor2.Set(b*a.col1.x+c*a.col1.y,b*a.col2.x+c*a.col2.y),a=this.m_body1.m_R,b=def.axis.x,c=def.axis.y,this.m_localXAxis1.Set(b*a.col1.x+c*a.col1.y,b*a.col2.x+c*a.col2.y),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_initialAngle=this.m_body2.m_rotation-this.m_body1.m_rotation,this.m_linearJacobian.SetZero(),this.m_linearMass=0,this.m_linearImpulse=0,this.m_angularMass=0,this.m_angularImpulse=0,this.m_motorJacobian.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_limitImpulse=0,this.m_limitPositionImpulse=0,this.m_lowerTranslation=def.lowerTranslation,this.m_upperTranslation=def.upperTranslation,this.m_maxMotorForce=def.motorForce,this.m_motorSpeed=def.motorSpeed,this.m_enableLimit=def.enableLimit,this.m_enableMotor=def.enableMotor}return D(a,bb),a}();var bl,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2PrismaticJointDef=bl=bl=function(){function a(){this.type=bb.e_unknownJoint,this.userData=null,this.body1=null,this.body2=null,this.collideConnected=!1,this.type=bb.e_prismaticJoint,this.anchorPoint=new e(0,0),this.axis=new e(0,0),this.lowerTranslation=0,this.upperTranslation=0,this.motorForce=0,this.motorSpeed=0,this.enableLimit=!1,this.enableMotor=!1}return D(a,bc),a.prototype.anchorPoint=null,a.prototype.axis=null,a.prototype.lowerTranslation=null,a.prototype.upperTranslation=null,a.prototype.motorForce=null,a.prototype.motorSpeed=null,a.prototype.enableLimit=null,a.prototype.enableMotor=null,a}();var bm,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2PulleyJoint=bm=bm=function(){function a(){var b,c,d,f,h,i,j;this.m_node1=new ba,this.m_node2=new ba,this.m_type=def.type,this.m_prev=null,this.m_next=null,this.m_body1=def.body1,this.m_body2=def.body2,this.m_collideConnected=def.collideConnected,this.m_islandFlag=!1,this.m_userData=def.userData,this.m_groundAnchor1=new e,this.m_groundAnchor2=new e,this.m_localAnchor1=new e,this.m_localAnchor2=new e,this.m_u1=new e,this.m_u2=new e,this.m_ground=this.m_body1.m_world.m_groundBody,this.m_groundAnchor1.x=def.groundPoint1.x-this.m_ground.m_position.x,this.m_groundAnchor1.y=def.groundPoint1.y-this.m_ground.m_position.y,this.m_groundAnchor2.x=def.groundPoint2.x-this.m_ground.m_position.x,this.m_groundAnchor2.y=def.groundPoint2.y-this.m_ground.m_position.y,h=this.m_body1.m_R,i=def.anchorPoint1.x-this.m_body1.m_position.x,j=def.anchorPoint1.y-this.m_body1.m_position.y,this.m_localAnchor1.x=i*h.col1.x+j*h.col1.y,this.m_localAnchor1.y=i*h.col2.x+j*h.col2.y,h=this.m_body2.m_R,i=def.anchorPoint2.x-this.m_body2.m_position.x,j=def.anchorPoint2.y-this.m_body2.m_position.y,this.m_localAnchor2.x=i*h.col1.x+j*h.col1.y,this.m_localAnchor2.y=i*h.col2.x+j*h.col2.y,this.m_ratio=def.ratio,i=def.groundPoint1.x-def.anchorPoint1.x,j=def.groundPoint1.y-def.anchorPoint1.y,b=Math.sqrt(i*i+j*j),i=def.groundPoint2.x-def.anchorPoint2.x,j=def.groundPoint2.y-def.anchorPoint2.y,c=Math.sqrt(i*i+j*j),d=g.b2Max(.5*a.b2_minPulleyLength,b),f=g.b2Max(.5*a.b2_minPulleyLength,c),this.m_constant=d+this.m_ratio*f,this.m_maxLength1=g.b2Clamp(def.maxLength1,d,this.m_constant-this.m_ratio*a.b2_minPulleyLength),this.m_maxLength2=g.b2Clamp(def.maxLength2,f,(this.m_constant-a.b2_minPulleyLength)/this.m_ratio),this.m_pulleyImpulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0}return D(a,bb),a}(),bm.b2_minPulleyLength=c.b2_lengthUnitsPerMeter;var bn,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2PulleyJointDef=bn=bn=function(){function a(){this.type=bb.e_unknownJoint,this.userData=null,this.body1=null,this.body2=null,this.collideConnected=!1,this.groundPoint1=new e,this.groundPoint2=new e,this.anchorPoint1=new e,this.anchorPoint2=new e,this.type=bb.e_pulleyJoint,this.groundPoint1.Set(-1,1),this.groundPoint2.Set(1,1),this.anchorPoint1.Set(-1,0),this.anchorPoint2.Set(1,0),this.maxLength1=.5*bm.b2_minPulleyLength,this.maxLength2=.5*bm.b2_minPulleyLength,this.ratio=1,this.collideConnected=!0}return D(a,bc),a.prototype.groundPoint1=new e,a.prototype.groundPoint2=new e,a.prototype.anchorPoint1=new e,a.prototype.anchorPoint2=new e,a.prototype.maxLength1=null,a.prototype.maxLength2=null,a.prototype.ratio=null,a}();var bo,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2RevoluteJoint=bo=bo=function(){function a(){var a,b,c;this.m_node1=new ba,this.m_node2=new ba,this.m_type=def.type,this.m_prev=null,this.m_next=null,this.m_body1=def.body1,this.m_body2=def.body2,this.m_collideConnected=def.collideConnected,this.m_islandFlag=!1,this.m_userData=def.userData,this.K=new f,this.K1=new f,this.K2=new f,this.K3=new f,this.m_localAnchor1=new e,this.m_localAnchor2=new e,this.m_ptpImpulse=new e,this.m_ptpMass=new f,a=this.m_body1.m_R,b=def.anchorPoint.x-this.m_body1.m_position.x,c=def.anchorPoint.y-this.m_body1.m_position.y,this.m_localAnchor1.x=b*a.col1.x+c*a.col1.y,this.m_localAnchor1.y=b*a.col2.x+c*a.col2.y,a=this.m_body2.m_R,b=def.anchorPoint.x-this.m_body2.m_position.x,c=def.anchorPoint.y-this.m_body2.m_position.y,this.m_localAnchor2.x=b*a.col1.x+c*a.col1.y,this.m_localAnchor2.y=b*a.col2.x+c*a.col2.y,this.m_intialAngle=this.m_body2.m_rotation-this.m_body1.m_rotation,this.m_ptpImpulse.Set(0,0),this.m_motorImpulse=0,this.m_limitImpulse=0,this.m_limitPositionImpulse=0,this.m_lowerAngle=def.lowerAngle,this.m_upperAngle=def.upperAngle,this.m_maxMotorTorque=def.motorTorque,this.m_motorSpeed=def.motorSpeed,this.m_enableLimit=def.enableLimit,this.m_enableMotor=def.enableMotor}return D(a,bb),a}(),bo.tImpulse=new e;var bp,C=Object.prototype.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b.b2RevoluteJointDef=bp=bp=function(){function a(){this.type=bb.e_unknownJoint,this.userData=null,this.body1=null,this.body2=null,this.collideConnected=!1,this.type=bb.e_revoluteJoint,this.anchorPoint=new e(0,0),this.lowerAngle=0,this.upperAngle=0,this.motorTorque=0,this.motorSpeed=0,this.enableLimit=!1,this.enableMotor=!1}return D(a,bc),a.prototype.anchorPoint=null,a.prototype.lowerAngle=null,a.prototype.upperAngle=null,a.prototype.motorTorque=null,a.prototype.motorSpeed=null,a.prototype.enableLimit=null,a.prototype.enableMotor=null,a}(),provide("coffeebox2d",a.exports),function(a){return a.ender({coffeebox2d:require("coffeebox2d")})}(ender)}(),!function(){var a={exports:{}},b=a.exports,c=function(a,b){return function(){return a.apply(b,arguments)}};!function(a){var b,d;return d={},b=0,a.timeout=function(a,e,f){var g,h,i;return typeof a=="string"?g=Array.prototype.slice.call(arguments,3):(f=e,e=a,a="_timeout__"+ ++b),a in d?(h=d[a],clearTimeout(h.id)):d[a]=h={},f?(i=function(){return h.id=setTimeout(h.fn,e)},h.fn=c(function(){return f.apply(this,g)===!0?i():delete d[a]},this),i(),a):e!=null?h.fn():a in d?delete d[a]:!1}}(typeof b!="undefined"&&b!==null?b:this.timeout={}),provide("timeout",a.exports),!function(a){var b;return b=require("timeout").timeout,a.ender({timeout:b}),a.ender({timeout:function(){return b.apply(this,arguments),this}},!0)}(ender)}(),!function(){var a={exports:{}},b=a.exports;(function(a){var b,c,d,e,f,g,h;return a.strict=!1,a.renderTemplate=function(a,b,c){return a=f(a),a=e(a,b,c),a=g(a),a},f=function(a){return a.replace(/\{\{/g,"").replace(/\}\}/g,"")},g=function(a){return a.replace(/\ufe5b/g,"{").replace(/\ufe5d/g,"}")},c=(h=Array.isArray)!=null?h:function(a){return Object.prototype.toString.call(a)==="[object Array]"},b=function(a){return a.toString().replace(/&(?!\w+;)|["<>]/g,function(a){switch(a){case"&":return"&amp;";case'"':return'"';case"<":return"&lt;";case">":return"&gt;";default:return a}})},d=/\s*\{([:!])\s*([^}]*?)\s*\}([\S\s]+?)\s*\{\/\s*\2\s*\}|\{(\#)\s*[\S\s]+?\s*\#\}|\{([@&]?)\s*([^}]*?)\s*\}/mg,e=function(g,h,i){return g.replace(d,function(d,g,j,k,l,m,n){var o,p,q,r,s,t,u,v,w,x,y,z;s=g||l||m,r=j||n,o=k;switch(s){case":":x=h[r];if(x==null){if(a.strict)throw"Invalid section: "+JSON.stringify(h)+": "+r;return""}if(c(x)){u=[];for(p=0,y=x.length;p<y;p++)w=x[p],w["#"]=p,u.push(e(o,w,i));return u.join("")}return typeof x=="object"?e(o,x,i):typeof x=="function"?x.call(h,o):x?e(o,h,i):"";case"!":x=h[r];if(x==null){if(a.strict)throw"Invalid inverted section: "+JSON.stringify(h)+": "+r;return""}return!x||c(x)&&x.length===0?e(o,h,i):"";case"#":return"";case"@":q=i?i[r]:null;if(q==null){if(a.strict)throw"Invalid link: "+JSON.stringify(i)+": "+r;return""}return typeof q=="function"&&(q=q.call(h)),e(f(q),h,i);case"&":case"":x=h,v=r;while(x&&v)z=v.match(/^([^.]*)\.?(.*)$/),d=z[0],t=z[1],v=z[2],x=x[t];if(x==null){if(a.strict)throw"Invalid value: "+JSON.stringify(h)+": "+r;return""}return typeof x=="function"&&(x=x.call(h)),s==="&"?x:b(x);default:throw"Invalid section op: "+s}})}})(typeof b!="undefined"&&b!==null?b:this.wings={}),provide("wings",a.exports),function(a){var b;return b=require("wings").renderTemplate,a.ender({renderTemplate:b}),a.ender({render:function(a,c){return b(this[0].innerHTML,a,c)}},!0)}(ender)}(),!function(){var module={exports:{}},exports=module.exports;!function(context){function f(a){return a<10?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";return e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)typeof rep[c]=="string"&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}"use strict";var JSON;if(context.JSON)return;context.JSON=JSON={},typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(this),provide("ender-json",module.exports),!function(a){return a.ender({JSON:JSON})}(ender)}(),!function(){var a={exports:{}},b=a.exports;(function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;o=document.documentElement,k=function(a,b){var c,d,e;for(d=0,e=b.length;d<e;d++)c=b[d],a.push(c);return a},h=function(a,b,c,d){a=a[b];while(a)a.nodeType===1&&d(a),a=a[c]},q=o.nextElementSibling?function(a){return a.nextElementSibling}:function(a){a=a.nextSibling;while(a&&a.nodeType!==1)a=a.nextSibling;return a},f=o.compareDocumentPosition!=null?function(a,b){return(a.compareDocumentPosition(b)&16)===16}:o.contains!=null?function(a,b){return a.documentElement?b.ownerDocument===a:a!==b&&a.contains(b)}:function(a,b){if(a.documentElement)return b.ownerDocument===a;while(b=b.parentNode)if(a===b)return!0;return!1},i=o.compareDocumentPosition?function(a,b){return a===b?0:a.compareDocumentPosition(b)&4?-1:1}:o.sourceIndex?function(a,b){return a===b?0:a.sourceIndex<b.sourceIndex?-1:1}:void 0,m=function(a){return a.filter(function(b,c){return b&&(!c||a[c-1]!==b&&!f(a[c-1],b))})},t=function(a){var b;return b=[],m(a).forEach(function(a){var c;c=a.parentNode,c&&c!==b[b.length-1]&&b.push(c)}),b},e=function(a,b,c,d,e){var f,g,h;h=[],f=0,g=0;while(f<a.length&&g<b.length)switch(e[i(a[f],b[g])]){case-1:f++;break;case-2:g++;break;case 1:h.push(a[f++]);break;case 2:h.push(b[g++]);break;case 0:h.push(a[f++]),g++}if(c)while(f<a.length)h.push(a[f++]);if(d)while(g<b.length)h.push(b[g++]);return h},a.union=function(a,b){return e(a,b,!0,!0,{0:0,"-1":1,1:2})},a.intersection=function(a,b){return e(a,b,!1,!1,{0:0,"-1":-1,1:-2})},a.difference=function(a,b){return e(a,b,!0,!1,{0:-1,"-1":1,1:-2})},D={tag:function(a){return a.tagName},"class":function(a){return a.className}},function(){var a;a=document.createElement("p"),a.innerHTML='<a href="#"></a>';if(a.firstChild.getAttribute("href")!=="#")return D.href=function(a){return a.getAttribute("href",2)},D.src=function(a){return a.getAttribute("src",2)}}(),E={"nth-child":!1,"nth-of-type":!1,"first-child":!1,"first-of-type":!1,"nth-last-child":!0,"nth-last-of-type":!0,"last-child":!0,"last-of-type":!0,"only-child":!1,"only-of-type":!1},n=function(b,c){var d;return b.id?(d=[],c.forEach(function(a){var c;c=(a.ownerDocument||a).getElementById(b.id),c&&f(a,c)&&d.push(c)}),b.id=null):b.classes&&o.getElementsByClassName?(d=c.map(function(c){return b.classes.map(function(a){return c.getElementsByClassName(a)}).reduce(a.union)}).reduce(k,[]),b.classes=null):(d=c.map(function(a){return a.getElementsByTagName(b.tag||"*")}).reduce(k,[]),b.tag=null),d&&d.length?l(b,d):[]},l=function(b,c){return b.id&&(c=c.filter(function(a){return a.id===b.id})),b.tag&&b.tag!=="*"&&(c=c.filter(function(a){return a.nodeName.toLowerCase()===b.tag})),b.classes&&b.classes.forEach(function(a){c=c.filter(function(b){return(" "+b.className+" ").indexOf(" "+a+" ")>=0})}),b.attrs&&b.attrs.forEach(function(a){var b,d,e;b=a.name,d=a.op,e=a.val,c=c.filter(function(a){var c,f;return c=D[b]?D[b](a):a.getAttribute(b),f=c+"",(c||a.attributes&&a.attributes[b]&&a.attributes[b].specified)&&(d?d==="="?f===e:d==="!="?f!==e:d==="*="?f.indexOf(e)>=0:d==="^="?f.indexOf(e)===0:d==="$="?f.substr(f.length-e.length)===e:d==="~="?(" "+f+" ").indexOf(" "+e+" ")>=0:d==="|="?f===e||f.indexOf(e)===0&&f.charAt(e.length)==="-":!1:!0)})}),b.pseudos&&b.pseudos.forEach(function(b){var d,e,f,g,i,j;f=b.name,j=b.val,i=a.pseudos[f];if(!i)throw new Error("no pseudo with name: "+f);f in E&&(e=E[f]?"lastChild":"firstChild",g=E[f]?"previousSibling":"nextSibling",c.forEach(function(a){var b,c;(c=a.parentNode)&&c._sel_children===void 0&&(b={"*":0},h(c,e,g,function(a){a._sel_index=++b["*"],a._sel_indexOfType=b[a.nodeName]=(b[a.nodeName]||0)+1}),c._sel_children=b)})),d=c.filter(function(a){return i(a,j)}),f in E&&c.forEach(function(a){var b;(b=a.parentNode)&&b._sel_children!==void 0&&(h(b,e,g,function(a){a._sel_index=a._sel_indexOfType=void 0}),b._sel_children=void 0)}),c=d}),c},s=/\s*((?:\+|\-)?(\d*))n\s*((?:\+|\-)\s*\d+)?\s*/,c=function(a,b){var c,d,e;if(!b)return!1;if(isFinite(b))return a==b;if(b==="even")return a%2===0;if(b==="odd")return a%2===1;if(e=s.exec(b))return c=e[2]?parseInt(e[1]):parseInt(e[1]+"1"),d=e[3]?parseInt(e[3].replace(/\s*/,"")):0,c?(a-d)%c===0&&(a-d)/c>=0:a===d;throw new Error("invalid nth expression")},a.pseudos={"first-child":function(a){return a._sel_index===1},"only-child":function(a){return a._sel_index===1&&a.parentNode._sel_children["*"]===1},"nth-child":function(a,b){return c(a._sel_index,b)},"first-of-type":function(a){return a._sel_indexOfType===1},"only-of-type":function(a){return a._sel_indexOfType===1&&a.parentNode._sel_children[a.nodeName]===1},"nth-of-type":function(a,b){return c(a._sel_indexOfType,b)},target:function(a){return a.getAttribute("id")===location.hash.substr(1)},checked:function(a){return a.checked===!0},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},selected:function(a){return a.selected===!0},focus:function(a){return a.ownerDocument.activeElement===a},empty:function(a){return!a.childNodes.length},contains:function(a,b){var c;return((c=a.textContent)!=null?c:a.innerText).indexOf(b)>=0},"with":function(a,b){return y(b,[a]).length>0},without:function(a,b){return y(b,[a]).length===0}},F={has:"with","last-child":"first-child","nth-last-child":"nth-child","last-of-type":"first-of-type","nth-last-of-type":"nth-of-type"};for(B in F)p=F[B],a.pseudos[B]=a.pseudos[p];return b=/\[\s*([-\w]+)\s*(?:([~|^$*!]?=)\s*(?:([-\w]+)|['"]([^'"]*)['"])\s*)?\]/g,x=/::?([-\w]+)(?:\((\([^()]+\)|[^()]+)\))?/g,d=/^\s*([,+~])/,A=RegExp("^(?:\\s*(>))?\\s*(?:(\\*|\\w+))?(?:\\#([-\\w]+))?(?:\\.([-\\.\\w]+))?((?:"+b.source+")*)((?:"+x.source+")*)"),z={type:1,tag:2,id:3,classes:4,attrsAll:5,pseudosAll:10},v=function(a){var b,c,d;d=c=w(a),c.compound&&(c.children=[]);while(c[0].length<a.length)a=a.substr(c[0].length),b=w(a),b.compound?(b.children=[d],d=b):c.compound?c.children.push(b):c.child=b,c=b;return d},w=function(a){var c,e,f;if(c=d.exec(a))c.compound=!0,c.type=c[1];else{if(!(c=A.exec(a)))throw new Error("Parse error at: "+a);c.simple=!0;for(f in z)e=z[f],c[f]=c[e];c.type||(c.type=" "),c.tag&&(c.tag=c.tag.toLowerCase()),c.classes&&(c.classes=c.classes.toLowerCase().split(".")),c.attrsAll&&(c.attrs=[],c.attrsAll.replace(b,function(a,b,d,e,f){return c.attrs.push({name:b,op:d,val:e||f}),""})),c.pseudosAll&&(c.pseudos=[],c.pseudosAll.replace(x,function(a,b,d){return b==="not"?c.not=v(d):c.pseudos.push({name:b,val:d}),""}))}return c},j=function(b,c){var d,e,f;d=[];if(c.length)switch(b.type){case" ":case">":e=m(c),d=n(b,e),b.type===">"&&(c.forEach(function(a){a._sel_mark=!0}),d=d.filter(function(a){if(a=a.parentNode)return a._sel_mark}),c.forEach(function(a){a._sel_mark=!1})),b.not&&(d=a.difference(d,n(b.not,e))),b.child&&(d=j(b.child,d));break;case"+":case"~":case",":b.children.length===2?(f=j(b.children[0],c),d=j(b.children[1],c)):(f=c,c=t(c),d=j(b.children[0],c)),b.type===","?d=a.union(f,d):b.type==="+"?(f.forEach(function(a){if(a=q(a))a._sel_mark=!0}),d=d.filter(function(a){return a._sel_mark}),f.forEach(function(a){if(a=q(a))a._sel_mark=void 0})):b.type==="~"&&(f.forEach(function(a){while((a=q(a))&&!a._sel_mark)a._sel_mark=!0}),d=d.filter(function(a){return a._sel_mark}),f.forEach(function(a){while((a=q(a))&&a._sel_mark)a._sel_mark=void 0}))}return d},u={thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",fieldset:"form",option:"select"},C=/^\s*<([^\s>]+)/,g=function(a,b){var c,d;return d=(b||document).createElement(u[C.exec(a)[1]]||"div"),d.innerHTML=a,c=[],h(d,"firstChild","nextSibling",function(a){return c.push(a)}),c},y=document.querySelector&&document.querySelectorAll?function(a,b){try{return b.map(function(b){return b.querySelectorAll(a)}).reduce(k,[])}catch(c){return j(v(a),b)}}:function(a,b){return j(v(a),b)},r=function(a){return a?typeof a=="string"?y(a,[document]):typeof a=="object"&&isFinite(a.length)?(a.sort&&a.sort(i),m(a)):[a]:[document]},a.sel=function(a,b){var c;return c=r(b),a?Array.isArray(a)?a:C.test(a)?g(a,c[0]):a===window||a==="window"?[window]:a===document||a==="document"?[document]:a.nodeType===1?!b||c.some(function(b){return f(b,a)})?[a]:[]:y(a,c):[]},a.matching=function(a,b){return l(v(b),a)}})(typeof b!="undefined"&&b!==null?b:this.sel={}),provide("sel",a.exports),function(a){var b,c;return c=require("sel"),a._select=c.sel,b={find:function(b){return a(b,this)},union:function(b,d){return a(c.union(this,c.sel(b,d)))},difference:function(b,d){return a(c.difference(this,c.sel(b,d)))},intersection:function(b,d){return a(c.intersection(this,c.sel(b,d)))},matching:function(b){return a(c.matching(this,b))},is:function(a,b){return c.intersection(this,c.sel(a,b)).length>0}},b.and=b.union,b.not=b.difference,a.pseudos=c.pseudos,a.ender(b,!0)}(ender)}(),!function(){var a={exports:{}},b=a.exports,c=function(a,b){return function(){return a.apply(b,arguments)}},d=Object.prototype.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};(function(a){var b,d,f,g,h,i,j,k;return i=new(b=function(){function a(){}return a.prototype.get=function(a){var b;return a==null&&(a=window),b=a.location.hash.replace(/^#/,""),this.decode(b)},a.prototype.set=function(a,b){return b==null&&(b=window),b.location.hash=this.encode(a)},a.prototype.encode=function(a){return encodeURI(a).replace(/#/,"%23")},a.prototype.decode=function(a){try{return $.browser.firefox?a:decodeURI(a.replace(/%23/,"#"))}catch(b){return a}},a}()),j=new(h=function(){function a(){}return a.prototype._id="__history",a.prototype.init=function(){return this.iframe=$('<iframe src="javascript:false" />'),this.iframe.attr("id",this._id),this.iframe.css("display","none"),$("body").prepend(this.iframe)},a.prototype.set=function(a){return this.iframe.contentDocument.open(),this.iframe.contentDocument.close(),i.set(a,this.iframe.contentWindow)},a.prototype.get=function(){return i.get(this.iframe.contentWindow)},a}()),g=function(){function a(){$(document).ready(c(function(){return this._init()},this))}return a.prototype.delay=100,a.prototype._init=function(){return this.hash=i.get(),$.doTimeout(this.delay,c(function(){return this.check()},this))},a.prototype._check=function(){var a;return a=i.get(),a!==this.hash&&(this.hash=a,$(window).fire("hashchange")),!0},a.prototype.set=function(a){if(a!==this.hash)return i.set(a),this.hash=a,$(window).fire("hashchange")},a}(),f=function(){function a(){a.__super__.constructor.apply(this,arguments)}return e(a,g),a.prototype._init=function(){return a.__super__._init.call(this),j.init(),j.set(this.hash)},a.prototype._check=function(){var a,b;return a=i.get(),b=j.get(),a!==b&&(a===this.hash?(this.hash=b,i.set(this.hash)):(this.hash=a,j.set(this.hash)),$(window).fire("hashchange")),!0},a.prototype.set=function(b){if(b!==this.hash)return j.set(b),a.__super__.set.call(this,b)},a}(),d=function(){function a(){}return a.prototype.set=function(a){return i.set(a)},a}(),"onhashchange"in window?k=new d:$.browser.msie&&$.browser.version<8?k=new HashIframe:k=new g,a.hash=function(a){return a!=null?k.set(a):i.get()}})(typeof b!="undefined"&&b!==null?b:this.hashchange={}),provide("hashchange",a.exports),!function(a){return a.ender({hash:require("hashchange").hash})}(ender)}(),!function(){var a={exports:{}},b=a.exports;(function(a){var b,c,d;return d=[],c=null,a.init=function(b){var d;d=function(){var b;b=$.hash(),b!==c&&(c=b,a.run(b))},$(window).bind("hashchange",d),b&&d()},a.navigate=function(a,b){b||(c=a),$.hash(a)},a.run=function(a){var b,c,e,f;for(e=0,f=d.length;e<f;e++)c=d[e],(b=c.pattern.exec(a))&&c.fn.apply(c,b.slice(1))},a.add=function(a,c){var e;c&&(a={},a[a]=c);for(e in a)c=a[e],d.push(new b(e,c))},b=function(){function a(a,b){var c,d,e,f,g,h;this.path=a,this.fn=b,g=this._transformations;for(e=0,f=g.length;e<f;e++)h=g[e],c=h[0],d=h[1],a=a.replace(c,d);this.pattern=new RegExp("^"+a+"$")}return a.prototype._transformations=[[/:([\w\d]+)/g,"([^/]*)"],[/\*([\w\d]+)/g,"(.*?)"]],a}()})(typeof b!="undefined"&&b!==null?b:this.route={}),provide("route",a.exports),function(a){return a.ender({route:require("route")})}(ender)}(),!function(){var a={exports:{}},b=a.exports;!function(a){var b,c,d;return c=require("reqwest"),d=require("timeout"),b=0,a.isubmit=function(a){var c,e,f,g;return e="__upload_iframe_"+b++,f=$('<iframe src="javascript:false" />'),f.attr("id",e),f.attr("name",e),f.css("display","none"),c=$('<form method="post" enctype="multipart/form-data" />'),c.attr("action",a.url),c.attr("target",e),$("body").append(f),$("body").append(c),g=!1,f.bind("load",function(){var b,c;b=null,c=$(f[0].contentDocument);if(!f.parent().length||c.length&&c.text()==="false"){a.error&&a.error(f);return}try{b=JSON.parse(c.text())}catch(d){a.error&&a.error(f,d)}return a.success&&a.success(b,f),$.timeout(1,function(){return f.remove()}),g=!0}),a.timeout&&d.timeout(a.timeout,function(){if(!g){f.attr("src","javascript:false").remove();if(a.error)return a.error(f,"Timeout")}}),c.append(a.inputs),c.submit(),c.remove()},a.upload=function(a){var b;return a.method="POST",a.type="json",a.processData=!1,(b=a.headers)==null&&(a.headers={}),a.headers["X-File-Name"]=encodeURIComponent(a.data.name),a.headers["Content-Type"]="application/octet-stream",$.ajax(a)}}(typeof b!="undefined"&&b!==null?b:this.upload={}),provide("upload",a.exports),!function(a){var b;return b=require("upload"),a.ender({isubmit:b.isubmit,upload:b.upload})}(ender)}(),!function(){var a={exports:{}},b=a.exports;(function(a){return a.cookie=function(a,b,c){var d,e,f,g,h,i,j,k,l,m;c==null&&(c={});if(b!==void 0)return b===null&&(b="",c.expires=-1),c.expires&&(c.expires instanceof Date?c.expires=c.expires.toUTCString():typeof c.expires=="number"&&(e=new Date,e.setTime(e.getTime()+c.expires*24*60*60*1e3),c.expires=e.toUTCString())),g=c.expires?" expires="+c.expires:"",i=c.path?" path="+c.path:"",f=c.domain?" domain="+c.domain:"",j=c.secure?" secure":"",document.cookie=[a,"=",encodeURIComponent(b),g,i,f,j].join("");m=document.cookie.split(/;\s/g);for(k=0,l=m.length;k<l;k++){d=m[k],h=d.match(/(\w+)=(.*)/);if(Array.isArray(h)&&h[1]===a)try{return decodeURIComponent(h[2])}catch(n){break}}return null}})(typeof b!="undefined"&&b!==null?b:this.jar={}),provide("jar",a.exports),function(a){return a.ender({cookie:require("jar").cookie})}(ender)}(),!function(){var a={exports:{}},b=a.exports;
/*!
    * Bowser - a browser detector
    * https://github.com/ded/bowser
    * MIT License | (c) Dustin Diaz 2011
    */
!function(b,c){typeof define=="function"?define(c):typeof a!="undefined"&&a.exports?a.exports.browser=c():this[b]=c()}("bowser",function(){function m(){if(c)return{msie:b,version:a.match(/msie (\d+(\.\d+)?);/i)[1]};if(d)return{webkit:b,chrome:b,version:a.match(/chrome\/(\d+(\.\d+)?)/i)[1]};if(f)return{webkit:b,iphone:b,mobile:b,ios:b,version:a.match(l)[1]};if(g)return{webkit:b,ipad:b,mobile:b,ios:b,version:a.match(l)[1]};if(h)return{webkit:b,android:b,mobile:b,version:a.match(l)[1]};if(e)return{webkit:b,safari:b,version:a.match(l)[1]};if(i)return{opera:b,version:a.match(l)[1]};if(k){var m={gecko:b,mozilla:b,version:a.match(/firefox\/(\d+(\.\d+)?)/i)[1]};return j&&(m.firefox=b),m}}var a=navigator.userAgent,b=!0,c=/msie/i.test(a),d=/chrome/i.test(a),e=/safari/i.test(a)&&!d,f=/iphone/i.test(a),g=/ipad/i.test(a),h=/android/i.test(a),i=/opera/i.test(a),j=/firefox/i.test(a),k=/gecko\//i.test(a),l=/version\/(\d+(\.\d+)?)/i,n=m();return n.msie&&n.version>=6||n.chrome&&n.version>=10||n.firefox&&n.version>=4||n.safari&&n.version>=5||n.opera&&n.version>=10?n.a=b:n.msie&&n.version<6||n.chrome&&n.version<10||n.firefox&&n.version<4||n.safari&&n.version<5||n.opera&&n.version<10?n.c=b:n.x=b,n}),provide("bowser",a.exports),$.ender(a.exports)}()